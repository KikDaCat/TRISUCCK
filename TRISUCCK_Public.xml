<form version="1.1" theme="dark">
  <label>Threat Response: InfoSec Under [Control/Crisis] Kiosk</label>
  <description>"Without Threat Response, it's just ISUCCK"</description>
  <init>
    <set token="dashboard_id">TRISUCCK</set>
    <set token="extended_time">-7d@d</set>
    <set token="form.reset_sub_filter">Pending</set>
    <set token="form.input_reset">RESET</set>

    <unset token="form.killswitch"></unset>
    <unset token="panel_UID"></unset>
    <eval token="search_start">now()</eval>
    <set token="runstatus"></set>
    <set token="form.multi_UID">false</set>
    <set token="init_cache">$form.input_cache$</set>
    <set token="extra_all">.extra_auth.extra_pingMFA.extra_o365.extra_azure.extra_emails.extra_web.extra_dns.extra_edr.extra_winevent.extra_bluecat.extra_snow.extra_deepwatch.extra_workday.extra_salesforce.extra_epic</set>

    <eval token="form.input_cache">if($form.keyword$!="" AND (NOT $form.input_cache$),$extra_all$,$form.input_cache$)</eval>
    <eval token="form.input_cache_activate">case(len($form.keyword$)!=0,$form.input_cache$)</eval>
    <unset token="nothingfound"></unset>

    <set token="showExpandLink_auth">true</set>
    <set token="showExpandLink_pingMFA">true</set>
    <set token="showExpandLink_o365">true</set>
    <set token="showExpandLink_azure">true</set>
    <set token="showExpandLink_emails">true</set>
    <set token="showExpandLink_web">true</set>
    <set token="showExpandLink_dns">true</set>
    <set token="showExpandLink_edr">true</set>
    <set token="showExpandLink_winevent">true</set>
    <set token="showExpandLink_bluecat">true</set>
    <set token="showExpandLink_snow">true</set>
    <set token="showExpandLink_deepwatch">true</set>
    <set token="showExpandLink_workday">true</set>
    <set token="showExpandLink_salesforce">true</set>
    <set token="showExpandLink_epic">true</set>
    <set token="showExpandLink_cquery">true</set>
    <set token="showExpandLink_osint">true</set>

    <unset token="showCollapseLink_auth"></unset>
    <unset token="showCollapseLink_pingMFA"></unset>
    <unset token="showCollapseLink_o365"></unset>
    <unset token="showCollapseLink_azure"></unset>
    <unset token="showCollapseLink_emails"></unset>
    <unset token="showCollapseLink_web"></unset>
    <unset token="showCollapseLink_dns"></unset>
    <unset token="showCollapseLink_edr"></unset>
    <unset token="showCollapseLink_winevent"></unset>
    <unset token="showCollapseLink_bluecat"></unset>
    <unset token="showCollapseLink_snow"></unset>
    <unset token="showCollapseLink_deepwatch"></unset>
    <unset token="showCollapseLink_workday"></unset>
    <unset token="showCollapseLink_salesforce"></unset>
    <unset token="showCollapseLink_epic"></unset>
    <unset token="showCollapseLink_cquery"></unset>    
    <unset token="showCollapseLink_osint"></unset>
    <unset token="search_custom_table"></unset>
    <unset token="search_custom_event"></unset>

    <eval token="form.osint">if(match($form.keyword$,"[A-Fa-f0-9]{64}|[a-f0-9]{40}") OR match($form.keyword$,"[a-fA-F\\d]{32}") OR match($form.keyword$,"\\b[a-fA-F0-9]{64}\\b") OR match($form.keyword$,"\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}") OR match($form.keyword$,"([^\\/]+\\.?)\\.[^\\/]+") OR match($form.keyword$,"@\\S+\\.\\S+\\b") OR match($form.keyword$,"https?://"),$form.keyword$,"8.8.8.8")</eval>
    <set token="form.show_osint">true</set>
    <set token="show_urls">_time xSender subject xRecipient final_action Attachments EmailSource</set>
    <set token="form.exclude_splunk">true</set>
    <set token="form.show_urls_check"></set>
    <set token="main_status">Search for anything</set>

  </init>
  <!---->
  <!---->
  <fieldset submitButton="true" autoRun="false">
    <input id="keyword" type="text" token="keyword" searchWhenChanged="false">
      <label>$main_status$</label>
      <change>
        <condition match="$form.killswitch$ == &quot;HALTED&quot; ">
          <unset token="form.killswitch"></unset>
          <set token="main_status">Input changed, re-submit to search</set>
          <unset token="form.killswitch"></unset>
        </condition>
        <condition>
          <set token="form.input_reset">RESET</set>
          <unset token="done_input"></unset>
          <set token="main_status">Input changed, re-submit to search</set>
          <unset token="form.killswitch"></unset>
        </condition>
      </change>
    </input>
    <input type="text" token="filter" searchWhenChanged="false">
      <label>Global Filter</label>
      <default>*</default>
      <initialValue>*</initialValue>
      <change>
        <condition>
          <set token="form.input_reset">RESET</set>
          <unset token="done_input"></unset>
          <set token="main_status">Input changed, re-submit to search</set>
          <unset token="form.killswitch"></unset>
        </condition>
      </change>
    </input>
      <input depends="" id="reset_sub_filter" type="link" token="reset_sub_filter" searchWhenChanged="true">
        <label>ALL Filters</label>
        <choice value="RESET">RESET</choice>
        <default></default>
        <initialValue>Pending</initialValue>
        <change>
          <condition match="$form.reset_sub_filter$ == &quot;RESET&quot;">
            <set token="form.filter_auth">*</set>
            <set token="form.filter_pingMFA">*</set>
            <set token="form.filter_o365">*</set>
            <set token="form.filter_azure">*</set>
            <set token="form.filter_emails">*</set>
            <set token="form.filter_web">*</set>
            <set token="form.filter_dns">*</set>
            <set token="form.filter_edr">*</set>
            <set token="form.filter_winevent">*</set>
            <set token="form.filter_workday">*</set>
            <set token="form.filter_bluecat">*</set>
            <set token="form.filter_snow">*</set>
            <set token="form.filter_deepwatch">*</set>
            <set token="form.filter_salesforce">*</set>
            <set token="form.filter_epic">*</set>
            <set token="form.reset_sub_filter"></set>
          </condition>
          <condition match="$form.reset_sub_filter$ == &quot;Pending&quot;">
          </condition>
          <condition>
            <set token="form.reset_sub_filter"></set>
          </condition>
        </change>
      </input>
    <input id="killswitch" type="link" token="killswitch">
      <label>$runstatus$</label>
      <choice value="kill">Stop ALL</choice>
      <change>
        <condition value="kill">
          <set token="form.killswitch">HALTED</set>
          <unset token="done_input"></unset>
          <set token="main_status">All searched stopped.</set>
          <set token="form.input_reset">RESET</set>
        </condition>
        <condition>
          <!-- Do nothing -->
        </condition>
      </change>
    </input>
    <input id="basetime" type="time" token="basetime" searchWhenChanged="true">
      <label>Time frame</label>
      <default>
        <earliest>-24h@h</earliest>
        <latest>now</latest>
      </default>
      <change>
        <condition>
          <set token="form.input_reset">RESET</set>
          <set token="form.reset_sub_filter">Pending</set>
          <unset token="done_input"></unset>
          <set token="main_status">Input changed, re-submit to search</set>
          <unset token="form.killswitch"></unset>
        </condition>
      </change>
    </input>
    <input id="pivot" type="dropdown" token="pivot_window">
      <label>Pivot window</label>
      <choice value="1">±1hr</choice>
      <choice value="3">±3hrs</choice>
      <choice value="6">±6hrs</choice>
      <choice value="12">±12hrs</choice>
      <default>3</default>
      <initialValue>3</initialValue>
      <showClearButton>false</showClearButton>
      <change>
        <set token="form.pivot_window">$value$</set>
      </change>
    </input>
    <input id="refresh_timer" type="dropdown" token="refresh_timer">
        <label>Auto Refresh</label>
        <choice value="none">None</choice>
        <choice value="15m">15m</choice>
        <choice value="30m">30m</choice>
        <choice value="1h">1hr</choice>
        <choice value="3h">3hrs</choice>
        <choice value="6h">6hrs</choice>
        <change>
          <condition match="$value$ != &quot;none&quot;">
            <set token="refresh_timer">$value$</set>
          </condition>
          <condition>
            <unset token="refresh_timer"></unset>
          </condition>
        </change>
        <default>none</default>
        <!--<allowCustomValues>true</allowCustomValues>-->
      </input>    
    <input id="help" type="link" token="help">
      <label>Need Help?</label>
      <choice value="true">See Tips</choice>
      <change>
        <condition value="true">
          <set token="form.help"></set>
          <link target="_blank">[LINK TO User's Guide]</link>
        </condition>
        <condition>
          <!-- Do nothing -->
        </condition>
      </change>
    </input>    
  </fieldset>
  <row depends="$CSS$">
    <panel>
      <html>
        <style>
          
          pre {
            background: #212527;
            color: white;
          }

          #floatosint {
            z-index: 100;
            position: fixed;
            bottom: 10%;
            right: 0%;
            border: 5px dashed;
            border-color: red;
          }

          #floatosint .results-table {
            width: -webkit-fill-available;
          }

          #floatmenu {
            width: 100%;
            z-index: 100;
            position: fixed;
            bottom: 0px;
            right: 0px;
          }  

          #floatmenu2 .dashboard-panel {
            margin-bottom: 0px;
            background: #5c6773;
          }

          #floatmenu2 .dashboard-panel .fieldset {
            display: flex;
            flex-wrap: wrap;
            flex-direction: row;
            margin-left: 5px;
          }


          #floatmenu2 .fieldset .input {
            width: max-content;
            margin: 0px;
          }

          .dashboard-body {
            padding-bottom: 120px
          }

          #floatmenu div[id^="linkCollapse_"] .core_sc0a2c163cfb22924eblCyNL[data-inline] { /*change this ID every time Splunk is updated*/
            display: block;
            padding: 2px 5px;
            min-height: 25px;
            min-width: 20px;
          }

          #floatmenu .core_sc0a2c163cfb22924eblCyNL[data-inline] { /*change this ID every time Splunk is updated*/
            display: block;
            padding: 2px 5px;
            min-height: 25px;
            min-width: 65px;
          }
    

          /*
          div[id^="xlinkCollapse_"],
          div[id^="xlinkExpand_"]{
            width: 100% !important;
          }
          div[id^="xlinkCollapse_"] button{
            width: 100% !important;
            background: rgb(0, 110, 170);
            font-weight: bold;
            font-size: 14px;
            justify-content: left;
          }

          div[id^="xlinkExpand_"] button{
            width: 100% !important;
            background: #2b3033;
            font-weight: bold;
            font-size: 14px;
            justify-content: left;
          }
          */

          #linkCollapse_osint, #linkExpand_osint {
            font-weight: bold;
            position: fixed;
            bottom: 0px;
            left: 95%;
          }
       

          div[id^="jumpto_"],
          div[id^="linkCollapse_"],
          div[id^="linkExpand_"]{
            display: flex;
            font-weight: bold;
            justify-content: center;
            padding: 0px 0px;
            margin: 0px 0px;

          }

          div[id^="jumpto_"] button{
            background: rgb(0, 110, 170);
            font-weight: bold;
            font-size: 13px;
            justify-content: center;
            margin: 0px 0px 3px 6px;
          }

          div[id^="linkCollapse_"] button{
            background: red;
            font-weight: bold;
            font-size: 13px;
            justify-content: center;
            margin: 0px 0px;
          }

          #linkCollapse_osint button {
            background: red;
            font-weight: bold;
            font-size: 13px;
            justify-content: center;
            margin: 0px 0px 3px 6px;
            width: 65px;
          }

          div[id^="linkExpand_"] button{
            background: #2b3033;
            font-weight: bold;
            font-size: 13px;
            justify-content: center;
            margin: 0px 0px 3px 6px;
          }

          #linkCollapse_osint label,
          #linkExpand_osint label {
            justify-content: center;
            font-size: 9px;
            max-width: 80px;
          }

          /*div[id^="osint_"] label,*/
          div[id^="linkCollapse_"] label,
          div[id^="jumpto_"] label,
          div[id^="linkExpand_"] label {
            display: flex;
            margin: 0px 0px 0px 0px;
            justify-content: center;
            font-size: 13px;
            max-height: 20px;
            padding-left: 6px;
          }


          div[id^="panel_"].fieldset{
            padding: 0px;
          }

          
          .fieldset .dashboard-form-fieldset .editable {
            padding: 0px; margin: 0px;
          }
          
          .dashboard-panel .fieldset {
            padding: 0px 0px;
            margin: 0px 0px 0px 0px;
          }
          
          #multi_UID {
            padding-left: 15px;
            margin: 0px;
          }

          #multi_UID label:first-child {
            display:none;
          }

          #global_auth {
            width: 115px;
          }

          #pivot { width: 85px; }
          #pivot [data-component] { width: 85px !important; }
          
          #basetime { width: 180px; }
          #basetime [data-component] { width: 180px !important; }

          #keyword
          {
            width: 400px !important;
          }
          
          #custom_query
          {
            width: 600px !important;
          }

          #clear_auth, #clear_pingMFA, #clear_o365, #clear_azure, #clear_emails, #clear_web, #clear_dns, #clear_edr, #clear_winevent, #clear_snow, #clear_deepwatch, #clear_bluecat, #clear_workday, #clear_salesforce, #clear_epic {
                width: 100px;
            }

          #input_auth, #input_pingMFA, #input_o365, #input_azure, #input_emails, #input_web, #input_dns, #input_edr, #input_winevent, #input_snow, #input_deepwatch, #input_bluecat, #input_workday, #input_salesforce, #input_epic, #osint
          {
            width: 300px !important;
            padding-left: 15px;
          }
          
          #extra_search
          {
            width: 130px;
          }
          
          #extra_search2
          {
            width: 100px;
          }

          #extra_search3
          {
            width: 100px;
          }
          
          #extra_search4
          {
            width: 115px;
          }
          
          #killswitch {
            width: 88px; 
          }

          #killswitch .core_sca62b8b703280870eqVfCQ {
            font-weight:bold;
          }
          
          #killswitch button, html input[type=button], input[type=reset], input[type=submit] {
            background: red;
          }

          #reset_sub_filter { 
            max-width: 75px;
          }

          #reset_sub_filter button, html input[type=button], input[type=reset], input[type=submit] {
            background: #e5b400;
            font-weight:bold;
          }

          #help button, html input[type=button], input[type=reset], input[type=submit] {
            background: rgb(0, 110, 170);
          }

          #help {
            width: 88px;           
          }

          #refresh_timer {
            width: 100px;           
          }
          #refresh_timer [data-component] { width: 100px !important; }
          
          .dashboard-row .dashboard-panel h2.panel-title {
            font-size: 20px; font-weight:bold; color: #00a4fd;
          }
          
          h1 {
            font-weight:bold; color: #00a4fd;
          }
          
        </style>
      </html>
    </panel>
  </row>
  <row depends="$hidden$">
    <panel>
      <input depends="$hidden$" id="input_cache" type="text" token="input_cache" searchWhenChanged="false">
        <label></label>
      </input>
      <input depends="$hidden$" id="input_cache_activate" type="text" token="input_cache_activate" searchWhenChanged="true">
        <label></label>
        <change>
          <condition match="len($form.input_cache_activate$) &gt; 0 AND match($form.input_cache_activate$,&quot;extra_auth&quot;)">
            <set token="form.toklinkExpand_auth">-#-</set>
            <eval token="form.input_cache_activate">replace($form.input_cache_activate$,"\\.extra_auth","")</eval>
          </condition>
          <condition match="len($form.input_cache_activate$) &gt; 0 AND match($form.input_cache_activate$,&quot;extra_pingMFA&quot;)">
            <set token="form.toklinkExpand_pingMFA">-#-</set>
            <eval token="form.input_cache_activate">replace($form.input_cache_activate$,"\\.extra_pingMFA","")</eval>
          </condition>
          <condition match="len($form.input_cache_activate$) &gt; 0 AND match($form.input_cache_activate$,&quot;extra_o365&quot;)">
            <set token="form.toklinkExpand_o365">-#-</set>
            <eval token="form.input_cache_activate">replace($form.input_cache_activate$,"\\.extra_o365","")</eval>
          </condition>
          <condition match="len($form.input_cache_activate$) &gt; 0 AND match($form.input_cache_activate$,&quot;extra_azure&quot;)">
            <set token="form.toklinkExpand_azure">-#-</set>
            <eval token="form.input_cache_activate">replace($form.input_cache_activate$,"\\.extra_azure","")</eval>
          </condition>
          <condition match="len($form.input_cache_activate$) &gt; 0 AND match($form.input_cache_activate$,&quot;extra_emails&quot;)">
            <set token="form.toklinkExpand_emails">-#-</set>
            <eval token="form.input_cache_activate">replace($form.input_cache_activate$,"\\.extra_emails","")</eval>
          </condition>
          <condition match="len($form.input_cache_activate$) &gt; 0 AND match($form.input_cache_activate$,&quot;extra_web&quot;)">
            <set token="form.toklinkExpand_web">-#-</set>
            <eval token="form.input_cache_activate">replace($form.input_cache_activate$,"\\.extra_web","")</eval>
          </condition>
          <condition match="len($form.input_cache_activate$) &gt; 0 AND match($form.input_cache_activate$,&quot;extra_dns&quot;)">
            <set token="form.toklinkExpand_dns">-#-</set>
            <eval token="form.input_cache_activate">replace($form.input_cache_activate$,"\\.extra_dns","")</eval>
          </condition>
          <condition match="len($form.input_cache_activate$) &gt; 0 AND match($form.input_cache_activate$,&quot;extra_edr&quot;)">
            <set token="form.toklinkExpand_edr">-#-</set>
            <eval token="form.input_cache_activate">replace($form.input_cache_activate$,"\\.extra_edr","")</eval>
          </condition>
          <condition match="len($form.input_cache_activate$) &gt; 0 AND match($form.input_cache_activate$,&quot;extra_winevent&quot;)">
            <set token="form.toklinkExpand_winevent">-#-</set>
            <eval token="form.input_cache_activate">replace($form.input_cache_activate$,"\\.extra_winevent","")</eval>
          </condition>
          <condition match="len($form.input_cache_activate$) &gt; 0 AND match($form.input_cache_activate$,&quot;extra_workday&quot;)">
            <set token="form.toklinkExpand_workday">-#-</set>
            <eval token="form.input_cache_activate">replace($form.input_cache_activate$,"\\.extra_workday","")</eval>
          </condition>
          <condition match="len($form.input_cache_activate$) &gt; 0 AND match($form.input_cache_activate$,&quot;extra_bluecat&quot;)">
            <set token="form.toklinkExpand_bluecat">-#-</set>
            <eval token="form.input_cache_activate">replace($form.input_cache_activate$,"\\.extra_bluecat","")</eval>
          </condition>
          <condition match="len($form.input_cache_activate$) &gt; 0 AND match($form.input_cache_activate$,&quot;extra_snow&quot;)">
            <set token="form.toklinkExpand_snow">-#-</set>
            <eval token="form.input_cache_activate">replace($form.input_cache_activate$,"\\.extra_snow","")</eval>
          </condition>
          <condition match="len($form.input_cache_activate$) &gt; 0 AND match($form.input_cache_activate$,&quot;extra_deepwatch&quot;)">
            <set token="form.toklinkExpand_deepwatch">-#-</set>
            <eval token="form.input_cache_activate">replace($form.input_cache_activate$,"\\.extra_deepwatch","")</eval>
          </condition>
          <condition match="len($form.input_cache_activate$) &gt; 0 AND match($form.input_cache_activate$,&quot;extra_salesforce&quot;)">
            <set token="form.toklinkExpand_salesforce">-#-</set>
            <eval token="form.input_cache_activate">replace($form.input_cache_activate$,"\\.extra_salesforce","")</eval>
          </condition>
          <condition match="len($form.input_cache_activate$) &gt; 0 AND match($form.input_cache_activate$,&quot;extra_epic&quot;)">
            <set token="form.toklinkExpand_epic">-#-</set>
            <eval token="form.input_cache_activate">replace($form.input_cache_activate$,"\\.extra_epic","")</eval>
          </condition>
          <condition match="len($form.input_cache_activate$) &gt; 0 AND match($form.input_cache_activate$,&quot;extra_cquery&quot;)">
            <set token="form.toklinkExpand_cquery">-#-</set>
            <eval token="form.input_cache_activate">replace($form.input_cache_activate$,"\\.extra_cquery","")</eval>
          </condition>
          <condition>
            <set token="form.input_cache_activate"></set>
          </condition>
        </change>
      </input>

      <input depends="$hidden$" id="input_reset" type="link" token="input_reset" searchWhenChanged="false">
        <label></label>
        <change>
          <condition value="RESET">
            <eval token="search_start">now()</eval>
            <set token="runtime">0</set>
            <set token="form.multi_UID">false</set>

            <set token="realname">1=0</set>
            <eval token="xtime">if((match($form.basetime.latest$,"\\D") OR match($form.basetime.earliest$,"\\D")),if(relative_time(now(),$form.basetime.latest$)-relative_time(now(),$form.basetime.earliest$)&gt;604800,relative_time(now(),$form.basetime.earliest$),relative_time(relative_time(now(),$form.basetime.latest$),$extended_time$)),if($form.basetime.latest$-$form.basetime.earliest$&gt;604800,$form.basetime.earliest$,relative_time($form.basetime.latest$,$extended_time$)))</eval>
            <set token="form.time_snow.earliest">$xtime$</set>
            <set token="form.time_snow.latest">$form.basetime.latest$</set>
            <set token="form.time_deepwatch.earliest">$xtime$</set>
            <set token="form.time_deepwatch.latest">$form.basetime.latest$</set>
            <set token="form.time_cquery.earliest">$form.basetime.earliest$</set>
            <set token="form.time_cquery.latest">$form.basetime.latest$</set>
            <set token="form.time_workday.earliest">$form.basetime.earliest$</set>
            <set token="form.time_workday.latest">$form.basetime.latest$</set>
            <set token="form.time_bluecat.earliest">$xtime$</set>
            <set token="form.time_bluecat.latest">$form.basetime.latest$</set>
            <set token="form.time_auth.earliest">$form.basetime.earliest$</set>
            <set token="form.time_auth.latest">$form.basetime.latest$</set>
            <set token="form.time_pingMFA.earliest">$form.basetime.earliest$</set>
            <set token="form.time_pingMFA.latest">$form.basetime.latest$</set>
            <set token="form.time_o365.earliest">$form.basetime.earliest$</set>
            <set token="form.time_o365.latest">$form.basetime.latest$</set>
            <set token="form.time_azure.earliest">$form.basetime.earliest$</set>
            <set token="form.time_azure.latest">$form.basetime.latest$</set>
            <set token="form.time_emails.earliest">$form.basetime.earliest$</set>
            <set token="form.time_emails.latest">$form.basetime.latest$</set>
            <set token="form.time_web.earliest">$form.basetime.earliest$</set>
            <set token="form.time_web.latest">$form.basetime.latest$</set>
            <set token="form.time_dns.earliest">$form.basetime.earliest$</set>
            <set token="form.time_dns.latest">$form.basetime.latest$</set>
            <set token="form.time_edr.earliest">$form.basetime.earliest$</set>
            <set token="form.time_edr.latest">$form.basetime.latest$</set>
            <set token="form.time_winevent.earliest">$form.basetime.earliest$</set>
            <set token="form.time_winevent.latest">$form.basetime.latest$</set>
            <set token="form.time_salesforce.earliest">$form.basetime.earliest$</set>
            <set token="form.time_salesforce.latest">$form.basetime.latest$</set>
            <set token="form.time_epic.earliest">$form.basetime.earliest$</set>
            <set token="form.time_epic.latest">$form.basetime.latest$</set>
            <unset token="panel_UID"></unset>
            <unset token="filter_UID"></unset>
            <unset token="filter_UID2"></unset>
            <!--<unset token="done_input"></unset>-->
            <unset token="panel_input"></unset>
            <unset token="bad_input"></unset>
            <!--<unset token="form.killswitch"></unset>-->
            <unset token="data"></unset>
            <unset token="exc_UID"></unset>
            <set token="runstatus"></set>
            <set token="result_time"></set>
            <unset token="nothingfound"></unset>

            <set token="count_label">Search</set>
            <set token="count_auth">$count_label$</set>
            <set token="count_pingMFA">$count_label$</set>
            <set token="count_o365">$count_label$</set>
            <set token="count_azure">$count_label$</set>
            <set token="count_emails">$count_label$</set>
            <set token="count_web">$count_label$</set>
            <set token="count_dns">$count_label$</set>
            <set token="count_edr">$count_label$</set>
            <set token="count_winevent">$count_label$</set>
            <set token="count_bluecat">$count_label$</set>
            <set token="count_snow">$count_label$</set>
            <set token="count_deepwatch">$count_label$</set>
            <set token="count_workday">$count_label$</set>
            <set token="count_salesforce">$count_label$</set>
            <set token="count_epic">$count_label$</set>

            <unset token="unextra_auth"></unset>
            <unset token="unextra_pingMFA"></unset>
            <unset token="unextra_o365"></unset>
            <unset token="unextra_azure"></unset>
            <unset token="unextra_emails"></unset>
            <unset token="unextra_web"></unset>
            <unset token="unextra_dns"></unset>
            <unset token="unextra_edr"></unset>
            <unset token="unextra_winevent"></unset>
            <unset token="unextra_bluecat"></unset>
            <unset token="unextra_snow"></unset>
            <unset token="unextra_deepwatch"></unset>
            <unset token="unextra_workday"></unset>
            <unset token="unextra_salesforce"></unset>
            <unset token="unextra_epic"></unset>

            <unset token="is_multi_UID"></unset>

            <!--<set token="form.input_cache_activate">$form.input_cache$</set>-->

            <set token="form.input_reset"></set>
            <set token="form.jumpto">#</set>
          </condition>
        </change>
      </input>
      <input depends="$hidden$" id="jumpto" type="link" token="jumpto" searchWhenChanged="true">
        <label>$form.jumpto$</label>
        <change>
          <condition match="$form.jumpto$ != &quot;#&quot; AND $done_input$ == &quot;true&quot;">
            <set token="form.jumpto_auth"></set>
            <set token="form.jumpto_pingMFA"></set>
            <set token="form.jumpto_o365"></set>
            <set token="form.jumpto_azure"></set>
            <set token="form.jumpto_emails"></set>
            <set token="form.jumpto_web"></set>
            <set token="form.jumpto_dns"></set>
            <set token="form.jumpto_edr"></set>
            <set token="form.jumpto_winevent"></set>
            <set token="form.jumpto_bluecat"></set>
            <set token="form.jumpto_snow"></set>
            <set token="form.jumpto_deepwatch"></set>
            <set token="form.jumpto_workday"></set>
            <set token="form.jumpto_salesforce"></set>
            <set token="form.jumpto_epic"></set>
            <set token="form.jumpto_cquery"></set>

            <link target="_self">#$form.jumpto$</link>
            <set token="form.jumpto">#</set>
          </condition>
          <condition>
            <set token="form.jumpto">#</set>
          </condition>
        </change>
        <default>#</default>
        <initialValue>#</initialValue>
      </input>
    </panel>
    <panel>
      <search id="search_progress">
        <query>| makeresults
``` search_progress $count_auth$ $count_pingMFA$ $count_o365$ $count_azure$ $count_emails$ $count_web$ $count_dns$ $count_edr$ $count_winevent$ $count_bluecat$ $count_snow$ $count_deepwatch$ $count_workday$ $count_salesforce$ $count_epic$ ```
        </query>
        <earliest>-1s</earliest>
        <latest>now</latest>

        <progress>
          <condition match="(match($count_auth$,&quot;\\.\\.&quot;) OR match($count_pingMFA$,&quot;\\.\\.&quot;) OR match($count_o365$,&quot;\\.\\.&quot;) OR match($count_azure$,&quot;\\.\\.&quot;) OR match($count_emails$,&quot;\\.\\.&quot;) OR match($count_web$,&quot;\\.\\.&quot;) OR match($count_dns$,&quot;\\.\\.&quot;) OR match($count_edr$,&quot;\\.\\.&quot;) OR match($count_winevent$,&quot;\\.\\.&quot;) OR match($count_bluecat$,&quot;\\.\\.&quot;) OR match($count_snow$,&quot;\\.\\.&quot;) OR match($count_deepwatch$,&quot;\\.\\.&quot;) OR match($count_workday$,&quot;\\.\\.&quot;) OR match($count_salesforce$,&quot;\\.\\.&quot;) OR match($count_epic$,&quot;\\.\\.&quot;)) AND $done_input$ == &quot;true&quot;">
            <unset token="nothingfound"></unset>
            <set token="runstatus">Running.. $runtime$s</set>
            <set token="result_time"></set>
          </condition>
          <condition match="(match($count_auth$,&quot;[1-9]&quot;) OR match($count_pingMFA$,&quot;[1-9]&quot;) OR match($count_o365$,&quot;[1-9]&quot;) OR match($count_azure$,&quot;[1-9]&quot;) OR match($count_emails$,&quot;[1-9]&quot;) OR match($count_web$,&quot;[1-9]&quot;) OR match($count_dns$,&quot;[1-9]&quot;) OR match($count_edr$,&quot;[1-9]&quot;) OR match($count_winevent$,&quot;[1-9]&quot;) OR match($count_bluecat$,&quot;[1-9]&quot;) OR match($count_snow$,&quot;[1-9]&quot;) OR match($count_deepwatch$,&quot;[1-9]&quot;) OR match($count_workday$,&quot;[1-9]&quot;) OR match($count_salesforce$,&quot;[1-9]&quot;) OR match($count_epic$,&quot;[1-9]&quot;)) AND $done_input$ == &quot;true&quot; AND $runtime$ &gt; 0">
            <unset token="nothingfound"></unset>
            <set token="runstatus">DONE $runtime$s</set>
            <eval token="result_time">strftime(now(),"%m-%d-%y %H:%M:%S")</eval>
          </condition>
          <condition match="$done_input$ == &quot;true&quot; AND $runtime$ &gt; 0">
            <set token="nothingfound">true</set>
            <set token="runstatus">DONE $runtime$s</set>
            <eval token="result_time">strftime(now(),"%m-%d-%y %H:%M:%S")</eval>
          </condition>
        </progress>
      </search>
    </panel>
  </row>
  <row id="floatmenu">
    <panel id="floatmenu2">
      <input id="jumpto_auth" type="link" token="jumpto_auth" searchWhenChanged="true" depends="$showCollapseLink_auth$">
        <label>$count_auth$</label>
        <choice value="#">Authentications</choice>
        <change>
          <condition value="#">
            <set token="form.jumpto">panel_auth</set>
            <unset token="form.jumpto_auth"></unset>
            <set token="value"></set>
          </condition>
          <condition>
            <unset token="form.jumpto_auth"></unset>
            <set token="value"></set>
          </condition>
        </change>
      </input>
      <input id="linkExpand_auth" type="link" token="toklinkExpand_auth" depends="$showExpandLink_auth$" searchWhenChanged="true">
        <label>$count_auth$</label>
        <choice value="#">Authentications</choice>
        <change>
          <condition value="#">
            <set token="form.toklinkExpand_auth">-#-</set>
            <set token="form.jumpto">panel_auth</set>
          </condition>
          <condition value="-#-">
            <set token="showCollapseLink_auth">true</set>
            <set token="form.toklinkCollapse_auth">true</set>
            <unset token="showExpandLink_auth"></unset>
            <unset token="form.toklinkExpand_auth"></unset>
            <unset token="unextra_auth"></unset>
            <set token="value"></set>
            <set token="extra_auth">true</set>
            <!--<eval token="form.input_cache">mvappend("extra_auth",$form.input_cache$)</eval>-->
            <eval token="form.input_cache">if(NOT match($form.input_cache$,"extra_auth"),coalesce($form.input_cache$,"")+".extra_auth",$form.input_cache$)</eval>
          </condition>
        </change>
      </input>
      <input id="linkCollapse_auth" type="link" token="toklinkCollapse_auth" searchWhenChanged="true" depends="$extra_auth$" rejects="$unextra_auth$">
        <label></label>
        <choice value="#">X</choice>
        <change>
          <condition value="#">
            <unset token="showCollapseLink_auth"></unset>
            <unset token="form.toklinkCollapse_auth"></unset>
            <set token="showExpandLink_auth">true</set>
            <set token="form.toklinkExpand_auth">true</set>
            <set token="unextra_auth">true</set>
            <set token="value"></set>
            <!--<eval token="form.input_cache">mvfilter(NOT match($form.input_cache$,"extra_auth"))</eval>-->
            <eval token="form.input_cache">replace($form.input_cache$,"\\.extra_auth","")</eval>
          </condition>
        </change>
      </input>
      <input id="jumpto_pingMFA" type="link" token="jumpto_pingMFA" searchWhenChanged="true" depends="$showCollapseLink_pingMFA$">
        <label>$count_pingMFA$</label>
        <choice value="#">Ping MFA</choice>
        <change>
          <condition value="#">
            <set token="form.jumpto">panel_pingMFA</set>
            <unset token="form.jumpto_pingMFA"></unset>
            <set token="value"></set>
          </condition>
          <condition>
            <unset token="form.jumpto_pingMFA"></unset>
            <set token="value"></set>
          </condition>
        </change>
      </input>
      <input id="linkExpand_pingMFA" type="link" token="toklinkExpand_pingMFA" depends="$showExpandLink_pingMFA$" searchWhenChanged="true">
        <label>$count_pingMFA$</label>
        <choice value="#">Ping MFA</choice>
        <change>
          <condition value="#">
            <set token="form.toklinkExpand_pingMFA">-#-</set>
            <set token="form.jumpto">panel_pingMFA</set>
          </condition>
          <condition value="-#-">
            <set token="showCollapseLink_pingMFA">true</set>
            <set token="form.toklinkCollapse_pingMFA">true</set>
            <unset token="showExpandLink_pingMFA"></unset>
            <unset token="form.toklinkExpand_pingMFA"></unset>
            <unset token="unextra_pingMFA"></unset>
            <set token="value"></set>
            <set token="extra_pingMFA">true</set>
            <!--<eval token="form.input_cache">mvappend("extra_pingMFA",$form.input_cache$)</eval>-->
            <eval token="form.input_cache">if(NOT match($form.input_cache$,"extra_pingMFA"),coalesce($form.input_cache$,"")+".extra_pingMFA",$form.input_cache$)</eval>
          </condition>
        </change>
      </input>
      <input id="linkCollapse_pingMFA" type="link" token="toklinkCollapse_pingMFA" searchWhenChanged="true" depends="$extra_pingMFA$" rejects="$unextra_pingMFA$">
        <label></label>
        <choice value="#">X</choice>
        <change>
          <condition value="#">
            <unset token="showCollapseLink_pingMFA"></unset>
            <unset token="form.toklinkCollapse_pingMFA"></unset>
            <set token="showExpandLink_pingMFA">true</set>
            <set token="form.toklinkExpand_pingMFA">true</set>
            <set token="unextra_pingMFA">true</set>
            <set token="value"></set>
            <!--<eval token="form.input_cache">mvfilter(NOT match($form.input_cache$,"extra_pingMFA"))</eval>-->
            <eval token="form.input_cache">replace($form.input_cache$,"\\.extra_pingMFA","")</eval>
          </condition>
        </change>
      </input>
      <input id="jumpto_o365" type="link" token="jumpto_o365" searchWhenChanged="true" depends="$showCollapseLink_o365$">
        <label>$count_o365$</label>
        <choice value="#">Office365</choice>
        <change>
          <condition value="#">
            <set token="form.jumpto">panel_o365</set>
            <unset token="form.jumpto_o365"></unset>
            <set token="value"></set>
          </condition>
          <condition>
            <unset token="form.jumpto_o365"></unset>
            <set token="value"></set>
          </condition>
        </change>
      </input>
      <input id="linkExpand_o365" type="link" token="toklinkExpand_o365" depends="$showExpandLink_o365$" searchWhenChanged="true">
        <label>$count_o365$</label>
        <choice value="#">Office365</choice>
        <change>
          <condition value="#">
            <set token="form.toklinkExpand_o365">-#-</set>
            <set token="form.jumpto">panel_o365</set>
          </condition>
          <condition value="-#-">
            <set token="showCollapseLink_o365">true</set>
            <set token="form.toklinkCollapse_o365">true</set>
            <unset token="showExpandLink_o365"></unset>
            <unset token="form.toklinkExpand_o365"></unset>
            <unset token="unextra_o365"></unset>
            <set token="value"></set>
            <set token="extra_o365">true</set>
            <!--<eval token="form.input_cache">mvappend("extra_o365",$form.input_cache$)</eval>-->
            <eval token="form.input_cache">if(NOT match($form.input_cache$,"extra_o365"),coalesce($form.input_cache$,"")+".extra_o365",$form.input_cache$)</eval>
          </condition>
        </change>
      </input>
      <input id="linkCollapse_o365" type="link" token="toklinkCollapse_o365" searchWhenChanged="true" depends="$extra_o365$" rejects="$unextra_o365$">
        <label></label>
        <choice value="#">X</choice>
        <change>
          <condition value="#">
            <unset token="showCollapseLink_o365"></unset>
            <unset token="form.toklinkCollapse_o365"></unset>
            <set token="showExpandLink_o365">true</set>
            <set token="form.toklinkExpand_o365">true</set>
            <set token="unextra_o365">true</set>
            <set token="value"></set>
            <!--<eval token="form.input_cache">mvfilter(NOT match($form.input_cache$,"extra_o365"))</eval>-->
            <eval token="form.input_cache">replace($form.input_cache$,"\\.extra_o365","")</eval>
          </condition>
        </change>
      </input>
      <input id="jumpto_azure" type="link" token="jumpto_azure" searchWhenChanged="true" depends="$showCollapseLink_azure$">
        <label>$count_azure$</label>
        <choice value="#">AzureAD</choice>
        <change>
          <condition value="#">
            <set token="form.jumpto">panel_azure</set>
            <unset token="form.jumpto_azure"></unset>
            <set token="value"></set>
          </condition>
          <condition>
            <unset token="form.jumpto_azure"></unset>
            <set token="value"></set>
          </condition>
        </change>
      </input>
      <input id="linkExpand_azure" type="link" token="toklinkExpand_azure" depends="$showExpandLink_azure$" searchWhenChanged="true">
        <label>$count_azure$</label>
        <choice value="#">AzureAD</choice>
        <change>
          <condition value="#">
            <set token="form.toklinkExpand_azure">-#-</set>
            <set token="form.jumpto">panel_azure</set>
          </condition>
          <condition value="-#-">
            <set token="showCollapseLink_azure">true</set>
            <set token="form.toklinkCollapse_azure">true</set>
            <unset token="showExpandLink_azure"></unset>
            <unset token="form.toklinkExpand_azure"></unset>
            <unset token="unextra_azure"></unset>
            <set token="value"></set>
            <set token="extra_azure">true</set>
            <!--<eval token="form.input_cache">mvappend("extra_azure",$form.input_cache$)</eval>-->
            <eval token="form.input_cache">if(NOT match($form.input_cache$,"extra_azure"),coalesce($form.input_cache$,"")+".extra_azure",$form.input_cache$)</eval>
          </condition>
        </change>
      </input>
      <input id="linkCollapse_azure" type="link" token="toklinkCollapse_azure" searchWhenChanged="true" depends="$extra_azure$" rejects="$unextra_azure$">
        <label></label>
        <choice value="#">X</choice>
        <change>
          <condition value="#">
            <unset token="showCollapseLink_azure"></unset>
            <unset token="form.toklinkCollapse_azure"></unset>
            <set token="showExpandLink_azure">true</set>
            <set token="form.toklinkExpand_azure">true</set>
            <set token="unextra_azure">true</set>
            <set token="value"></set>
            <!--<eval token="form.input_cache">mvfilter(NOT match($form.input_cache$,"extra_azure"))</eval>-->
            <eval token="form.input_cache">replace($form.input_cache$,"\\.extra_azure","")</eval>
          </condition>
        </change>
      </input>
      <input id="jumpto_emails" type="link" token="jumpto_emails" searchWhenChanged="true" depends="$showCollapseLink_emails$">
        <label>$count_emails$</label>
        <choice value="#">Emails</choice>
        <change>
          <condition value="#">
            <set token="form.jumpto">panel_emails</set>
            <unset token="form.jumpto_emails"></unset>
            <set token="value"></set>
          </condition>
          <condition>
            <unset token="form.jumpto_emails"></unset>
            <set token="value"></set>
          </condition>
        </change>
      </input>
      <input id="linkExpand_emails" type="link" token="toklinkExpand_emails" depends="$showExpandLink_emails$" searchWhenChanged="true">
        <label>$count_emails$</label>
        <choice value="#">Emails</choice>
        <change>
          <condition value="#">
            <set token="form.toklinkExpand_emails">-#-</set>
            <set token="form.jumpto">panel_emails</set>
          </condition>
          <condition value="-#-">
            <set token="showCollapseLink_emails">true</set>
            <set token="form.toklinkCollapse_emails">true</set>
            <unset token="showExpandLink_emails"></unset>
            <unset token="form.toklinkExpand_emails"></unset>
            <unset token="unextra_emails"></unset>
            <set token="value"></set>
            <set token="extra_emails">true</set>
            <!--<eval token="form.input_cache">mvappend("extra_emails",$form.input_cache$)</eval>-->
            <eval token="form.input_cache">if(NOT match($form.input_cache$,"extra_emails"),coalesce($form.input_cache$,"")+".extra_emails",$form.input_cache$)</eval>
          </condition>
        </change>
      </input>
      <input id="linkCollapse_emails" type="link" token="toklinkCollapse_emails" searchWhenChanged="true" depends="$extra_emails$" rejects="$unextra_emails$">
        <label></label>
        <choice value="#">X</choice>
        <change>
          <condition value="#">
            <unset token="showCollapseLink_emails"></unset>
            <unset token="form.toklinkCollapse_emails"></unset>
            <set token="showExpandLink_emails">true</set>
            <set token="form.toklinkExpand_emails">true</set>
            <set token="unextra_emails">true</set>
            <set token="value"></set>
            <!--<eval token="form.input_cache">mvfilter(NOT match($form.input_cache$,"extra_emails"))</eval>-->
            <eval token="form.input_cache">replace($form.input_cache$,"\\.extra_emails","")</eval>
          </condition>
        </change>
      </input>
      <input id="jumpto_web" type="link" token="jumpto_web" searchWhenChanged="true" depends="$showCollapseLink_web$">
        <label>$count_web$</label>
        <choice value="#">Web/Network</choice>
        <change>
          <condition value="#">
            <set token="form.jumpto">panel_web</set>
            <unset token="form.jumpto_web"></unset>
            <set token="value"></set>
          </condition>
          <condition>
            <unset token="form.jumpto_web"></unset>
            <set token="value"></set>
          </condition>
        </change>
      </input>
      <input id="linkExpand_web" type="link" token="toklinkExpand_web" depends="$showExpandLink_web$" searchWhenChanged="true">
        <label>$count_web$</label>
        <choice value="#">Web/Network</choice>
        <change>
          <condition value="#">
            <set token="form.toklinkExpand_web">-#-</set>
            <set token="form.jumpto">panel_web</set>
          </condition>
          <condition value="-#-">
            <set token="showCollapseLink_web">true</set>
            <set token="form.toklinkCollapse_web">true</set>
            <unset token="showExpandLink_web"></unset>
            <unset token="form.toklinkExpand_web"></unset>
            <unset token="unextra_web"></unset>
            <set token="value"></set>
            <set token="extra_web">true</set>
            <!--<eval token="form.input_cache">mvappend("extra_web",$form.input_cache$)</eval>-->
            <eval token="form.input_cache">if(NOT match($form.input_cache$,"extra_web"),coalesce($form.input_cache$,"")+".extra_web",$form.input_cache$)</eval>
          </condition>
        </change>
      </input>
      <input id="linkCollapse_web" type="link" token="toklinkCollapse_web" searchWhenChanged="true" depends="$extra_web$" rejects="$unextra_web$">
        <label></label>
        <choice value="#">X</choice>
        <change>
          <condition value="#">
            <unset token="showCollapseLink_web"></unset>
            <unset token="form.toklinkCollapse_web"></unset>
            <set token="showExpandLink_web">true</set>
            <set token="form.toklinkExpand_web">true</set>
            <set token="unextra_web">true</set>
            <set token="value"></set>
            <!--<eval token="form.input_cache">mvfilter(NOT match($form.input_cache$,"extra_web"))</eval>-->
            <eval token="form.input_cache">replace($form.input_cache$,"\\.extra_web","")</eval>
          </condition>
        </change>
      </input>
      <input id="jumpto_dns" type="link" token="jumpto_dns" searchWhenChanged="true" depends="$showCollapseLink_dns$">
        <label>$count_dns$</label>
        <choice value="#">DNS</choice>
        <change>
          <condition value="#">
            <set token="form.jumpto">panel_dns</set>
            <unset token="form.jumpto_dns"></unset>
            <set token="value"></set>
          </condition>
          <condition>
            <unset token="form.jumpto_dns"></unset>
            <set token="value"></set>
          </condition>
        </change>
      </input>
      <input id="linkExpand_dns" type="link" token="toklinkExpand_dns" depends="$showExpandLink_dns$" searchWhenChanged="true">
        <label>$count_dns$</label>
        <choice value="#">DNS </choice>
        <change>
          <condition value="#">
            <set token="form.toklinkExpand_dns">-#-</set>
            <set token="form.jumpto">panel_dns</set>
          </condition>
          <condition value="-#-">
            <set token="showCollapseLink_dns">true</set>
            <set token="form.toklinkCollapse_dns">true</set>
            <unset token="showExpandLink_dns"></unset>
            <unset token="form.toklinkExpand_dns"></unset>
            <unset token="unextra_dns"></unset>
            <set token="value"></set>
            <set token="extra_dns">true</set>
            <!--<eval token="form.input_cache">mvappend("extra_dns",$form.input_cache$)</eval>-->
            <eval token="form.input_cache">if(NOT match($form.input_cache$,"extra_dns"),coalesce($form.input_cache$,"")+".extra_dns",$form.input_cache$)</eval>
          </condition>
        </change>
      </input>
      <input id="linkCollapse_dns" type="link" token="toklinkCollapse_dns" searchWhenChanged="true" depends="$extra_dns$" rejects="$unextra_dns$">
        <label></label>
        <choice value="#">X</choice>
        <change>
          <condition value="#">
            <unset token="showCollapseLink_dns"></unset>
            <unset token="form.toklinkCollapse_dns"></unset>
            <set token="showExpandLink_dns">true</set>
            <set token="form.toklinkExpand_dns">true</set>
            <set token="unextra_dns">true</set>
            <set token="value"></set>
            <!--<eval token="form.input_cache">mvfilter(NOT match($form.input_cache$,"extra_dns"))</eval>-->
            <eval token="form.input_cache">replace($form.input_cache$,"\\.extra_dns","")</eval>
          </condition>
        </change>
      </input>
      <input id="jumpto_edr" type="link" token="jumpto_edr" searchWhenChanged="true" depends="$showCollapseLink_edr$">
        <label>$count_edr$</label>
        <choice value="#">CrowdStrike</choice>
        <change>
          <condition value="#">
            <set token="form.jumpto">panel_edr</set>
            <unset token="form.jumpto_edr"></unset>
            <set token="value"></set>
          </condition>
          <condition>
            <unset token="form.jumpto_edr"></unset>
            <set token="value"></set>
          </condition>
        </change>
      </input>
      <input id="linkExpand_edr" type="link" token="toklinkExpand_edr" depends="$showExpandLink_edr$" searchWhenChanged="true">
        <label>$count_edr$</label>
        <choice value="#">CrowdStrike</choice>
        <change>
          <condition value="#">
            <set token="form.toklinkExpand_edr">-#-</set>
            <set token="form.jumpto">panel_edr</set>
          </condition>
          <condition value="-#-">
            <set token="showCollapseLink_edr">true</set>
            <set token="form.toklinkCollapse_edr">true</set>
            <unset token="showExpandLink_edr"></unset>
            <unset token="form.toklinkExpand_edr"></unset>
            <unset token="unextra_edr"></unset>
            <set token="value"></set>
            <set token="extra_edr">true</set>
            <!--<eval token="form.input_cache">mvappend("extra_edr",$form.input_cache$)</eval>-->
            <eval token="form.input_cache">if(NOT match($form.input_cache$,"extra_edr"),coalesce($form.input_cache$,"")+".extra_edr",$form.input_cache$)</eval>
          </condition>
        </change>
      </input>
      <input id="linkCollapse_edr" type="link" token="toklinkCollapse_edr" searchWhenChanged="true" depends="$extra_edr$" rejects="$unextra_edr$">
        <label></label>
        <choice value="#">X</choice>
        <change>
          <condition value="#">
            <unset token="showCollapseLink_edr"></unset>
            <unset token="form.toklinkCollapse_edr"></unset>
            <set token="showExpandLink_edr">true</set>
            <set token="form.toklinkExpand_edr">true</set>
            <set token="unextra_edr">true</set>
            <set token="value"></set>
            <!--<eval token="form.input_cache">mvfilter(NOT match($form.input_cache$,"extra_edr"))</eval>-->
            <eval token="form.input_cache">replace($form.input_cache$,"\\.extra_edr","")</eval>
          </condition>
        </change>
      </input>
      <input id="jumpto_winevent" type="link" token="jumpto_winevent" searchWhenChanged="true" depends="$showCollapseLink_winevent$">
        <label>$count_winevent$</label>
        <choice value="#">WinEvents</choice>
        <change>
          <condition value="#">
            <set token="form.jumpto">panel_winevent</set>
            <unset token="form.jumpto_winevent"></unset>
            <set token="value"></set>
          </condition>
          <condition>
            <unset token="form.jumpto_winevent"></unset>
            <set token="value"></set>
          </condition>
        </change>
      </input>
      <input id="linkExpand_winevent" type="link" token="toklinkExpand_winevent" depends="$showExpandLink_winevent$" searchWhenChanged="true">
        <label>$count_winevent$</label>
        <choice value="#">WinEvents</choice>
        <change>
          <condition value="#">
            <set token="form.toklinkExpand_winevent">-#-</set>
            <set token="form.jumpto">panel_winevent</set>
          </condition>
          <condition value="-#-">
            <set token="showCollapseLink_winevent">true</set>
            <set token="form.toklinkCollapse_winevent">true</set>
            <unset token="showExpandLink_winevent"></unset>
            <unset token="form.toklinkExpand_winevent"></unset>
            <unset token="unextra_winevent"></unset>
            <set token="value"></set>
            <set token="extra_winevent">true</set>
            <!--<eval token="form.input_cache">mvappend("extra_winevent",$form.input_cache$)</eval>-->
            <eval token="form.input_cache">if(NOT match($form.input_cache$,"extra_winevent"),coalesce($form.input_cache$,"")+".extra_winevent",$form.input_cache$)</eval>
          </condition>
        </change>
      </input>
      <input id="linkCollapse_winevent" type="link" token="toklinkCollapse_winevent" searchWhenChanged="true" depends="$extra_winevent$" rejects="$unextra_winevent$">
        <label></label>
        <choice value="#">X</choice>
        <change>
          <condition value="#">
            <unset token="showCollapseLink_winevent"></unset>
            <unset token="form.toklinkCollapse_winevent"></unset>
            <set token="showExpandLink_winevent">true</set>
            <set token="form.toklinkExpand_winevent">true</set>
            <set token="unextra_winevent">true</set>
            <set token="value"></set>
            <!--<eval token="form.input_cache">mvfilter(NOT match($form.input_cache$,"extra_winevent"))</eval>-->
            <eval token="form.input_cache">replace($form.input_cache$,"\\.extra_winevent","")</eval>
          </condition>
        </change>
      </input>
      <input id="jumpto_workday" type="link" token="jumpto_workday" searchWhenChanged="true" depends="$showCollapseLink_workday$">
        <label>$count_workday$</label>
        <choice value="#">WorkDay</choice>
        <change>
          <condition value="#">
            <set token="form.jumpto">panel_workday</set>
            <unset token="form.jumpto_workday"></unset>
            <set token="value"></set>
          </condition>
          <condition>
            <unset token="form.jumpto_workday"></unset>
            <set token="value"></set>
          </condition>
        </change>
      </input>
      <input id="linkExpand_workday" type="link" token="toklinkExpand_workday" depends="$showExpandLink_workday$" searchWhenChanged="true">
        <label>$count_workday$</label>
        <choice value="#">WorkDay</choice>
        <change>
          <condition value="#">
            <set token="form.toklinkExpand_workday">-#-</set>
            <set token="form.jumpto">panel_workday</set>
          </condition>
          <condition value="-#-">
            <set token="showCollapseLink_workday">true</set>
            <set token="form.toklinkCollapse_workday">true</set>
            <unset token="showExpandLink_workday"></unset>
            <unset token="form.toklinkExpand_workday"></unset>
            <unset token="unextra_workday"></unset>
            <set token="value"></set>
            <set token="extra_workday">true</set>
            <!--<eval token="form.input_cache">mvappend("extra_workday",$form.input_cache$)</eval>-->
            <eval token="form.input_cache">if(NOT match($form.input_cache$,"extra_workday"),coalesce($form.input_cache$,"")+".extra_workday",$form.input_cache$)</eval>
          </condition>
        </change>
      </input>
      <input id="linkCollapse_workday" type="link" token="toklinkCollapse_workday" searchWhenChanged="true" depends="$extra_workday$" rejects="$unextra_workday$">
        <label></label>
        <choice value="#">X</choice>
        <change>
          <condition value="#">
            <unset token="showCollapseLink_workday"></unset>
            <unset token="form.toklinkCollapse_workday"></unset>
            <set token="showExpandLink_workday">true</set>
            <set token="form.toklinkExpand_workday">true</set>
            <set token="unextra_workday">true</set>
            <set token="value"></set>
            <!--<eval token="form.input_cache">mvfilter(NOT match($form.input_cache$,"extra_workday"))</eval>-->
            <eval token="form.input_cache">replace($form.input_cache$,"\\.extra_workday","")</eval>
          </condition>
        </change>
      </input>
      <input id="jumpto_bluecat" type="link" token="jumpto_bluecat" searchWhenChanged="true" depends="$showCollapseLink_bluecat$">
        <label>$count_bluecat$</label>
        <choice value="#">Bluecat</choice>
        <change>
          <condition value="#">
            <set token="form.jumpto">panel_bluecat</set>
            <unset token="form.jumpto_bluecat"></unset>
            <set token="value"></set>
          </condition>
          <condition>
            <unset token="form.jumpto_bluecat"></unset>
            <set token="value"></set>
          </condition>
        </change>
      </input>
      <input id="linkExpand_bluecat" type="link" token="toklinkExpand_bluecat" depends="$showExpandLink_bluecat$" searchWhenChanged="true">
        <label>$count_bluecat$</label>
        <choice value="#">Bluecat</choice>
        <change>
          <condition value="#">
            <set token="form.toklinkExpand_bluecat">-#-</set>
            <set token="form.jumpto">panel_bluecat</set>
          </condition>
          <condition value="-#-">
            <set token="showCollapseLink_bluecat">true</set>
            <set token="form.toklinkCollapse_bluecat">true</set>
            <unset token="showExpandLink_bluecat"></unset>
            <unset token="form.toklinkExpand_bluecat"></unset>
            <unset token="unextra_bluecat"></unset>
            <set token="value"></set>
            <set token="extra_bluecat">true</set>
            <!--<eval token="form.input_cache">mvappend("extra_bluecat",$form.input_cache$)</eval>-->
            <eval token="form.input_cache">if(NOT match($form.input_cache$,"extra_bluecat"),coalesce($form.input_cache$,"")+".extra_bluecat",$form.input_cache$)</eval>
          </condition>
        </change>
      </input>
      <input id="linkCollapse_bluecat" type="link" token="toklinkCollapse_bluecat" searchWhenChanged="true" depends="$extra_bluecat$" rejects="$unextra_bluecat$">
        <label></label>
        <choice value="#">X</choice>
        <change>
          <condition value="#">
            <unset token="showCollapseLink_bluecat"></unset>
            <unset token="form.toklinkCollapse_bluecat"></unset>
            <set token="showExpandLink_bluecat">true</set>
            <set token="form.toklinkExpand_bluecat">true</set>
            <set token="unextra_bluecat">true</set>
            <set token="value"></set>
            <!--<eval token="form.input_cache">mvfilter(NOT match($form.input_cache$,"extra_bluecat"))</eval>-->
            <eval token="form.input_cache">replace($form.input_cache$,"\\.extra_bluecat","")</eval>
          </condition>
        </change>
      </input>
      <input id="jumpto_snow" type="link" token="jumpto_snow" searchWhenChanged="true" depends="$showCollapseLink_snow$">
        <label>$count_snow$</label>
        <choice value="#">SNOW</choice>
        <change>
          <condition value="#">
            <set token="form.jumpto">panel_snow</set>
            <unset token="form.jumpto_snow"></unset>
            <set token="value"></set>
          </condition>
          <condition>
            <unset token="form.jumpto_snow"></unset>
            <set token="value"></set>
          </condition>
        </change>
      </input>
      <input id="linkExpand_snow" type="link" token="toklinkExpand_snow" depends="$showExpandLink_snow$" searchWhenChanged="true">
        <label>$count_snow$</label>
        <choice value="#">SNOW</choice>
        <change>
          <condition value="#">
            <set token="form.toklinkExpand_snow">-#-</set>
            <set token="form.jumpto">panel_snow</set>
          </condition>
          <condition value="-#-">
            <set token="showCollapseLink_snow">true</set>
            <set token="form.toklinkCollapse_snow">true</set>
            <unset token="showExpandLink_snow"></unset>
            <unset token="form.toklinkExpand_snow"></unset>
            <unset token="unextra_snow"></unset>
            <set token="value"></set>
            <set token="extra_snow">true</set>
            <!--<eval token="form.input_cache">mvappend("extra_snow",$form.input_cache$)</eval>-->
            <eval token="form.input_cache">if(NOT match($form.input_cache$,"extra_snow"),coalesce($form.input_cache$,"")+".extra_snow",$form.input_cache$)</eval>
          </condition>
        </change>
      </input>
      <input id="linkCollapse_snow" type="link" token="toklinkCollapse_snow" searchWhenChanged="true" depends="$extra_snow$" rejects="$unextra_snow$">
        <label></label>
        <choice value="#">X</choice>
        <change>
          <condition value="#">
            <unset token="showCollapseLink_snow"></unset>
            <unset token="form.toklinkCollapse_snow"></unset>
            <set token="showExpandLink_snow">true</set>
            <set token="form.toklinkExpand_snow">true</set>
            <set token="unextra_snow">true</set>
            <set token="value"></set>
            <!--<eval token="form.input_cache">mvfilter(NOT match($form.input_cache$,"extra_snow"))</eval>-->
            <eval token="form.input_cache">replace($form.input_cache$,"\\.extra_snow","")</eval>
          </condition>
        </change>
      </input>
      <input id="jumpto_deepwatch" type="link" token="jumpto_deepwatch" searchWhenChanged="true" depends="$showCollapseLink_deepwatch$">
        <label>$count_deepwatch$</label>
        <choice value="#">DeepWatch</choice>
        <change>
          <condition value="#">
            <set token="form.jumpto">panel_deepwatch</set>
            <unset token="form.jumpto_deepwatch"></unset>
            <set token="value"></set>
          </condition>
          <condition>
            <unset token="form.jumpto_deepwatch"></unset>
            <set token="value"></set>
          </condition>
        </change>
      </input>
      <input id="linkExpand_deepwatch" type="link" token="toklinkExpand_deepwatch" depends="$showExpandLink_deepwatch$" searchWhenChanged="true">
        <label>$count_deepwatch$</label>
        <choice value="#">DeepWatch</choice>
        <change>
          <condition value="#">
            <set token="form.toklinkExpand_deepwatch">-#-</set>
            <set token="form.jumpto">panel_deepwatch</set>
          </condition>
          <condition value="-#-">
            <set token="showCollapseLink_deepwatch">true</set>
            <set token="form.toklinkCollapse_deepwatch">true</set>
            <unset token="showExpandLink_deepwatch"></unset>
            <unset token="form.toklinkExpand_deepwatch"></unset>
            <unset token="unextra_deepwatch"></unset>
            <set token="value"></set>
            <set token="extra_deepwatch">true</set>
            <!--<eval token="form.input_cache">mvappend("extra_deepwatch",$form.input_cache$)</eval>-->
            <eval token="form.input_cache">if(NOT match($form.input_cache$,"extra_deepwatch"),coalesce($form.input_cache$,"")+".extra_deepwatch",$form.input_cache$)</eval>
          </condition>
        </change>
      </input>
      <input id="linkCollapse_deepwatch" type="link" token="toklinkCollapse_deepwatch" searchWhenChanged="true" depends="$extra_deepwatch$" rejects="$unextra_deepwatch$">
        <label></label>
        <choice value="#">X</choice>
        <change>
          <condition value="#">
            <unset token="showCollapseLink_deepwatch"></unset>
            <unset token="form.toklinkCollapse_deepwatch"></unset>
            <set token="showExpandLink_deepwatch">true</set>
            <set token="form.toklinkExpand_deepwatch">true</set>
            <set token="unextra_deepwatch">true</set>
            <set token="value"></set>
            <!--<eval token="form.input_cache">mvfilter(NOT match($form.input_cache$,"extra_deepwatch"))</eval>-->
            <eval token="form.input_cache">replace($form.input_cache$,"\\.extra_deepwatch","")</eval>
          </condition>
        </change>
      </input>
      <input id="jumpto_salesforce" type="link" token="jumpto_salesforce" searchWhenChanged="true" depends="$showCollapseLink_salesforce$">
        <label>$count_salesforce$</label>
        <choice value="#">Salesforce</choice>
        <change>
          <condition value="#">
            <set token="form.jumpto">panel_salesforce</set>
            <unset token="form.jumpto_salesforce"></unset>
            <set token="value"></set>
          </condition>
          <condition>
            <unset token="form.jumpto_salesforce"></unset>
            <set token="value"></set>
          </condition>
        </change>
      </input>
      <input id="linkExpand_salesforce" type="link" token="toklinkExpand_salesforce" depends="$showExpandLink_salesforce$" searchWhenChanged="true">
        <label>$count_salesforce$</label>
        <choice value="#">Salesforce</choice>
        <change>
          <condition value="#">
            <set token="form.toklinkExpand_salesforce">-#-</set>
            <set token="form.jumpto">panel_salesforce</set>
          </condition>
          <condition value="-#-">
            <set token="showCollapseLink_salesforce">true</set>
            <set token="form.toklinkCollapse_salesforce">true</set>
            <unset token="showExpandLink_salesforce"></unset>
            <unset token="form.toklinkExpand_salesforce"></unset>
            <unset token="unextra_salesforce"></unset>
            <set token="value"></set>
            <set token="extra_salesforce">true</set>
            <!--<eval token="form.input_cache">mvappend("extra_salesforce",$form.input_cache$)</eval>-->
            <eval token="form.input_cache">if(NOT match($form.input_cache$,"extra_salesforce"),coalesce($form.input_cache$,"")+".extra_salesforce",$form.input_cache$)</eval>
          </condition>
        </change>
      </input>
      <input id="linkCollapse_salesforce" type="link" token="toklinkCollapse_salesforce" searchWhenChanged="true" depends="$extra_salesforce$" rejects="$unextra_salesforce$">
        <label></label>
        <choice value="#">X</choice>
        <change>
          <condition value="#">
            <unset token="showCollapseLink_salesforce"></unset>
            <unset token="form.toklinkCollapse_salesforce"></unset>
            <set token="showExpandLink_salesforce">true</set>
            <set token="form.toklinkExpand_salesforce">true</set>
            <set token="unextra_salesforce">true</set>
            <set token="value"></set>
            <!--<eval token="form.input_cache">mvfilter(NOT match($form.input_cache$,"extra_salesforce"))</eval>-->
            <eval token="form.input_cache">replace($form.input_cache$,"\\.extra_salesforce","")</eval>
          </condition>
        </change>
      </input>
      <input id="jumpto_epic" type="link" token="jumpto_epic" searchWhenChanged="true" depends="$showCollapseLink_epic$">
        <label>$count_epic$</label>
        <choice value="#">EPIC</choice>
        <change>
          <condition value="#">
            <set token="form.jumpto">panel_epic</set>
            <unset token="form.jumpto_epic"></unset>
            <set token="value"></set>
          </condition>
          <condition>
            <unset token="form.jumpto_epic"></unset>
            <set token="value"></set>
          </condition>
        </change>
      </input>
      <input id="linkExpand_epic" type="link" token="toklinkExpand_epic" depends="$showExpandLink_epic$" searchWhenChanged="true">
        <label>$count_epic$</label>
        <choice value="#">EPIC</choice>
        <change>
          <condition value="#">
            <set token="form.toklinkExpand_epic">-#-</set>
            <set token="form.jumpto">panel_epic</set>
          </condition>
          <condition value="-#-">
            <set token="showCollapseLink_epic">true</set>
            <set token="form.toklinkCollapse_epic">true</set>
            <unset token="showExpandLink_epic"></unset>
            <unset token="form.toklinkExpand_epic"></unset>
            <unset token="unextra_epic"></unset>
            <set token="value"></set>
            <set token="extra_epic">true</set>
            <!--<eval token="form.input_cache">mvappend("extra_epic",$form.input_cache$)</eval>-->
            <eval token="form.input_cache">if(NOT match($form.input_cache$,"extra_epic"),coalesce($form.input_cache$,"")+".extra_epic",$form.input_cache$)</eval>
          </condition>
        </change>
      </input>
      <input id="linkCollapse_epic" type="link" token="toklinkCollapse_epic" searchWhenChanged="true" depends="$extra_epic$" rejects="$unextra_epic$">
        <label></label>
        <choice value="#">X</choice>
        <change>
          <condition value="#">
            <unset token="showCollapseLink_epic"></unset>
            <unset token="form.toklinkCollapse_epic"></unset>
            <set token="showExpandLink_epic">true</set>
            <set token="form.toklinkExpand_epic">true</set>
            <set token="unextra_epic">true</set>
            <set token="value"></set>
            <!--<eval token="form.input_cache">mvfilter(NOT match($form.input_cache$,"extra_epic"))</eval>-->
            <eval token="form.input_cache">replace($form.input_cache$,"\\.extra_epic","")</eval>
          </condition>
        </change>
      </input>
      <input id="jumpto_cquery" type="link" token="jumpto_cquery" searchWhenChanged="true" depends="$showCollapseLink_cquery$">
        <label>$count_cquery$</label>
        <choice value="#">Custom Query</choice>
        <change>
          <condition value="#">
            <set token="form.jumpto">panel_cquery</set>
            <unset token="form.jumpto_cquery"></unset>
            <set token="value"></set>
          </condition>
          <condition>
            <unset token="form.jumpto_cquery"></unset>
            <set token="value"></set>
          </condition>
        </change>
      </input>
      <input id="linkExpand_cquery" type="link" token="toklinkExpand_cquery" depends="$showExpandLink_cquery$" searchWhenChanged="true">
        <label>$count_cquery$</label>
        <choice value="#">Custom Query</choice>
        <change>
          <condition value="#">
            <set token="showCollapseLink_cquery">true</set>
            <set token="form.toklinkCollapse_cquery">true</set>
            <unset token="showExpandLink_cquery"></unset>
            <unset token="form.toklinkExpand_cquery"></unset>
            <unset token="unextra_cquery"></unset>
            <set token="value"></set>
            <set token="extra_cquery">true</set>
            <!--<eval token="form.input_cache">mvappend("extra_cquery",$form.input_cache$)</eval>-->
            <eval token="form.input_cache">if(NOT match($form.input_cache$,"extra_cquery"),coalesce($form.input_cache$,"")+".extra_cquery",$form.input_cache$)</eval>
            <set token="form.jumpto">panel_cquery</set>
          </condition>
          <condition value="-#-">
            <set token="showCollapseLink_cquery">true</set>
            <set token="form.toklinkCollapse_cquery">true</set>
            <unset token="showExpandLink_cquery"></unset>
            <unset token="form.toklinkExpand_cquery"></unset>
            <unset token="unextra_cquery"></unset>
            <set token="value"></set>
            <set token="extra_cquery">true</set>
            <!--<eval token="form.input_cache">mvappend("extra_cquery",$form.input_cache$)</eval>-->
            <eval token="form.input_cache">if(NOT match($form.input_cache$,"extra_cquery"),coalesce($form.input_cache$,"")+".extra_cquery",$form.input_cache$)</eval>
          </condition>
        </change>
      </input>
      <input id="linkCollapse_cquery" type="link" token="toklinkCollapse_cquery" searchWhenChanged="true" depends="$extra_cquery$" rejects="$unextra_cquery$">
        <label></label>
        <choice value="#">X</choice>
        <change>
          <condition value="#">
            <unset token="showCollapseLink_cquery"></unset>
            <unset token="form.toklinkCollapse_cquery"></unset>
            <set token="showExpandLink_cquery">true</set>
            <set token="form.toklinkExpand_cquery">true</set>
            <set token="unextra_cquery">true</set>
            <set token="value"></set>
            <!--<eval token="form.input_cache">mvfilter(NOT match($form.input_cache$,"extra_cquery"))</eval>-->
            <eval token="form.input_cache">replace($form.input_cache$,"\\.extra_cquery","")</eval>
          </condition>
        </change>
      </input>

      <input id="linkCollapse_osint" type="link" token="toklinkCollapse_osint" searchWhenChanged="true" depends="$showCollapseLink_osint$">
        <label>$result_time$</label>
        <choice value="#">OSINT</choice>
        <change>
          <condition value="#">
            <unset token="showCollapseLink_osint"></unset>
            <set token="showExpandLink_osint">true</set>
            <unset token="form.toklinkCollapse_osint"></unset>
            <set token="value"></set>
          </condition>
        </change>
      </input>
      <input id="linkExpand_osint" type="link" token="toklinkExpand_osint" depends="$showExpandLink_osint$" searchWhenChanged="true">
        <label>$result_time$</label>
        <choice value="#">OSINT</choice>
        <change>
          <condition value="#">
            <set token="form.jumpto">floatosint</set>
            <set token="showCollapseLink_osint">true</set>
            <unset token="showExpandLink_osint"></unset>
            <unset token="form.toklinkExpand_osint"></unset>
            <set token="value"></set>
          </condition>
        </change>
      </input>
    </panel>
  </row>
  <row>
    <panel depends="$done_input$;$nothingfound$;$filter_UID$;$filter_UID2$">
      <!--<search depends="$done_input$;$notfound_UID$;$notfound_auth$;$notfound_pingMFA$;$notfound_o365$;$notfound_azure$;$notfound_web$;$notfound_winevent$;$notfound_dns$;$notfound_edr$;$notfound_emails$;$notfound_workday$;$notfound_bluecat$;$notfound_deepwatch$;$notfound_snow$">
        <query>
          | makeresults
``` notfound ```
        </query>
        <progress>
          <condition match="mvcount($form.input_cache$) == 13">
            <set token="form.input_cache"></set>
          </condition>
        </progress>
      </search>-->
      <html>
        <pre>
Nothing found from the selected searches..


(╯°□°)╯︵ ┻━┻ FLIP THIS TABLE. 
┻━┻ ︵ ヽ(°□°ヽ) FLIP THAT TABLE. 
┻━┻ ︵ ＼\('0')/／ ︵ ┻━┻ FLIP ALL THE TABLES 

ಠ_ಠ Dude...
ಠ_ಠ Put.. 
ಠ__ಠ The tables. 
ಠ___ಠ Back!

(╮°-°)╮┳━┳ 

(╯°□°)╯︵ ┻━┻ NEVER!!!!
        </pre>
      </html>
    </panel>
  </row>
  <row>
    <panel depends="$done_input$;$nothingfound$;$filter_UID$;$filter_UID2$">
      <html>
      <u1> </u1>
    </html>
    </panel>
  </row>
  <row>
    <panel depends="$debug$">
      <html>
        <pre>
Debug:
keyword: $keyword$
keyword|s: $keyword|s$

filter: $filter$
filter|s: $filter|s$

edr_keyword: $edr_keyword$
edr_keyword|s: $edr_keyword|s$

edr_filter: $edr_filter$
edr_filter|s: $edr_filter|s$

filter_UID: $filter_UID$
filter_UID|s: $filter_UID|s$

filter_UID2: $filter_UID2$
filter_UID2|s: $filter_UID2|s$

init_cache: $init_cache$

        </pre>
      </html>
    </panel>
    <panel depends="$bad_input$">
      <html>
          <h3 style="color:red">$bad_input$</h3>
      </html>
    </panel>
    <panel depends="$form.killswitch$">
      <html>
        <pre>
          
                           ,---.
                          /    |
                         /     |
 You shall not pass!    /      |
                       /       |
          \       ___,'        |
                &lt;  -'          :
                 `-.__..--'``-,_\_
                    |o/ &lt;o&gt;` :,.)_`&gt;
                    :/ `     ||/)
                    (_.).__,-` |\
                    /( `.``   `| :
                    \'`-.)  `  ; ;
                    | `       /-&lt;
                    |     `  /   `.
    ,-_-..____     /|  `    :__..-'\
   /,'-.__\\  ``-./ :`      ;       \
   `\ `\  `\\  \ :  (   `  /  ,   `. \
     \` \   \\   |  | `   :  :     .\ \
      \ `\_  ))  :  ;     |  |      ): :
     (`-.-'\ ||  |\ \   ` ;  ;       | |
      \-_   `;;._   ( `  /  /_       | |
       `-.-.// ,'`-._\__/_,'         ; |
          \:: :     /     `     ,   /  |
           || |    (        ,' /   /   |
           ||                ,'   /    |


        </pre> 
      </html>
    </panel>
  </row>
  <row>
    <panel depends="$panel_input$">
      <title>Input processing</title>
      <table>
        <search id="input_proc">
          <query>| makeresults
          | eval keyword = (replace(replace(trim($form.keyword|s$),"(\\\\)","\\\\\\#"),"\\\#","\\\\\\"))
          | eval filter = (replace(replace(trim($form.filter|s$),"(\\\\)","\\\\\\#"),"\\\#","\\\\\\"))
          | eval edr_keyword = (replace(replace(trim(keyword),"([\\\]{2})","\\1\#"),"#","\\\\\\\\\\\\"))
          | eval edr_filter = (replace(replace(trim(filter),"([\\\]{2})","\\1\#"),"#","\\\\\\\\\\\\"))
          | table keyword filter edr_keyword edr_filter
``` $form.keyword$ $form.filter$ ```
          </query>
          <progress>
            <condition match="$job.isDone$ != 1">
              <unset token="done_input"></unset>
              <unset token="nothingfound"></unset>
              <eval token="search_start">now()</eval>
              <set token="panel_input">true</set>
              <set token="main_status">Input processing..</set>
              <unset token="exc_UID"></unset>
            </condition>
          </progress>
          <done>
            <condition match="($result.keyword$ == &quot;*&quot; AND $result.filter$ == &quot;*&quot;) OR (match($result.keyword$,&quot;\\*&quot;) AND match($result.keyword$,&quot;(?!(\\*|\\s)).&quot;) AND match($result.filter$,&quot;\\*&quot;) AND match($result.filter$,&quot;(?!(\\*|\\s)).&quot;)) OR (len($result.keyword$) &lt; 4 AND len($result.filter$) &lt; 4)">
              <set token="bad_input">Can NOT use * for both keyword and filter OR keyword is too short (must be &gt; 3 characters)</set>
              <unset token="done_input"></unset>
              <unset token="keyword"></unset>
              <unset token="filter"></unset>
              <unset token="panel_input"></unset>
              <unset token="panel_UID"></unset>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
            </condition>
            <condition>
              <unset token="extra_auth"></unset>
              <unset token="extra_pingMFA"></unset>
              <unset token="extra_o365"></unset>
              <unset token="extra_azure"></unset>
              <unset token="extra_emails"></unset>
              <unset token="extra_web"></unset>
              <unset token="extra_dns"></unset>
              <unset token="extra_edr"></unset>
              <unset token="extra_winevent"></unset>
              <unset token="extra_bluecat"></unset>
              <unset token="extra_workday"></unset>
              <unset token="extra_snow"></unset>
              <unset token="extra_deepwatch"></unset>
              <unset token="extra_salesforce"></unset>
              <unset token="extra_epic"></unset>
              <set token="form.input_reset">RESET</set>
              <eval token="form.reset_sub_filter">if($form.reset_sub_filter$=="Pending","","RESET")</eval>            

              <!--<eval token="tmp">split($extra_all$,",")</eval>
              <eval token="form.input_cache">if(len($form.input_cache$)&gt;0,$form.input_cache$,$tmp$)</eval>
              <set token="form.input_cache_activate">$form.input_cache$</set>-->
              <set token="keyword">$result.keyword$</set>
              <set token="filter">$result.filter$</set>
              <set token="edr_keyword">$result.edr_keyword$</set>
              <set token="edr_filter">$result.edr_filter$</set>
              <eval token="form.input_cache">replace($form.input_cache$,"null","")</eval>
              <eval token="form.input_cache">if((NOT $form.input_cache$),$extra_all$,$form.input_cache$)</eval>
              <set token="form.input_cache_activate">$form.input_cache$</set>
              <set token="done_input">true</set>
              <unset token="panel_input"></unset>
              <eval token="form.osint">if(match($form.keyword$,"[A-Fa-f0-9]{64}|[a-f0-9]{40}") OR match($form.keyword$,"[a-fA-F\\d]{32}") OR match($form.keyword$,"\\b[a-fA-F0-9]{64}\\b") OR match($form.keyword$,"\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}") OR match($form.keyword$,"([^\\/]+\\.?)\\.[^\\/]+") OR match($form.keyword$,"@\\S+\\.\\S+\\b") OR match($form.keyword$,"https?://"),$form.keyword$,"")</eval>
              <set token="main_status">Input DONE.</set>
              <eval token="runtime">now()-$search_start$</eval>
            </condition>
          </done>
          <earliest>$basetime.earliest$</earliest>
          <latest>$basetime.latest$</latest>
          <refresh>$refresh_timer$</refresh>
          <refreshType>delay</refreshType>
        </search>
        <option name="drilldown">none</option>
      </table>
    </panel>
  </row>
  <row>
    <panel rejects="$form.killswitch$" depends="$panel_UID$">
      <title>Identities</title>
        <input id="multi_UID" type="checkbox" token="multi_UID" depends="$is_multi_UID$" searchWhenChanged="true">
          <label></label>
          <choice value="true">Is Multi IDs?</choice>
          <change>
            <condition value="true">
              <set token="multi_UID">true</set>
              <set token="main_status">Input changed, re-submit to search</set>
              <unset token="form.killswitch"></unset>
              <!--<eval token="tmp">split($extra_all$,",")</eval>
              <eval token="form.input_cache">if(len($form.input_cache$)&gt;0,$form.input_cache$,$tmp$)</eval>
              <set token="form.input_cache_activate">$form.input_cache$</set>-->
              <!--<eval token="form.input_cache">replace($form.input_cache$,"null","")</eval>-->
              <eval token="form.input_cache">if((NOT $form.input_cache$),$extra_all$,$form.input_cache$)</eval>
              <set token="form.input_cache_activate">$form.input_cache$</set>
            </condition>
            <condition>
              <set token="multi_UID">false</set>
              <set token="main_status">Input changed, re-submit to search</set>
              <unset token="form.killswitch"></unset>
            </condition>
          </change>
        </input>
      <table depends="$hidden$">
        <search id="search_UID" depends="$done_input$">
          <progress>
            <condition>
              <set token="panel_UID">true</set>
              <unset token="nothingfound"></unset>
              <set token="main_status">Search is running..</set>
            </condition>
          </progress>
          <done>
            <condition match="($job.resultCount$ == 0 AND match($keyword$,&quot;\\S+&quot;) AND $keyword$ != &quot;*&quot;) ">
              <set token="filter">$keyword|s$ $filter|s$</set>
              <set token="edr_filter">$edr_keyword$ $edr_filter$</set>
              <set token="filter_UID">*</set>
              <set token="filter_UID2">*</set>
              <set token="query_auth">Authentication.dest=$keyword|s$ OR Authentication.src=$keyword|s$ OR Authentication.user=$keyword|s$ OR Authentication.app=$keyword|s$</set>
              <set token="query_authstats">| stats count BY Authentication.user
| sort count desc</set>
              <unset token="panel_UID"></unset>
              <set token="notfound_UID">true</set>
              <set token="query_web">getWebHistoryRAW($filter_UID2$,$filter$)</set>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
            </condition>
            <condition match="($job.resultCount$ == 1 AND $keyword$ != &quot;*&quot;)">
              <eval token="filter_UID">replace(tostring(if(match($result.identity$,"@"),mvfilter(match($result.identity$,"@")),$result.identity$)),","," OR ")</eval>
              <set token="filter_UID2">$result.UID$</set>
              <set token="panel_UID">true</set>
              <set token="query_auth">Authentication.user IN ($result.identity$) AND (Authentication.dest=$filter|s$ OR Authentication.src=$filter|s$ OR Authentication.user=$filter|s$ OR Authentication.app=$filter|s$)</set>
              <set token="query_authstats">| eval Auth_From = if(match('Authentication.src',"unknown"),'Authentication.dest','Authentication.src')
| iplocation Auth_From | stats values(Region) values(Country) count BY Auth_From
| sort count asc</set>
              <eval token="realname">if(isnull($result.realname$) OR match(lower($result.realname$),"service|account|security|system"),"1=0",$result.realname$)</eval>
              <eval token="query_web">getWebHistoryRAW($filter_UID2$,$filter$)</eval>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
            </condition>
            <condition match="($job.resultCount$ == 0 AND $keyword$ == &quot;*&quot;)">
              <set token="filter_UID">*</set>
              <set token="filter_UID2">*</set>
              <set token="query_auth">Authentication.dest=$filter|s$ OR Authentication.src=$filter|s$ OR Authentication.user=$filter|s$ OR Authentication.app=$filter|s$</set>
              <set token="query_authstats">| eval Auth_From = if(match('Authentication.src',"unknown"),'Authentication.dest','Authentication.src')
| iplocation Auth_From | stats values(Region) values(Country) count BY Auth_From
| sort count asc</set>
              <unset token="panel_UID"></unset>
              <set token="notfound_UID">true</set>
              <set token="query_web">getWebHistoryRAW($filter_UID2$,$filter$)</set>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
            </condition>
            <condition match="$job.resultCount$ &gt; 1 AND $multi_UID$ == &quot;true&quot;">
              <set token="exc_UID">""</set>
              <eval token="runtime">now()-$search_start$</eval>
            </condition>
            <condition match="($job.resultCount$ &gt; 1 AND $keyword$ == &quot;*&quot;) AND $multi_UID$ == &quot;false&quot;">
              <set token="query_auth">Authentication.dest=$filter|s$ OR Authentication.src=$filter|s$ OR Authentication.user=$filter|s$ OR Authentication.app=$filter|s$</set>
              <set token="query_authstats">| eval Auth_From = if(match('Authentication.src',"unknown"),'Authentication.dest','Authentication.src')
| iplocation Auth_From | stats values(Region) values(Country) count BY Auth_From
| sort count asc</set>
              <set token="filter">$keyword|s$ $filter|s$</set>
              <set token="edr_filter">$edr_keyword$ $edr_filter$</set>
              <set token="filter_UID">*</set>
              <set token="filter_UID2">*</set>
              <unset token="panel_UID"></unset>
              <set token="notfound_UID">true</set>
              <set token="query_web">getWebHistoryRAW($filter_UID2$,$filter$)</set>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="is_multi_UID">true</set>
            </condition>
            <condition match="($job.resultCount$ &gt; 1 AND $keyword$ != &quot;*&quot;) AND $multi_UID$ == &quot;false&quot;">
              <set token="query_auth">(Authentication.dest=$keyword|s$ OR Authentication.src=$keyword|s$ OR Authentication.user=$keyword|s$ OR Authentication.app=$keyword|s$) AND (Authentication.dest=$filter|s$ OR Authentication.src=$filter|s$ OR Authentication.user=$filter|s$ OR Authentication.app=$filter|s$)</set>
              <set token="query_authstats">| eval Auth_From = if(match('Authentication.src',"unknown"),'Authentication.dest','Authentication.src')
| iplocation Auth_From | stats values(Region) values(Country) count BY Auth_From
| sort count asc</set>
              <set token="filter">$keyword|s$ $filter|s$</set>
              <set token="edr_filter">$edr_keyword$ $edr_filter$</set>
              <set token="filter_UID">*</set>
              <set token="filter_UID2">*</set>
              <set token="panel_UID">true</set>
              <set token="notfound_UID">true</set>
              <set token="query_web">getWebHistoryRAW($filter_UID2$,$filter$)</set>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="is_multi_UID">true</set>
            </condition>
            <condition match="$job.resultCount$ == 0 AND $keyword$ != &quot;*&quot; AND NOT match($keyword$,&quot;\\S+&quot;)">
              <unset token="query_auth"></unset>
              <unset token="panel_UID"></unset>
              <set token="notfound_UID">true</set>
              <unset token="query_web"></unset>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="bad_input">Uh-oh.. Something went wrong. Please refresh the page.</set>
            </condition>
            <condition>
              <set token="main_status">Search for anything..</set>
            </condition>
          </done>
          <query>| from inputlookup:"identity_lookup_expanded"
``` THIS PART IS IMPORTANT ```
``` The idea is to have a lookup file which contains all usernames belong to a single user (ie. johndoe@company.com, jdoe, johndoe, etc) 
    Then we will merge them all into a single "UID" field. Doing this will help us search across multiple log sources with different username formats for a specific user.
    You can customize the "| table " bellow to fit your need. However, the UID is a ### MUST HAVE ### field.
```
| eval UID = "("+replace(tostring(identity)," "," OR ")+")"
| fields - suffix
| table identity original_identity email realname nick identity_tag bunit priority managedBy work_city watchlist UID             

``` $multi_UID$ $form.filter$ ```
          </query>
          <earliest>$basetime.earliest$</earliest>
          <latest>$basetime.latest$</latest>
          <refresh>$refresh_timer$</refresh>
          <refreshType>delay</refreshType>
        </search>
        <option name="count">10</option>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
      </table>
      <table depends="$hidden$">
        <search id="more_UID" base="search_UID" depends="$exc_UID$">
          <query>        
| where NOT nick IN ($exc_UID$)
``` $multi_UID$ $form.keyword$ $form.filter$ ```</query>
          <progress>
            <condition match="$exc_UID$ == &quot;\&quot;\&quot;&quot;">
              <set token="filter_UID">1=0</set>
              <set token="filter_UID2">(1=0)</set>
              <set token="query_auth">(1=0)</set>
            </condition>
          </progress>
          <done>
            <condition match="($job.resultCount$ &gt; 0 AND $keyword$ != &quot;*&quot;)">
                <set token="filter">$form.filter$</set>
                <set token="exc_UID">$exc_UID$,$result.nick|s$</set>
                <eval token="filter_UID">"("+replace(replace(tostring(if(match($result.identity$,"@"),mvfilter(match($result.identity$,"@")),$result.identity$)),","," OR ")+" OR "+$filter_UID$,"[\\(\\)]","")+")"</eval>
                <eval token="filter_UID2">"("+replace($result.UID$+" OR "+$filter_UID2$,"[\\(\\)]","")+")"</eval>
                <set token="panel_UID">true</set>
                <eval token="query_auth">(Authentication.user IN ($result.identity$) AND (Authentication.dest=$filter|s$ OR Authentication.src=$filter|s$ OR Authentication.user=$filter|s$ OR Authentication.app=$filter|s$))+" OR "+$query_auth$</eval>
                <set token="query_authstats">| eval Auth_From = if(match('Authentication.src',"unknown"),'Authentication.dest','Authentication.src')
| iplocation Auth_From | stats values(Region) values(Country) count BY Auth_From
| sort count asc</set>
                <set token="realname">$result.realname$</set>
                <eval token="query_web">getWebHistoryRAW($filter_UID2$,$filter$)</eval>
                <set token="main_status">Search for anything</set>
                <eval token="runtime">now()-$search_start$</eval>
              </condition>
          </done>
        </search>
      </table>
      <table>
        <search base="search_UID">
          <query>
| fields - watchlist UID
| transpose | rename column as "Fields"
| foreach "row *" [ eval Result_&lt;&lt;MATCHSTR&gt;&gt;='&lt;&lt;FIELD&gt;&gt;' ]
| fields - "row *"
            
``` $multi_UID$ $keyword$ $form.filter$ ```</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
      </table>
    </panel>
    <panel id="main_osint" rejects="$form.killswitch$">
      <title>OSINT Lookup</title>
      <input id="osint" type="text" token="osint" searchWhenChanged="true">
        <label>Input</label>
        <change>
          <condition>
            <unset token="form.show_osint"></unset>
          </condition>
          <condition match="match($form.osint$,&quot;\\S+&quot;) AND len($form.osint$) &gt; 0">
            <set token="osint">$form.osint$</set>
          </condition>
        </change>
        <default></default>
        <initialValue>$keyword$</initialValue>
      </input>
      <input type="link" token="clear_osint">
        <label></label>
        <choice value="clear">Clear</choice>
        <change>
          <condition value="clear">
            <set token="form.osint"></set>
            <unset token="form.clear_osint"></unset>
            <unset token="form.show_osint"></unset>
          </condition>
        </change>
      </input>
      <table depends="$form.show_osint$">
        <search id="search_osint">
          <done>
            <condition match="$job.resultCount$ &gt; 0">
              <set token="form.show_osint">true</set>
            </condition>
            <condition>
              <unset token="form.show_osint"></unset>
            </condition>
          </done>
          <query>| makeresults
| eval input = trim(replace($form.osint|s$,"[\"\s\&lt;\&gt;]",""))
| eval input2 = mvindex(split(input,"?"),1)
| rex field=input2 mode=sed "s:%:%25:g s: :%20:g s:&lt;:%3C:g s:&gt;:%3E:g s:#:%23:g s:{:%7B:g s:}:%7D:g s:\|:%7C:g s:\\\:%5C:g s:\^:%5E:g s:~:%7E:g s:\[:%5B:g s:\]:%5D:g s:\`:%60:g s:;:%3B:g s:/:%2F:g s:\?:%3F:g s/:/%3A/g s:@:%40:g s:=:%3D:g s:&amp;:%26:g s:\$:%24:g s:\!:%21:g s:\*:%2A:g"
| rex field=input "(?:https?:\/\/)?(?:[^\@\/\n]+\@)?(?:www\.)?([^:\/\?\n=]+\.)?(?&lt;extdomain&gt;[^:\/\\\?\n=]+\.[^:\/\?\n=\d]{2,8}(?![\w\.]))"
| eval VT = if((match(input,"[A-Fa-f0-9]{64}|[a-f0-9]{40}") OR match(input,"[a-fA-F\d]{32}") OR match(input,"\b[a-fA-F0-9]{64}\b")) AND NOT match(input,"[\s\b\/]"),"https://www.virustotal.com/gui/file/"+input,if(match(input,"\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}"),"https://www.virustotal.com/gui/ip-address/"+input,""))
| eval thatsthem = if(match(input,"@"),"https://thatsthem.com/email/"+input,"")
| eval proxycheck = if(match(input,"\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}"),"https://proxycheck.io/v2/"+input+"?vpn=1&amp;asn=1&amp;risk=1&amp;port=1&amp;seen=1&amp;days=7&amp;tag=msg","")
| eval sucuri = if(match(input,"https?://") OR (match(input,"([^\/]+\.?)\.[^\/]+") AND NOT match(input,"(\\\)")) AND NOT match(input,"@"),"https://sitecheck.sucuri.net/results/"+replace(coalesce(mvindex(split(input,"?"),0)+"?q="+input2,input),":/",""),"")
| eval abusedb = if(match(input,"\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}"),"https://www.abuseipdb.com/check/"+input,"")
| eval intelx = if(input!="","https://intelx.io/?s="+input,"")
| eval hybrid = if(input!="","https://www.hybrid-analysis.com/search?query="+input,"")
| eval joesb = if((match(input,"[A-Fa-f0-9]{64}|[a-f0-9]{40}") OR match(input,"[a-fA-F\d]{32}") OR match(input,"\b[a-fA-F0-9]{64}\b")),"https://www.joesandbox.com/search?q="+input,"")
| eval urlvoid = if(match(input,"https?://"),"https://www.urlvoid.com/scan/"+replace(input,"https?:\/\/(www\.)?",""),"")
| eval crowdstrike = if(input!="","https://falcon.us-2.crowdstrike.com/search/?term=_all%3A~%27"+input+"%27","")
| eval browserling = if(match(input,"https?://"),"https://www.browserling.com/browse/win10/chrome115/"+input,"")
| eval Tools = mvappend(browserling,
                        VT,
                        sucuri,
                        proxycheck,
                        abusedb,
                        thatsthem,
                        intelx,
                        hybrid,
                        joesb,
                        urlvoid
                        )
| eval Tools = mvdedup(if(extdomain!="",mvappend(Tools,"https://www.whois.com/whois/"+extdomain```,"https://intelx.io/?s="+extdomain,"https://sitecheck.sucuri.net/results/"+extdomain```),Tools))
| eval Tools = mvappend(Tools,crowdstrike)
| mvexpand Tools
| where Tools!=""
| table Tools
          </query>
          <earliest>-1s</earliest>
          <latest>now</latest>

        </search>
        <option name="drilldown">cell</option>
        <option name="refresh.display">progressbar</option>
        <drilldown>
          <condition match="$click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND $click.value2$ != &quot;N/A&quot; AND len($click.value2$) &gt; 3">
            <link target="_blank">$click.value2|n$</link>
          </condition>
        </drilldown>
      </table>
    </panel>
  </row>
  <row depends="$osint$">
    <panel>
      <html>
      <u1> </u1>
    </html>
    </panel>
  </row>
  <row id="floatosint">
    <panel>
      <table depends="$showCollapseLink_osint$">
        <search base="search_osint">
          <done>
            <condition match="$job.resultCount$ &gt; 0">
              <set token="form.show_osint">true</set>
            </condition>
          </done>
          <query>``` ```</query>
        </search>
        <option name="drilldown">cell</option>
        <option name="refresh.display">progressbar</option>
        <drilldown>
          <condition match="$click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND $click.value2$ != &quot;N/A&quot; AND len($click.value2$) &gt; 3">
            <link target="_blank">$click.value2|n$</link>
          </condition>
        </drilldown>
      </table>
    </panel>
  </row>
  <row>
    <panel id="panel_auth" depends="$showCollapseLink_auth$;$done_input$">
      <title>All Authentications</title>
      <input id="input_auth" type="text" token="filter_auth" depends="$showCollapseLink_auth$" searchWhenChanged="true">
        <label>Sub filter</label>
        <default>*</default>
        <initialValue>*</initialValue>
        <change>
          <condition match="$form.filter_auth$ != &quot;*&quot;">
            <unset token="main_auth"></unset>
            <set token="sub_auth">true</set>
          </condition>
          <condition>
            <set token="main_auth">true</set>
            <unset token="sub_auth"></unset>
          </condition>
        </change>
      </input>
      <input id="clear_auth" type="link" token="clear_auth" depends="$showCollapseLink_auth$">
        <label></label>
        <choice value="clear">Clear filter</choice>
        <change>
          <condition value="clear">
            <set token="form.filter_auth">*</set>
            <unset token="form.clear_auth"></unset>
          </condition>
          <condition>
            <unset token="form.clear_auth"></unset>
          </condition>
        </change>
      </input>
      <input type="time" token="time_auth" depends="$showCollapseLink_auth$" searchWhenChanged="true">
        <label></label>
        <default>
          <earliest>$time_auth.earliest$</earliest>
          <latest>$time_auth.latest$</latest>
        </default>
        <change>
          <set token="time_auth">$time_auth$</set>
        </change>
      </input>
      <input id="global_auth" type="checkbox" token="global_auth" depends="$showCollapseLink_auth$">
        <label></label>
        <choice value="true">Enable global search on click</choice>
        <change>
          <condition value="true">
            <set token="global_auth">true</set>
          </condition>
          <condition>
            <unset token="global_auth"></unset>
          </condition>
        </change>
        <delimiter> </delimiter>
      </input>
      <table depends="$main_auth$;$panel_auth$;$extra_auth$;$showCollapseLink_auth$;$filter_UID2$;$done_input$">
        <search rejects="$form.killswitch$" depends="$extra_auth$;$done_input$" id="search_auth">
          <progress>
            <condition>
              <set token="panel_auth">true</set>
              <unset token="job_auth"></unset>
              <unset token="nothingfound"></unset>
              <set token="showCollapseLink_auth">true</set>
              <unset token="showExpandLink_auth"></unset>
              <set token="form.toklinkCollapse_auth">true</set>
              <set token="main_status">Search is running..</set>
              <set token="count_auth">Running..</set>
            </condition>
          </progress>
          <error>
            <condition>
              <set token="panel_auth">true</set>
            </condition>
          </error>
          <done>
            <condition match="$job.resultCount$ == 0 AND $form.filter_auth$ == &quot;*&quot;">
              <unset token="job_auth"></unset>
              <!--<unset token="panel_auth"></unset>-->
              <set token="notfound_auth">true</set>
              <unset token="showCollapseLink_auth"></unset>
              <set token="showExpandLink_auth">true</set>
              <unset token="form.toklinkCollapse_auth"></unset>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_auth">[ $job.resultCount$ ]</set>
            </condition>
            <condition match="$job.resultCount$ &gt; 0">
              <set token="panel_auth">true</set>
              <set token="job_auth">true</set>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_auth">[ $job.resultCount$ ]</set>
            </condition>
            <condition match="$job.resultCount$ == 0">
              <set token="notfound_auth">true</set>
              <unset token="showCollapseLink_auth"></unset>
              <set token="showExpandLink_auth">true</set>
              <unset token="form.toklinkCollapse_auth"></unset>
              <set token="job_auth">true</set>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_auth">[ $job.resultCount$ ]</set>
            </condition>
            <condition>
              <set token="main_status">Search for anything..</set>
              <set token="count_auth">[ $job.resultCount$ ]</set>
            </condition>
          </done>
          <query>| tstats summariesonly=true allow_old_summaries=true count from datamodel=Authentication.Authentication where index=* AND ($query_auth$) by _time,Authentication.user,Authentication.src,Authentication.dest,Authentication.action,Authentication.app,index span=1s
| eval _raw='Authentication.user'+" "+'Authentication.app'+" "+'Authentication.src'+" "+'Authentication.dest'+" "+'Authentication.action'+" "+index
| sort 0 - _time
``` $form.filter$ $extra_auth$ ```
          </query>
          <earliest>$time_auth.earliest$</earliest>
          <latest>$time_auth.latest$</latest>

        </search>
        <option name="drilldown">cell</option>
        <option name="refresh.display">progressbar</option>
        <option name="totalsRow">false</option>
        <option name="wrap">true</option>
        <fields>_time,Authentication.user,Authentication.src,Authentication.dest,Authentication.action,Authentication.app,index</fields>
        <drilldown>
          <condition match="(NOT $global_auth$) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">replace(replace(replace($click.value2$,"[\\t\\r\\n\\f\\u200B]",""),"(\\\\)","\\\\\1"),"\\\"","\\\"")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="data">if(match($click.value2$,"[\\t\\r\\n]"),"*"+$data$,$data$)</eval>
            <set token="form.filter_auth">$click.name2$=$data$ $form.filter_auth$</set>
            <set token="form.jumpto">panel_auth</set>
            <!--<eval token="form.osint">if(match($data$,"[A-Fa-f0-9]{64}|[a-f0-9]{40}") OR match($data$,"[a-fA-F\\d]{32}") OR match($data$,"\\b[a-fA-F0-9]{64}\\b") OR match($data$,"\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}") OR match($data$,"([^\\/]+\\.?)\\.[^\\/]+") OR match($data$,"@\\S+\\.\\S+\\b") OR match($data$,"https?://"),$data$,$form.osint$)</eval>-->
            <eval token="form.osint">replace($data$," ","")</eval>
          </condition>
          <condition match="($global_auth$ == &quot;true&quot;) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND $click.value2$ != &quot;localhost&quot; AND $click.value2$ !=&quot;unknown&quot; AND len($click.value2$) &gt; 3 AND $click.name2$!=&quot;_time&quot; AND $click.name2$!=&quot;Authentication.action&quot; AND $click.name2$!=&quot;index&quot;">
            <eval token="data">replace($click.value2$,"[\\t\\r\\n\\f\\u200B]","")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="dd_s">relative_time($click.value$,"-"+$form.pivot_window$+"h")</eval>
            <eval token="dd_e">relative_time($click.value$,"+"+$form.pivot_window$+"h")</eval>
            <link target="_blank">[LINK TO YOUR SPLUNK APP]/$dashboard_id$?form.keyword=$data$&amp;form.basetime.earliest=$dd_s$&amp;form.basetime.latest=$dd_e$&amp;form.pivot_window=$form.pivot_window$</link>
          </condition>
          <condition>
            <!-- Do nothing -->
          </condition>
        </drilldown>
      </table>
      <table depends="$sub_auth$;$panel_auth$;$extra_auth$;$showCollapseLink_auth$;$filter_UID2$;$done_input$">
        <search rejects="$form.killswitch$" depends="$extra_auth$;$done_input$" base="search_auth" id="sub_search_auth">
          <progress>
            <condition>
              <set token="panel_auth">true</set>
              <unset token="job_auth"></unset>
              <unset token="nothingfound"></unset>
              <set token="showCollapseLink_auth">true</set>
              <unset token="showExpandLink_auth"></unset>
              <set token="form.toklinkCollapse_auth">true</set>
              <set token="main_status">Search is running..</set>
              <set token="count_auth">Running..</set>
            </condition>
          </progress>
          <error>
            <condition>
              <set token="panel_auth">true</set>
            </condition>
          </error>
          <done>
            <condition match="$job.resultCount$ == 0 AND $form.filter_auth$ == &quot;*&quot;">
              <unset token="job_auth"></unset>
              <!--<unset token="panel_auth"></unset>-->
              <set token="notfound_auth">true</set>
              <unset token="showCollapseLink_auth"></unset>
              <set token="showExpandLink_auth">true</set>
              <unset token="form.toklinkCollapse_auth"></unset>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_auth">[ $job.resultCount$ ]</set>
            </condition>
            <condition match="$job.resultCount$ &gt; 0">
              <set token="panel_auth">true</set>
              <set token="job_auth">true</set>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_auth">[ $job.resultCount$ ]</set>
            </condition>
            <condition match="$job.resultCount$ == 0">
              <set token="notfound_auth">true</set>
              <unset token="showCollapseLink_auth"></unset>
              <set token="showExpandLink_auth">true</set>
              <unset token="form.toklinkCollapse_auth"></unset>
              <set token="job_auth">true</set>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_auth">[ $job.resultCount$ ]</set>
            </condition>
            <condition>
              <set token="main_status">Search for anything..</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_auth">[ $job.resultCount$ ]</set>
            </condition>
          </done>
          <query>
| search $filter$ $form.filter_auth$
| fields - _raw
```$form.filter$ ```</query>
        </search>
        <option name="drilldown">cell</option>
        <option name="refresh.display">progressbar</option>
        <option name="totalsRow">false</option>
        <option name="wrap">true</option>
        <fields>_time,Authentication.user,Authentication.src,Authentication.dest,Authentication.action,Authentication.app,index</fields>
        <drilldown>
          <condition match="(NOT $global_auth$) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">replace(replace(replace($click.value2$,"[\\t\\r\\n\\f\\u200B]",""),"(\\\\)","\\\\\1"),"\\\"","\\\"")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="data">if(match($click.value2$,"[\\t\\r\\n]"),"*"+$data$,$data$)</eval>
            <set token="form.filter_auth">$click.name2$=$data$ $form.filter_auth$</set>
            <set token="form.jumpto">panel_auth</set>
            <eval token="form.osint">replace($data$," ","")</eval>
          </condition>
          <condition match="($global_auth$ == &quot;true&quot;) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND $click.value2$ != &quot;localhost&quot; AND $click.value2$ !=&quot;unknown&quot; AND len($click.value2$) &gt; 3 AND $click.name2$!=&quot;_time&quot; AND $click.name2$!=&quot;Authentication.action&quot; AND $click.name2$!=&quot;index&quot;">
            <eval token="data">replace($click.value2$,"[\\t\\r\\n\\f\\u200B]","")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="dd_s">relative_time($click.value$,"-"+$form.pivot_window$+"h")</eval>
            <eval token="dd_e">relative_time($click.value$,"+"+$form.pivot_window$+"h")</eval>
            <link target="_blank">[LINK TO YOUR SPLUNK APP]/$dashboard_id$?form.keyword=$data$&amp;form.basetime.earliest=$dd_s$&amp;form.basetime.latest=$dd_e$&amp;form.pivot_window=$form.pivot_window$</link>
          </condition>
          <condition>
            <!-- Do nothing -->
          </condition>
        </drilldown>
      </table>
    </panel>
    <panel depends="$main_auth$;$panel_auth$;$extra_auth$;$showCollapseLink_auth$;$filter_UID2$;$done_input$">
      <title>Authentication trend</title>
      <chart depends="$showCollapseLink_auth$;$panel_auth$;$filter_UID2$;$job_auth$;$done_input$">
        <search rejects="$form.killswitch$" depends="$extra_auth$;$done_input$" base="search_auth">
          <query>| timechart count by Authentication.action</query>

        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">-45</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.chart">line</option>
        <option name="charting.chart.showDataLabels">all</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.drilldown">none</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="height">300</option>
        <option name="refresh.display">progressbar</option>
      </chart>
      <single depends="$showCollapseLink_auth$;$panel_auth$;$filter_UID2$;$job_auth$;$done_input$">
        <search rejects="$form.killswitch$" depends="$extra_auth$;$done_input$" base="search_auth">
          <query>| search Authentication.action=success | stats count</query>

        </search>
        <option name="drilldown">all</option>
        <option name="height">60</option>
        <option name="rangeColors">["0x53a051","0x118832"]</option>
        <option name="rangeValues">[0]</option>
        <option name="underLabel">Success</option>
        <option name="useColors">1</option>
        <drilldown>
          <set token="form.filter_auth">success</set>
        </drilldown>
      </single>
      <single depends="$showCollapseLink_auth$;$panel_auth$;$filter_UID2$;$job_auth$;$done_input$">
        <search rejects="$form.killswitch$" depends="$extra_auth$;$done_input$" base="search_auth">
          <query>| search Authentication.action=failure | stats count</query>

        </search>
        <option name="colorMode">none</option>
        <option name="drilldown">all</option>
        <option name="height">60</option>
        <option name="rangeColors">["0xd41f1f","0xd41f1f"]</option>
        <option name="rangeValues">[0]</option>
        <option name="underLabel">Failure</option>
        <option name="unitPosition">after</option>
        <option name="useColors">1</option>
        <drilldown>
          <set token="form.filter_auth">failure</set>
        </drilldown>
      </single>
      <table depends="$showCollapseLink_auth$;$panel_auth$;$filter_UID2$;$job_auth$;$done_input$">
        <search rejects="$form.killswitch$" depends="$extra_auth$;$done_input$" base="search_auth">
          <query>$query_authstats$</query>
        </search>
        <option name="drilldown">cell</option>
        <option name="percentagesRow">false</option>
        <option name="refresh.display">progressbar</option>
        <option name="totalsRow">true</option>
        <drilldown>
          <condition match="match($click.value2$,&quot;(200.:)|(\\d+)(?&lt;!10)\\.(\\d+)(?&lt;!192\\.168)(?&lt;!172\\.(1[6-9]|2\\d|3[0-1]))\\.(\\d+)\\.(\\d+)&quot;) AND $click.name2$ == &quot;Auth_From&quot;">
            <link target="_blank">http://proxycheck.io/v2/$click.value2$?vpn=1&amp;asn=1&amp;risk=1&amp;port=1&amp;seen=1&amp;days=7&amp;tag=msg</link>
          </condition>
          <condition match="$click.name2$ == &quot;Authentication.user&quot;">
            <link target="_blank">[LINK TO YOUR SPLUNK APP]/$dashboard_id$?form.keyword=$click.value2$&amp;form.basetime.earliest=$earliest$&amp;form.basetime.latest=$latest$</link>
          </condition>
          <condition>
            <!-- Do nothing -->
          </condition>
        </drilldown>
      </table>
    </panel>
    <panel depends="$showCollapseLink_auth$;$sub_auth$">
      <title>Authentication trend</title>
      <chart depends="$showCollapseLink_auth$;$panel_auth$;$filter_UID2$;$job_auth$;$done_input$">
        <search rejects="$form.killswitch$" depends="$done_input$" base="sub_search_auth">
          <query>| timechart count by Authentication.action</query>

        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">-45</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.chart">line</option>
        <option name="charting.chart.showDataLabels">all</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.drilldown">none</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="height">300</option>
        <option name="refresh.display">progressbar</option>
      </chart>
      <single depends="$showCollapseLink_auth$;$panel_auth$;$filter_UID2$;$job_auth$;$done_input$">
        <search rejects="$form.killswitch$" depends="$done_input$" base="sub_search_auth">
          <query>| search Authentication.action=success | stats count</query>

        </search>
        <option name="drilldown">all</option>
        <option name="height">60</option>
        <option name="rangeColors">["0x53a051","0x118832"]</option>
        <option name="rangeValues">[0]</option>
        <option name="underLabel">Success</option>
        <option name="useColors">1</option>
        <drilldown>
          <set token="form.filter_auth">success</set>
        </drilldown>
      </single>
      <single depends="$showCollapseLink_auth$;$panel_auth$;$filter_UID2$;$job_auth$;$done_input$">
        <search rejects="$form.killswitch$" depends="$done_input$" base="sub_search_auth">
          <query>| search Authentication.action=failure | stats count</query>

        </search>
        <option name="colorMode">none</option>
        <option name="drilldown">all</option>
        <option name="height">60</option>
        <option name="rangeColors">["0xd41f1f","0xd41f1f"]</option>
        <option name="rangeValues">[0]</option>
        <option name="underLabel">Failure</option>
        <option name="unitPosition">after</option>
        <option name="useColors">1</option>
        <drilldown>
          <set token="form.filter_auth">failure</set>
        </drilldown>
      </single>
      <table depends="$showCollapseLink_auth$;$panel_auth$;$filter_UID2$;$job_auth$;$done_input$">
        <search rejects="$form.killswitch$" depends="$done_input$" base="sub_search_auth">
          <query>$query_authstats$</query>
        </search>
        <option name="drilldown">cell</option>
        <option name="percentagesRow">false</option>
        <option name="refresh.display">progressbar</option>
        <option name="totalsRow">true</option>
        <drilldown>
          <condition match="match($click.value2$,&quot;(200.:)|(\\d+)(?&lt;!10)\\.(\\d+)(?&lt;!192\\.168)(?&lt;!172\\.(1[6-9]|2\\d|3[0-1]))\\.(\\d+)\\.(\\d+)&quot;) AND $click.name2$ == &quot;Auth_From&quot;">
            <link target="_blank">http://proxycheck.io/v2/$click.value2$?vpn=1&amp;asn=1&amp;risk=1&amp;port=1&amp;seen=1&amp;days=7&amp;tag=msg</link>
          </condition>
          <condition match="$click.name2$ == &quot;Authentication.user&quot;">
            <link target="_blank">[LINK TO YOUR SPLUNK APP]/$dashboard_id$?form.keyword=$click.value2$&amp;form.basetime.earliest=$earliest$&amp;form.basetime.latest=$latest$</link>
          </condition>
          <condition>
            <!-- Do nothing -->
          </condition>
        </drilldown>
      </table>
    </panel>
  </row>
  <row depends="$panel_auth$;$extra_auth$;$showCollapseLink_auth$;$filter_UID2$;$done_input$" rejects="$notfound_auth$">
    <panel>
      <html>
      <u1> </u1>
    </html>
    </panel>
  </row>
  <row>
    <panel id="panel_pingMFA" depends="$showCollapseLink_pingMFA$;$done_input$">
      <title>Ping MFA</title>
      <input id="input_pingMFA" type="text" token="filter_pingMFA" depends="$showCollapseLink_pingMFA$" searchWhenChanged="true">
        <label>Sub filter</label>
        <default>*</default>
        <initialValue>*</initialValue>
        <change>
          <condition match="$form.filter_pingMFA$ != &quot;*&quot;">
            <unset token="main_pingMFA"></unset>
            <set token="sub_pingMFA">true</set>
          </condition>
          <condition>
            <set token="main_pingMFA">true</set>
            <unset token="sub_pingMFA"></unset>
          </condition>
        </change>
      </input>
      <input id="clear_pingMFA" type="link" token="clear_pingMFA" depends="$showCollapseLink_pingMFA$">
        <label></label>
        <choice value="clear">Clear filter</choice>
        <change>
          <condition value="clear">
            <set token="form.filter_pingMFA">*</set>
            <unset token="form.clear_pingMFA"></unset>
          </condition>
          <condition>
            <unset token="form.clear_pingMFA"></unset>
          </condition>
        </change>
      </input>
      <input type="time" token="time_pingMFA" depends="$showCollapseLink_pingMFA$" searchWhenChanged="true">
        <label></label>
        <default>
          <earliest>$time_pingMFA.earliest$</earliest>
          <latest>$time_pingMFA.latest$</latest>
        </default>
        <change>
          <set token="time_pingMFA">$time_pingMFA$</set>
        </change>
      </input>
      <input type="checkbox" token="global_pingMFA" depends="$showCollapseLink_pingMFA$">
        <label></label>
        <choice value="true">Enable global search on click</choice>
        <change>
          <condition value="true">
            <set token="global_pingMFA">true</set>
          </condition>
          <condition>
            <unset token="global_pingMFA"></unset>
          </condition>
        </change>
        <delimiter> </delimiter>
      </input>
      <table depends="$main_pingMFA$;$panel_pingMFA$;$extra_pingMFA$;$showCollapseLink_pingMFA$;$filter_UID2$;$done_input$">
        <search rejects="$form.killswitch$" depends="$extra_pingMFA$;$done_input$" id="search_pingMFA">
          <progress>
            <condition match="$form.filter_pingMFA$ != &quot;*&quot;">
              <unset token="main_pingMFA"></unset>
              <set token="sub_pingMFA">true</set>
              <set token="panel_pingMFA">true</set>
              <unset token="nothingfound"></unset>
              <set token="showCollapseLink_pingMFA">true</set>
              <unset token="showExpandLink_pingMFA"></unset>
              <set token="form.toklinkCollapse_pingMFA">true</set>
              <set token="main_status">Search is running..</set>
              <set token="count_pingMFA">Running..</set>
            </condition>
            <condition>
              <set token="main_pingMFA">true</set>
              <unset token="sub_pingMFA"></unset>
              <set token="panel_pingMFA">true</set>
              <unset token="nothingfound"></unset>
              <set token="showCollapseLink_pingMFA">true</set>
              <unset token="showExpandLink_pingMFA"></unset>
              <set token="form.toklinkCollapse_pingMFA">true</set>
              <set token="main_status">Search is running..</set>
              <set token="count_pingMFA">Running..</set>
            </condition>
          </progress>
          <error>
            <condition>
              <set token="panel_pingMFA">true</set>
            </condition>
          </error>
          <done>
            <condition match="$job.resultCount$ == 0 AND $form.filter_pingMFA$ == &quot;*&quot;">
              <!--<unset token="panel_pingMFA"></unset>-->
              <set token="notfound_pingMFA">true</set>
              <unset token="showCollapseLink_pingMFA"></unset>
              <set token="showExpandLink_pingMFA">true</set>
              <unset token="form.toklinkCollapse_pingMFA"></unset>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_pingMFA">[ $job.resultCount$ ]</set>
            </condition>
            <condition>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_pingMFA">[ $job.resultCount$ ]</set>
            </condition>
          </done>
          <query>`getPingMFARAW($filter$ $filter_UID2$)`
``` $extra_pingMFA$ ```
          </query>
          <earliest>$time_pingMFA.earliest$</earliest>
          <latest>$time_pingMFA.latest$</latest>

        </search>
        <option name="count">5</option>
        <option name="drilldown">cell</option>
        <option name="refresh.display">progressbar</option>
        <option name="totalsRow">false</option>
        <fields>_time user ReqIP NotifiedIP STATUS ReqApp NotifiedDevice prevLogin UserResponse websession</fields>
        <drilldown>
          <condition match="(NOT $global_pingMFA$) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">replace(replace(replace($click.value2$,"[\\t\\r\\n\\f\\u200B]",""),"(\\\\)","\\\\\1"),"\\\"","\\\"")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="data">if(match($click.value2$,"[\\t\\r\\n]"),"*"+$data$,$data$)</eval>
            <set token="form.filter_pingMFA">$click.name2$=$data$ $form.filter_pingMFA$</set>
            <set token="form.jumpto">panel_pingMFA</set>
            <eval token="form.osint">replace($data$," ","")</eval>
          </condition>
          <condition match="($global_pingMFA$ == &quot;true&quot;) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND len($click.value2$) &gt; 3 AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">replace($click.value2$,"[\\t\\r\\n\\f\\u200B]","")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="dd_s">relative_time($click.value$,"-"+$form.pivot_window$+"h")</eval>
            <eval token="dd_e">relative_time($click.value$,"+"+$form.pivot_window$+"h")</eval>
            <link target="_blank">[LINK TO YOUR SPLUNK APP]/$dashboard_id$?form.keyword=$data$&amp;form.basetime.earliest=$dd_s$&amp;form.basetime.latest=$dd_e$&amp;form.pivot_window=$form.pivot_window$</link>
          </condition>
          <condition>
            <!-- Do nothing -->
          </condition>
        </drilldown>
      </table>
      <table depends="$sub_pingMFA$;$panel_pingMFA$;$extra_pingMFA$;$showCollapseLink_pingMFA$;$filter_UID2$;$done_input$">
        <search rejects="$form.killswitch$" depends="$extra_pingMFA$;$done_input$;$sub_pingMFA$" base="search_pingMFA">
          <progress>
            <condition>
              <set token="panel_pingMFA">true</set>
              <unset token="nothingfound"></unset>
              <set token="showCollapseLink_pingMFA">true</set>
              <unset token="showExpandLink_pingMFA"></unset>
              <set token="form.toklinkCollapse_pingMFA">true</set>
              <set token="main_status">Search is running..</set>
              <set token="count_pingMFA">Running..</set>
            </condition>
          </progress>
          <error>
            <condition>
              <set token="panel_pingMFA">true</set>
            </condition>
          </error>
          <done>
            <condition>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_pingMFA">[ $job.resultCount$ ]</set>
            </condition>
          </done>
          <query>| search $form.filter_pingMFA$  
``` $sub_pingMFA$ ```
          </query>
        </search>
        <option name="count">5</option>
        <option name="drilldown">cell</option>
        <option name="totalsRow">false</option>
        <fields>_time user ReqIP NotifiedIP STATUS ReqApp NotifiedDevice prevLogin UserResponse websession</fields>
        <drilldown>
          <condition match="(NOT $global_pingMFA$) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">replace(replace(replace($click.value2$,"[\\t\\r\\n\\f\\u200B]",""),"(\\\\)","\\\\\1"),"\\\"","\\\"")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="data">if(match($click.value2$,"[\\t\\r\\n]"),"*"+$data$,$data$)</eval>
            <set token="form.filter_pingMFA">$click.name2$=$data$ $form.filter_pingMFA$</set>
            <set token="form.jumpto">panel_pingMFA</set>
            <eval token="form.osint">replace($data$," ","")</eval>
          </condition>
          <condition match="($global_pingMFA$ == &quot;true&quot;) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND len($click.value2$) &gt; 3 AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">replace($click.value2$,"[\\t\\r\\n\\f\\u200B]","")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="dd_s">relative_time($click.value$,"-"+$form.pivot_window$+"h")</eval>
            <eval token="dd_e">relative_time($click.value$,"+"+$form.pivot_window$+"h")</eval>
            <link target="_blank">[LINK TO YOUR SPLUNK APP]/$dashboard_id$?form.keyword=$data$&amp;form.basetime.earliest=$dd_s$&amp;form.basetime.latest=$dd_e$&amp;form.pivot_window=$form.pivot_window$</link>
          </condition>
          <condition>
            <!-- Do nothing -->
          </condition>
        </drilldown>
      </table>
    </panel>
  </row>
  <row depends="$panel_pingMFA$;$extra_pingMFA$;$showCollapseLink_pingMFA$;$filter_UID2$;$done_input$" rejects="$notfound_pingMFA$">
    <panel>
      <html>
      <u1> </u1>
    </html>
    </panel>
  </row>
  <row>
    <panel id="panel_o365" depends="$showCollapseLink_o365$;$done_input$">
      <title>O365</title>
      <input id="input_o365" type="text" token="filter_o365" depends="$showCollapseLink_o365$" searchWhenChanged="true">
        <label>Sub filter</label>
        <default>*</default>
        <initialValue>*</initialValue>
        <change>
          <condition match="$form.filter_o365$ != &quot;*&quot;">
            <unset token="main_o365"></unset>
            <set token="sub_o365">true</set>
          </condition>
          <condition>
            <set token="main_o365">true</set>
            <unset token="sub_o365"></unset>
          </condition>
        </change>
      </input>
      <input id="clear_o365" type="link" token="clear_o365" depends="$showCollapseLink_o365$">
        <label></label>
        <choice value="clear">Clear filter</choice>
        <change>
          <condition value="clear">
            <set token="form.filter_o365">*</set>
            <unset token="form.clear_o365"></unset>
          </condition>
          <condition>
            <unset token="form.clear_o365"></unset>
          </condition>
        </change>
      </input>
      <input type="time" token="time_o365" depends="$showCollapseLink_o365$" searchWhenChanged="true">
        <label></label>
        <default>
          <earliest>$time_o365.earliest$</earliest>
          <latest>$time_o365.latest$</latest>
        </default>
        <change>
          <set token="time_o365">$time_o365$</set>
        </change>
      </input>
      <input type="checkbox" token="global_o365" depends="$showCollapseLink_o365$">
        <label></label>
        <choice value="true">Enable global search on click</choice>
        <change>
          <condition value="true">
            <set token="global_o365">true</set>
          </condition>
          <condition>
            <unset token="global_o365"></unset>
          </condition>
        </change>
        <delimiter> </delimiter>
      </input>
      <table depends="$main_o365$;$panel_o365$;$extra_o365$;$showCollapseLink_o365$;$filter_UID2$;$done_input$">
        <search rejects="$form.killswitch$" depends="$extra_o365$;$done_input$" id="search_o365">
          <progress>
            <condition match="$form.filter_o365$ != &quot;*&quot;">
              <unset token="main_o365"></unset>
              <set token="sub_o365">true</set>
              <set token="panel_o365">true</set>
              <unset token="nothingfound"></unset>
              <set token="showCollapseLink_o365">true</set>
              <unset token="showExpandLink_o365"></unset>
              <set token="form.toklinkCollapse_o365">true</set>
              <set token="main_status">Search is running..</set>
              <set token="count_o365">Running..</set>
            </condition>
            <condition>
              <set token="main_o365">true</set>
              <unset token="sub_o365"></unset>
              <set token="panel_o365">true</set>
              <unset token="nothingfound"></unset>
              <set token="showCollapseLink_o365">true</set>
              <unset token="showExpandLink_o365"></unset>
              <set token="form.toklinkCollapse_o365">true</set>
              <set token="main_status">Search is running..</set>
              <set token="count_o365">Running..</set>
            </condition>
          </progress>
          <error>
            <condition>
              <set token="panel_o365">true</set>
            </condition>
          </error>
          <done>
            <condition match="$job.resultCount$ == 0 AND $form.filter_o365$ == &quot;*&quot;">
              <!--<unset token="panel_o365"></unset>-->
              <set token="notfound_o365">true</set>
              <unset token="showCollapseLink_o365"></unset>
              <set token="showExpandLink_o365">true</set>
              <unset token="form.toklinkCollapse_o365"></unset>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_o365">[ $job.resultCount$ ]</set>
            </condition>
            <condition>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_o365">[ $job.resultCount$ ]</set>
            </condition>
          </done>
          <query>`get365AuditRAW($filter_UID2$,$filter$ )` 
``` $extra_o365$ ```            
          </query>
          <earliest>$time_o365.earliest$</earliest>
          <latest>$time_o365.latest$</latest>

        </search>
        <option name="drilldown">cell</option>
        <option name="refresh.display">progressbar</option>
        <option name="totalsRow">true</option>
        <option name="wrap">true</option>
        <fields>_time src_ip UserId Process Operation ITEM UserAgent</fields>
        <drilldown>
          <condition match="$click.name2$==&quot;ITEM&quot; AND match($click.value2$,&quot;^https://security.microsoft.com/&quot;) AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;N/A&quot;">
            <link target="_blank">$click.value2|n$</link>
          </condition>
          <condition match="(NOT $global_o365$) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">replace(replace(replace($click.value2$,"[\\t\\r\\n\\f\\u200B]",""),"(\\\\)","\\\\\1"),"\\\"","\\\"")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="data">if(match($click.value2$,"[\\t\\r\\n]"),"*"+$data$,$data$)</eval>
            <set token="form.filter_o365">$click.name2$=$data$ $form.filter_o365$</set>
            <set token="form.jumpto">panel_o365</set>
            <eval token="form.osint">replace($data$," ","")</eval>
          </condition>
          <condition match="($global_o365$ == &quot;true&quot;) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND len($click.value2$) &gt; 3 AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">replace($click.value2$,"[\\t\\r\\n\\f\\u200B]","")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="dd_s">relative_time($click.value$,"-"+$form.pivot_window$+"h")</eval>
            <eval token="dd_e">relative_time($click.value$,"+"+$form.pivot_window$+"h")</eval>
            <link target="_blank">[LINK TO YOUR SPLUNK APP]/$dashboard_id$?form.keyword=$data$&amp;form.basetime.earliest=$dd_s$&amp;form.basetime.latest=$dd_e$&amp;form.pivot_window=$form.pivot_window$</link>
          </condition>
          <condition>
            <!-- Do nothing -->
          </condition>
        </drilldown>
      </table>
      <table depends="$sub_o365$;$panel_o365$;$extra_o365$;$showCollapseLink_o365$;$filter_UID2$;$done_input$">
        <search rejects="$form.killswitch$" depends="$extra_o365$;$done_input$;$sub_o365$" base="search_o365">
          <progress>
            <condition>
              <set token="panel_o365">true</set>
              <unset token="nothingfound"></unset>
              <set token="showCollapseLink_o365">true</set>
              <unset token="showExpandLink_o365"></unset>
              <set token="form.toklinkCollapse_o365">true</set>
              <set token="main_status">Search is running..</set>
              <set token="count_o365">Running..</set>
            </condition>
          </progress>
          <error>
            <condition>
              <set token="panel_o365">true</set>
            </condition>
          </error>
          <done>
            <condition>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_o365">[ $job.resultCount$ ]</set>
            </condition>
          </done>
          <query>| search $form.filter_o365$  
``` $sub_o365$ ```
          </query>
        </search>
        <option name="drilldown">cell</option>
        <option name="refresh.display">progressbar</option>
        <option name="totalsRow">true</option>
        <option name="wrap">true</option>
        <fields>_time src_ip UserId Process Operation ITEM UserAgent</fields>
        <drilldown>
          <condition match="$click.name2$==&quot;ITEM&quot; AND match($click.value2$,&quot;^https://security.microsoft.com/&quot;) AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;N/A&quot;">
            <link target="_blank">$click.value2|n$</link>
          </condition>
          <condition match="(NOT $global_o365$) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">replace(replace(replace($click.value2$,"[\\t\\r\\n\\f\\u200B]",""),"(\\\\)","\\\\\1"),"\\\"","\\\"")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="data">if(match($click.value2$,"[\\t\\r\\n]"),"*"+$data$,$data$)</eval>
            <set token="form.filter_o365">$click.name2$=$data$ $form.filter_o365$</set>
            <set token="form.jumpto">panel_o365</set>
            <eval token="form.osint">replace($data$," ","")</eval>
          </condition>
          <condition match="($global_o365$ == &quot;true&quot;) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND len($click.value2$) &gt; 3 AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">replace($click.value2$,"[\\t\\r\\n\\f\\u200B]","")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="dd_s">relative_time($click.value$,"-"+$form.pivot_window$+"h")</eval>
            <eval token="dd_e">relative_time($click.value$,"+"+$form.pivot_window$+"h")</eval>
            <link target="_blank">[LINK TO YOUR SPLUNK APP]/$dashboard_id$?form.keyword=$data$&amp;form.basetime.earliest=$dd_s$&amp;form.basetime.latest=$dd_e$&amp;form.pivot_window=$form.pivot_window$</link>
          </condition>
          <condition>
            <!-- Do nothing -->
          </condition>
        </drilldown>
      </table>
    </panel>
  </row>
  <row depends="$panel_o365$;$extra_o365$;$showCollapseLink_o365$;$filter_UID2$;$done_input$" rejects="$notfound_o365$">
    <panel>
      <html>
      <u1> </u1>
    </html>
    </panel>
  </row>
  <row>
    <panel id="panel_azure" depends="$showCollapseLink_azure$;$done_input$">
      <title>Azure</title>
      <input id="input_azure" type="text" token="filter_azure" depends="$showCollapseLink_azure$" searchWhenChanged="true">
        <label>Sub filter</label>
        <default>*</default>
        <initialValue>*</initialValue>
        <change>
          <condition match="$form.filter_azure$ != &quot;*&quot;">
            <unset token="main_azure"></unset>
            <set token="sub_azure">true</set>
          </condition>
          <condition>
            <set token="main_azure">true</set>
            <unset token="sub_azure"></unset>
          </condition>
        </change>
      </input>
      <input id="clear_azure" type="link" token="clear_azure" depends="$showCollapseLink_azure$">
        <label></label>
        <choice value="clear">Clear filter</choice>
        <change>
          <condition value="clear">
            <set token="form.filter_azure">*</set>
            <unset token="form.clear_azure"></unset>
          </condition>
          <condition>
            <unset token="form.clear_azure"></unset>
          </condition>
        </change>
      </input>
      <input type="time" token="time_azure" depends="$showCollapseLink_azure$" searchWhenChanged="true">
        <label></label>
        <default>
          <earliest>$time_azure.earliest$</earliest>
          <latest>$time_azure.latest$</latest>
        </default>
        <change>
          <set token="time_azure">$time_azure$</set>
        </change>
      </input>
      <input type="checkbox" token="global_azure" depends="$showCollapseLink_azure$">
        <label></label>
        <choice value="true">Enable global search on click</choice>
        <change>
          <condition value="true">
            <set token="global_azure">true</set>
          </condition>
          <condition>
            <unset token="global_azure"></unset>
          </condition>
        </change>
        <delimiter> </delimiter>
      </input>
      <table depends="$main_azure$;$panel_azure$;$extra_azure$;$showCollapseLink_azure$;$filter_UID2$;$done_input$">
        <search rejects="$form.killswitch$" depends="$extra_azure$;$done_input$" id="search_azure">
          <progress>
            <condition match="$form.filter_azure$ != &quot;*&quot;">
              <unset token="main_azure"></unset>
              <set token="sub_azure">true</set>
              <set token="panel_azure">true</set>
              <unset token="nothingfound"></unset>
              <set token="showCollapseLink_azure">true</set>
              <unset token="showExpandLink_azure"></unset>
              <set token="form.toklinkCollapse_azure">true</set>
              <set token="main_status">Search is running..</set>
              <set token="count_azure">Running..</set>
            </condition>
            <condition>
              <set token="main_azure">true</set>
              <unset token="sub_azure"></unset>
              <set token="panel_azure">true</set>
              <unset token="nothingfound"></unset>
              <set token="showCollapseLink_azure">true</set>
              <unset token="showExpandLink_azure"></unset>
              <set token="form.toklinkCollapse_azure">true</set>
              <set token="main_status">Search is running..</set>
              <set token="count_azure">Running..</set>
            </condition>
          </progress>
          <error>
            <condition>
              <set token="panel_azure">true</set>
            </condition>
          </error>
          <done>
            <condition match="$job.resultCount$ == 0 AND $form.filter_azure$ == &quot;*&quot;">
              <!--<unset token="panel_azure"></unset>-->
              <set token="notfound_azure">true</set>
              <unset token="showCollapseLink_azure"></unset>
              <set token="showExpandLink_azure">true</set>
              <unset token="form.toklinkCollapse_azure"></unset>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_azure">[ $job.resultCount$ ]</set>
            </condition>
            <condition>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_azure">[ $job.resultCount$ ]</set>
            </condition>
          </done>
          <query>`getAzureRAW($filter_UID2$,$filter$ )` 
``` $extra_azure$ ```            
          </query>
          <earliest>$time_azure.earliest$</earliest>
          <latest>$time_azure.latest$</latest>

        </search>
        <option name="drilldown">cell</option>
        <option name="refresh.display">progressbar</option>
        <option name="totalsRow">true</option>
        <option name="wrap">true</option>
        <fields>_time user src_ip result Operation ITEM user_agent</fields>
        <drilldown>
          <condition match="$click.name2$==&quot;ITEM&quot; AND match($click.value2$,&quot;^https://security.microsoft.com/&quot;) AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;N/A&quot;">
            <link target="_blank">$click.value2|n$</link>
          </condition>
          <condition match="(NOT $global_azure$) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">replace(replace(replace($click.value2$,"[\\t\\r\\n\\f\\u200B]",""),"(\\\\)","\\\\\1"),"\\\"","\\\"")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="data">if(match($click.value2$,"[\\t\\r\\n]"),"*"+$data$,$data$)</eval>
            <set token="form.filter_azure">$click.name2$=$data$ $form.filter_azure$</set>
            <set token="form.jumpto">panel_azure</set>
            <eval token="form.osint">replace($data$," ","")</eval>
          </condition>
          <condition match="($global_azure$ == &quot;true&quot;) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND len($click.value2$) &gt; 3 AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">replace($click.value2$,"[\\t\\r\\n\\f\\u200B]","")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="dd_s">relative_time($click.value$,"-"+$form.pivot_window$+"h")</eval>
            <eval token="dd_e">relative_time($click.value$,"+"+$form.pivot_window$+"h")</eval>
            <link target="_blank">[LINK TO YOUR SPLUNK APP]/$dashboard_id$?form.keyword=$data$&amp;form.basetime.earliest=$dd_s$&amp;form.basetime.latest=$dd_e$&amp;form.pivot_window=$form.pivot_window$</link>
          </condition>
          <condition>
            <!-- Do nothing -->
          </condition>
        </drilldown>
      </table>
      <table depends="$sub_azure$;$panel_azure$;$extra_azure$;$showCollapseLink_azure$;$filter_UID2$;$done_input$">
        <search rejects="$form.killswitch$" depends="$extra_azure$;$done_input$;$sub_azure$" base="search_azure">
          <progress>
            <condition>
              <set token="panel_azure">true</set>
              <unset token="nothingfound"></unset>
              <set token="showCollapseLink_azure">true</set>
              <unset token="showExpandLink_azure"></unset>
              <set token="form.toklinkCollapse_azure">true</set>
              <set token="main_status">Search is running..</set>
              <set token="count_azure">Running..</set>
            </condition>
          </progress>
          <error>
            <condition>
              <set token="panel_azure">true</set>
            </condition>
          </error>
          <done>
            <condition>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_azure">[ $job.resultCount$ ]</set>
            </condition>
          </done>
          <query>| search $form.filter_azure$  
``` $sub_azure$ ```
          </query>
        </search>
        <option name="drilldown">cell</option>
        <option name="refresh.display">progressbar</option>
        <option name="totalsRow">true</option>
        <option name="wrap">true</option>
        <fields>_time user src_ip result Operation ITEM user_agent</fields>
        <drilldown>
          <condition match="$click.name2$==&quot;ITEM&quot; AND match($click.value2$,&quot;^https://security.microsoft.com/&quot;) AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;N/A&quot;">
            <link target="_blank">$click.value2|n$</link>
          </condition>
          <condition match="(NOT $global_azure$) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">replace(replace(replace($click.value2$,"[\\t\\r\\n\\f\\u200B]",""),"(\\\\)","\\\\\1"),"\\\"","\\\"")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="data">if(match($click.value2$,"[\\t\\r\\n]"),"*"+$data$,$data$)</eval>
            <set token="form.filter_azure">$click.name2$=$data$ $form.filter_azure$</set>
            <set token="form.jumpto">panel_azure</set>
            <eval token="form.osint">replace($data$," ","")</eval>
          </condition>
          <condition match="($global_azure$ == &quot;true&quot;) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND len($click.value2$) &gt; 3 AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">replace($click.value2$,"[\\t\\r\\n\\f\\u200B]","")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="dd_s">relative_time($click.value$,"-"+$form.pivot_window$+"h")</eval>
            <eval token="dd_e">relative_time($click.value$,"+"+$form.pivot_window$+"h")</eval>
            <link target="_blank">[LINK TO YOUR SPLUNK APP]/$dashboard_id$?form.keyword=$data$&amp;form.basetime.earliest=$dd_s$&amp;form.basetime.latest=$dd_e$&amp;form.pivot_window=$form.pivot_window$</link>
          </condition>
          <condition>
            <!-- Do nothing -->
          </condition>
        </drilldown>
      </table>
    </panel>
  </row>
  <row depends="$panel_azure$;$extra_azure$;$showCollapseLink_azure$;$filter_UID2$;$done_input$" rejects="$notfound_azure$">
    <panel>
      <html>
      <u1> </u1>
    </html>
    </panel>
  </row>
  <row>
    <panel id="panel_emails" depends="$showCollapseLink_emails$;$done_input$">
      <title>Emails</title>
      <input id="input_emails" type="text" token="filter_emails" depends="$showCollapseLink_emails$" searchWhenChanged="true">
        <label>Sub filter</label>
        <default>*</default>
        <initialValue>*</initialValue>
        <change>
          <condition match="$form.filter_emails$ != &quot;*&quot;">
            <unset token="main_emails"></unset>
            <set token="sub_emails">true</set>
          </condition>
          <condition>
            <set token="main_emails">true</set>
            <unset token="sub_emails"></unset>
          </condition>
        </change>
      </input>
      <input id="clear_emails" type="link" token="clear_emails" depends="$showCollapseLink_emails$">
        <label></label>
        <choice value="clear">Clear filter</choice>
        <change>
          <condition value="clear">
            <set token="form.filter_emails">*</set>
            <unset token="form.clear_emails"></unset>
          </condition>
          <condition>
            <unset token="form.clear_emails"></unset>
          </condition>
        </change>
      </input>
      <input type="time" token="time_emails" depends="$showCollapseLink_emails$" searchWhenChanged="true">
        <label></label>
        <default>
          <earliest>$time_emails.earliest$</earliest>
          <latest>$time_emails.latest$</latest>
        </default>
        <change>
          <set token="time_emails">$time_emails$</set>
        </change>
      </input>
      <input type="checkbox" token="global_emails" depends="$showCollapseLink_emails$">
        <label></label>
        <choice value="true">Enable global search on click</choice>
        <change>
          <condition value="true">
            <set token="global_emails">true</set>
          </condition>
          <condition>
            <unset token="global_emails"></unset>
          </condition>
        </change>
        <delimiter> </delimiter>
      </input>
      <input type="checkbox" token="show_urls_check" depends="$showCollapseLink_emails$">
        <label></label>
        <choice value="true">Show URLs in emails</choice>
        <change>
          <condition value="true">
            <set token="show_urls">_time xSender subject xRecipient final_action Attachments url EmailSource</set>
          </condition>
          <condition>
            <set token="show_urls">_time xSender subject xRecipient final_action Attachments EmailSource</set>
          </condition>
        </change>
        <delimiter> </delimiter>
      </input>
      <table depends="$main_emails$;$panel_emails$;$extra_emails$;$showCollapseLink_emails$;$filter_UID$;$done_input$">
        <search rejects="$form.killswitch$" depends="$extra_emails$;$done_input$" id="search_emails">
          <progress>
            <condition match="$form.filter_emails$ != &quot;*&quot;">
              <unset token="main_emails"></unset>
              <set token="sub_emails">true</set>
              <set token="panel_emails">true</set>
              <unset token="nothingfound"></unset>
              <set token="showCollapseLink_emails">true</set>
              <unset token="showExpandLink_emails"></unset>
              <set token="form.toklinkCollapse_emails">true</set>
              <set token="main_status">Search is running..</set>
              <set token="count_emails">Running..</set>
            </condition>
            <condition>
              <set token="main_emails">true</set>
              <unset token="sub_emails"></unset>
              <set token="panel_emails">true</set>
              <unset token="nothingfound"></unset>
              <set token="showCollapseLink_emails">true</set>
              <unset token="showExpandLink_emails"></unset>
              <set token="form.toklinkCollapse_emails">true</set>
              <set token="main_status">Search is running..</set>
              <set token="count_emails">Running..</set>
            </condition>
          </progress>
          <error>
            <condition>
              <set token="panel_emails">true</set>
            </condition>
          </error>
          <done>
            <condition match="$job.resultCount$ == 0 AND $form.filter_emails$ == &quot;*&quot;">
              <!--<unset token="panel_emails"></unset>-->
              <set token="notfound_emails">true</set>
              <unset token="showCollapseLink_emails"></unset>
              <set token="showExpandLink_emails">true</set>
              <unset token="form.toklinkCollapse_emails"></unset>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_emails">[ $job.resultCount$ ]</set>
            </condition>
            <condition>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_emails">[ $job.resultCount$ ]</set>
            </condition>
          </done>
          <query>`getEmailsRAW($filter_UID$,$filter$)`
``` $extra_emails$ ```
          </query>
          <earliest>$time_emails.earliest$</earliest>
          <latest>$time_emails.latest$</latest>

        </search>
        <option name="count">5</option>
        <option name="drilldown">cell</option>
        <option name="totalsRow">true</option>
        <option name="wrap">true</option>
        <fields>$show_urls$</fields>
        <drilldown>
          <condition match="$click.name2$==&quot;subject&quot; AND match($click.value2$,&quot;^https://threatinsight.proofpoint.com/&quot;) AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;N/A&quot;">
            <link target="_blank">$click.value2|n$</link>
          </condition>
          <condition match="$click.name2$==&quot;EmailSource&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;N/A&quot;">
            <link target="_blank">https://adminapi.proofpoint.com/v2/message/$click.value2|n$/body?clusterId=[YOUR_PROOFPOINT]</link>
          </condition>
          <condition match="(NOT $global_emails$) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND $click.value2$ != &quot;N/A&quot; AND $click.name2$!=&quot;_time&quot; AND (NOT match($click.value2$,&quot;truncated&quot;))">
            <eval token="data">replace(replace(replace($click.value2$,"[\\t\\r\\n\\f\\u200B]",""),"(\\\\)","\\\\\1"),"\\\"","\\\"")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="data">if(match($click.value2$,"[\\t\\r\\n]"),"*"+$data$,$data$)</eval>
            <set token="form.filter_emails">$click.name2$=$data$ $form.filter_emails$</set>
            <set token="form.jumpto">panel_emails</set>
            <eval token="form.osint">replace($data$," ","")</eval>
          </condition>
          <condition match="($global_emails$ == &quot;true&quot;) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND $click.value2$ != &quot;N/A&quot; AND len($click.value2$) &gt; 3 AND $click.name2$!=&quot;_time&quot; AND (NOT match($click.value2$,&quot;truncated&quot;))">
            <eval token="data">replace($click.value2$,"[\\t\\r\\n\\f\\u200B]","")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="dd_s">relative_time($click.value$,"-"+$form.pivot_window$+"h")</eval>
            <eval token="dd_e">relative_time($click.value$,"+"+$form.pivot_window$+"h")</eval>
            <link target="_blank">[LINK TO YOUR SPLUNK APP]/$dashboard_id$?form.keyword=$data$&amp;form.basetime.earliest=$dd_s$&amp;form.basetime.latest=$dd_e$&amp;form.pivot_window=$form.pivot_window$</link>
          </condition>
          <condition>
            <!-- Do nothing -->
          </condition>
        </drilldown>
      </table>
      <table depends="$sub_emails$;$panel_emails$;$extra_emails$;$showCollapseLink_emails$;$filter_UID$;$done_input$">
        <search rejects="$form.killswitch$" depends="$extra_emails$;$done_input$;$sub_emails$" base="search_emails">
          <progress>
            <condition>
              <set token="panel_emails">true</set>
              <unset token="nothingfound"></unset>
              <set token="showCollapseLink_emails">true</set>
              <unset token="showExpandLink_emails"></unset>
              <set token="form.toklinkCollapse_emails">true</set>
              <set token="main_status">Search is running..</set>
              <set token="count_emails">Running..</set>
            </condition>
          </progress>
          <error>
            <condition>
              <set token="panel_emails">true</set>
            </condition>
          </error>
          <done>
            <condition>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_emails">[ $job.resultCount$ ]</set>
            </condition>
          </done>
          <query>| search $form.filter_emails$  
``` $sub_emails$ ```
          </query>
        </search>
        <option name="count">5</option>
        <option name="drilldown">cell</option>
        <option name="totalsRow">true</option>
        <option name="wrap">true</option>
        <fields>$show_urls$</fields>
        <drilldown>
          <condition match="$click.name2$==&quot;subject&quot; AND match($click.value2$,&quot;^https://threatinsight.proofpoint.com/&quot;) AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;N/A&quot;">
            <link target="_blank">$click.value2|n$</link>
          </condition>
          <condition match="$click.name2$==&quot;EmailSource&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;N/A&quot;">
            <link target="_blank">https://adminapi.proofpoint.com/v2/message/$click.value2|n$/body?clusterId=[YOUR_PROOFPOINT]</link>
          </condition>
          <condition match="(NOT $global_emails$) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND $click.value2$ != &quot;N/A&quot; AND $click.name2$!=&quot;_time&quot; AND (NOT match($click.value2$,&quot;truncated&quot;))">
            <eval token="data">replace(replace(replace($click.value2$,"[\\t\\r\\n\\f\\u200B]",""),"(\\\\)","\\\\\1"),"\\\"","\\\"")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="data">if(match($click.value2$,"[\\t\\r\\n]"),"*"+$data$,$data$)</eval>
            <set token="form.filter_emails">$click.name2$=$data$ $form.filter_emails$</set>
            <set token="form.jumpto">panel_emails</set>
            <eval token="form.osint">replace($data$," ","")</eval>
          </condition>
          <condition match="($global_emails$ == &quot;true&quot;) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND $click.value2$ != &quot;N/A&quot; AND len($click.value2$) &gt; 3 AND $click.name2$!=&quot;_time&quot; AND (NOT match($click.value2$,&quot;truncated&quot;))">
            <eval token="data">replace($click.value2$,"[\\t\\r\\n\\f\\u200B]","")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="dd_s">relative_time($click.value$,"-"+$form.pivot_window$+"h")</eval>
            <eval token="dd_e">relative_time($click.value$,"+"+$form.pivot_window$+"h")</eval>
            <link target="_blank">[LINK TO YOUR SPLUNK APP]/$dashboard_id$?form.keyword=$data$&amp;form.basetime.earliest=$dd_s$&amp;form.basetime.latest=$dd_e$&amp;form.pivot_window=$form.pivot_window$</link>
          </condition>
          <condition>
            <!-- Do nothing -->
          </condition>
        </drilldown>
      </table>
    </panel>
  </row>
  <row depends="$panel_emails$;$extra_emails$;$showCollapseLink_emails$;$filter_UID$;$done_input$" rejects="$notfound_emails$">
    <panel>
      <html>
      <u1> </u1>
    </html>
    </panel>
  </row>
  <row>
    <panel id="panel_web" depends="$showCollapseLink_web$;$done_input$">
      <title>Web/Network</title>
      <input id="input_web" type="text" token="filter_web" depends="$showCollapseLink_web$" searchWhenChanged="true">
        <label>Sub filter</label>
        <default>*</default>
        <initialValue>*</initialValue>
        <change>
          <condition match="$form.filter_web$ != &quot;*&quot; OR $form.exclude_splunk$ == &quot;true&quot; ">
            <unset token="main_web"></unset>
            <set token="sub_web">true</set>
          </condition>
          <condition>
            <set token="main_web">true</set>
            <unset token="sub_web"></unset>
          </condition>
        </change>
      </input>
      <input id="clear_web" type="link" token="clear_web" depends="$showCollapseLink_web$">
        <label></label>
        <choice value="clear">Clear filter</choice>
        <change>
          <condition value="clear">
            <set token="form.filter_web">*</set>
            <unset token="form.clear_web"></unset>
          </condition>
          <condition>
            <unset token="form.clear_web"></unset>
          </condition>
        </change>
      </input>
      <input type="time" token="time_web" depends="$showCollapseLink_web$" searchWhenChanged="true">
        <label></label>
        <default>
          <earliest>$time_web.earliest$</earliest>
          <latest>$time_web.latest$</latest>
        </default>
        <change>
          <set token="time_web">$time_web$</set>
        </change>
      </input>
      <input type="checkbox" token="global_web" depends="$showCollapseLink_web$">
        <label></label>
        <choice value="true">Enable global search on click</choice>
        <change>
          <condition value="true">
            <set token="global_web">true</set>
          </condition>
          <condition>
            <unset token="global_web"></unset>
          </condition>
        </change>
        <delimiter> </delimiter>
      </input>
      <input type="checkbox" token="exclude_splunk" depends="$showCollapseLink_web$">
        <label></label>
        <choice value="true">Exclude Splunk URLs</choice>
        <change>
          <condition value="true">
            <unset token="main_web"></unset>
            <set token="sub_web">true</set>
            <set token="query_splunk">| where NOT dest IN ("es-bhshsystem.splunkcloud.com","proxy-esp.experienceservices.splunkdev.net")</set>
          </condition>
          <condition>
            <set token="query_splunk">| where 1=1</set>
          </condition>
        </change>
        <delimiter> </delimiter>
      </input>      
      <table depends="$main_web$;$panel_web$;$extra_web$;$showCollapseLink_web$;$filter_UID2$;$done_input$">
        <search rejects="$form.killswitch$" depends="$extra_web$;$done_input$" id="search_web">
          <progress>
            <condition match="$form.filter_web$ != &quot;*&quot; OR $form.exclude_splunk$ == &quot;true&quot; ">
              <unset token="main_web"></unset>
              <set token="sub_web">true</set>
              <set token="panel_web">true</set>
              <unset token="nothingfound"></unset>
              <set token="showCollapseLink_web">true</set>
              <unset token="showExpandLink_web"></unset>
              <set token="form.toklinkCollapse_web">true</set>
              <set token="main_status">Search is running..</set>
              <set token="count_web">Running..</set>
            </condition>
            <condition>
              <set token="main_web">true</set>
              <unset token="sub_web"></unset>
              <set token="panel_web">true</set>
              <unset token="nothingfound"></unset>
              <set token="showCollapseLink_web">true</set>
              <unset token="showExpandLink_web"></unset>
              <set token="form.toklinkCollapse_web">true</set>
              <set token="main_status">Search is running..</set>
              <set token="count_web">Running..</set>
            </condition>
          </progress>
          <error>
            <condition>
              <set token="panel_web">true</set>
            </condition>
          </error>
          <done>
            <condition match="$job.resultCount$ == 0 AND $form.filter_web$ == &quot;*&quot;">
              <!--<unset token="panel_web"></unset>-->
              <set token="notfound_web">true</set>
              <unset token="showCollapseLink_web"></unset>
              <set token="showExpandLink_web">true</set>
              <unset token="form.toklinkCollapse_web"></unset>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_web">[ $job.resultCount$ ]</set>
            </condition>
            <condition>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_web">[ $job.resultCount$ ]</set>
            </condition>
          </done>
          <query>`$query_web$`
| table _time index action user src_ip dest squery dest_ip dest_port http_method url http_content_type status http_referrer _raw
``` $extra_web$ ```</query>
          <earliest>$time_web.earliest$</earliest>
          <latest>$time_web.latest$</latest>

        </search>
        <option name="drilldown">cell</option>
        <option name="refresh.display">progressbar</option>
        <option name="totalsRow">false</option>
        <fields>_time index action user src_ip dest squery dest_ip dest_port http_method url http_content_type status http_referrer</fields>
        <drilldown>
          <condition match="(NOT $global_web$) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">replace(replace(replace($click.value2$,"[\\t\\r\\n\\f\\u200B]",""),"(\\\\)","\\\\\1"),"\\\"","\\\"")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="data">if(match($click.value2$,"[\\t\\r\\n]"),"*"+$data$,$data$)</eval>
            <set token="form.filter_web">$click.name2$=$data$ $form.filter_web$</set>
            <set token="form.jumpto">panel_web</set>
            <eval token="form.osint">replace($data$," ","")</eval>
          </condition>
          <condition match="($global_web$ == &quot;true&quot;) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND len($click.value2$) &gt; 3 AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">replace($click.value2$,"[\\t\\r\\n\\f\\u200B]","")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="dd_s">relative_time($click.value$,"-"+$form.pivot_window$+"h")</eval>
            <eval token="dd_e">relative_time($click.value$,"+"+$form.pivot_window$+"h")</eval>
            <link target="_blank">[LINK TO YOUR SPLUNK APP]/$dashboard_id$?form.keyword=$data$&amp;form.basetime.earliest=$dd_s$&amp;form.basetime.latest=$dd_e$&amp;form.pivot_window=$form.pivot_window$</link>
          </condition>
          <condition>
            <!-- Do nothing -->
          </condition>
        </drilldown>
      </table>
      <table depends="$sub_web$;$panel_web$;$extra_web$;$showCollapseLink_web$;$filter_UID2$;$done_input$">
        <search rejects="$form.killswitch$" depends="$extra_web$;$done_input$;$sub_web$" base="search_web">
          <progress>
            <condition>
              <set token="panel_web">true</set>
              <unset token="nothingfound"></unset>
              <set token="showCollapseLink_web">true</set>
              <unset token="showExpandLink_web"></unset>
              <set token="form.toklinkCollapse_web">true</set>
              <set token="main_status">Search is running..</set>
              <set token="count_web">Running..</set>
            </condition>
          </progress>
          <error>
            <condition>
              <set token="panel_web">true</set>
            </condition>
          </error>
          <done>
            <condition match="$job.resultCount$ == 0 AND $form.filter_web$ == &quot;*&quot; AND $form.exclude_splunk$ == &quot;true&quot;">
              <!--<unset token="panel_web"></unset>-->
              <set token="notfound_web">true</set>
              <unset token="showCollapseLink_web"></unset>
              <set token="showExpandLink_web">true</set>
              <unset token="form.toklinkCollapse_web"></unset>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_web">[ $job.resultCount$ ]</set>
            </condition>
            <condition>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_web">[ $job.resultCount$ ]</set>
            </condition>
          </done>
          <query>
$query_splunk$
| search $form.filter_web$
``` $sub_web$ ```
          </query>
        </search>
        <option name="drilldown">cell</option>
        <option name="refresh.display">progressbar</option>
        <option name="totalsRow">false</option>
        <fields>_time index action user src_ip dest squery dest_ip dest_port http_method url http_content_type status http_referrer</fields>
        <drilldown>
          <condition match="(NOT $global_web$) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">replace(replace(replace($click.value2$,"[\\t\\r\\n\\f\\u200B]",""),"(\\\\)","\\\\\1"),"\\\"","\\\"")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="data">if(match($click.value2$,"[\\t\\r\\n]"),"*"+$data$,$data$)</eval>
            <set token="form.filter_web">$click.name2$=$data$ $form.filter_web$</set>
            <set token="form.jumpto">panel_web</set>
            <eval token="form.osint">replace($data$," ","")</eval>
          </condition>
          <condition match="($global_web$ == &quot;true&quot;) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND len($click.value2$) &gt; 3 AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">replace($click.value2$,"[\\t\\r\\n\\f\\u200B]","")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="dd_s">relative_time($click.value$,"-"+$form.pivot_window$+"h")</eval>
            <eval token="dd_e">relative_time($click.value$,"+"+$form.pivot_window$+"h")</eval>
            <link target="_blank">[LINK TO YOUR SPLUNK APP]/$dashboard_id$?form.keyword=$data$&amp;form.basetime.earliest=$dd_s$&amp;form.basetime.latest=$dd_e$&amp;form.pivot_window=$form.pivot_window$</link>
          </condition>
          <condition>
            <!-- Do nothing -->
          </condition>
        </drilldown>
      </table>
    </panel>
  </row>
  <row depends="$panel_web$;$extra_web$;$showCollapseLink_web$;$filter_UID2$;$done_input$" rejects="$notfound_web$">
    <panel>
      <html>
      <u1> </u1>
    </html>
    </panel>
  </row>
  <row>
    <panel id="panel_dns" depends="$showCollapseLink_dns$;$done_input$">
      <title>DNS</title>
      <input id="input_dns" type="text" token="filter_dns" depends="$showCollapseLink_dns$" searchWhenChanged="true">
        <label>Sub filter</label>
        <default>*</default>
        <initialValue>*</initialValue>
        <change>
          <condition match="$form.filter_dns$ != &quot;*&quot;">
            <unset token="main_dns"></unset>
            <set token="sub_dns">true</set>
          </condition>
          <condition>
            <set token="main_dns">true</set>
            <unset token="sub_dns"></unset>
          </condition>
        </change>
      </input>
      <input id="clear_dns" type="link" token="clear_dns" depends="$showCollapseLink_dns$">
        <label></label>
        <choice value="clear">Clear filter</choice>
        <change>
          <condition value="clear">
            <set token="form.filter_dns">*</set>
            <unset token="form.clear_dns"></unset>
          </condition>
          <condition>
            <unset token="form.clear_dns"></unset>
          </condition>
        </change>
      </input>
      <input type="time" token="time_dns" depends="$showCollapseLink_dns$" searchWhenChanged="true">
        <label></label>
        <default>
          <earliest>$time_dns.earliest$</earliest>
          <latest>$time_dns.latest$</latest>
        </default>
        <change>
          <set token="time_dns">$time_dns$</set>
        </change>
      </input>
      <input type="checkbox" token="global_dns" depends="$showCollapseLink_dns$">
        <label></label>
        <choice value="true">Enable global search on click</choice>
        <change>
          <condition value="true">
            <set token="global_dns">true</set>
          </condition>
          <condition>
            <unset token="global_dns"></unset>
          </condition>
        </change>
        <delimiter> </delimiter>
      </input>
      <table depends="$main_dns$;$panel_dns$;$extra_dns$;$showCollapseLink_dns$;$filter_UID2$;$done_input$">
        <search rejects="$form.killswitch$" depends="$extra_dns$;$done_input$" id="search_dns">
          <progress>
            <condition match="$form.filter_dns$ != &quot;*&quot;">
              <unset token="main_dns"></unset>
              <set token="sub_dns">true</set>
              <set token="panel_dns">true</set>
              <unset token="nothingfound"></unset>
              <set token="showCollapseLink_dns">true</set>
              <unset token="showExpandLink_dns"></unset>
              <set token="form.toklinkCollapse_dns">true</set>
              <set token="main_status">Search is running..</set>
              <set token="count_dns">Running..</set>
            </condition>
            <condition>
              <set token="main_dns">true</set>
              <unset token="sub_dns"></unset>
              <set token="panel_dns">true</set>
              <unset token="nothingfound"></unset>
              <set token="showCollapseLink_dns">true</set>
              <unset token="showExpandLink_dns"></unset>
              <set token="form.toklinkCollapse_dns">true</set>
              <set token="main_status">Search is running..</set>
              <set token="count_dns">Running..</set>
            </condition>
          </progress>
          <error>
            <condition>
              <set token="panel_dns">true</set>
            </condition>
          </error>
          <done>
            <condition match="$job.resultCount$ == 0 AND $form.filter_dns$ == &quot;*&quot;">
              <!--<unset token="panel_dns"></unset>-->
              <set token="notfound_dns">true</set>
              <unset token="showCollapseLink_dns"></unset>
              <set token="showExpandLink_dns">true</set>
              <unset token="form.toklinkCollapse_dns"></unset>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_dns">[ $job.resultCount$ ]</set>
            </condition>
            <condition>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_dns">[ $job.resultCount$ ]</set>
            </condition>
          </done>
          <query>`getDNSRAW($filter_UID2$,$filter$)` 
``` $extra_dns$ ```
          </query>
          <earliest>$time_dns.earliest$</earliest>
          <latest>$time_dns.latest$</latest>

        </search>
        <option name="drilldown">cell</option>
        <option name="refresh.display">progressbar</option>
        <option name="totalsRow">false</option>
        <fields>_time index user query action src src_translated_ip</fields>
        <drilldown>
          <condition match="(NOT $global_dns$) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">replace(replace(replace($click.value2$,"[\\t\\r\\n\\f\\u200B]",""),"(\\\\)","\\\\\1"),"\\\"","\\\"")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="data">if(match($click.value2$,"[\\t\\r\\n]"),"*"+$data$,$data$)</eval>
            <set token="form.filter_dns">$click.name2$=$data$ $form.filter_dns$</set>
            <set token="form.jumpto">panel_dns</set>
            <eval token="form.osint">replace($data$," ","")</eval>
          </condition>
          <condition match="($global_dns$ == &quot;true&quot;) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND len($click.value2$) &gt; 3 AND $click.name2$!=&quot;_time&quot;">
            <eval token="dd_s">relative_time($click.value$,"-"+$form.pivot_window$+"h")</eval>
            <eval token="dd_e">relative_time($click.value$,"+"+$form.pivot_window$+"h")</eval>
            <link target="_blank">[LINK TO YOUR SPLUNK APP]/$dashboard_id$?form.keyword=$click.value2$&amp;form.basetime.earliest=$dd_s$&amp;form.basetime.latest=$dd_e$&amp;submit=true</link>
          </condition>
          <condition>
            <!-- Do nothing -->
          </condition>
        </drilldown>
      </table>
      <table depends="$sub_dns$;$panel_dns$;$extra_dns$;$showCollapseLink_dns$;$filter_UID2$;$done_input$">
        <search rejects="$form.killswitch$" depends="$extra_dns$;$done_input$;$sub_dns$" base="search_dns">
          <progress>
            <condition>
              <set token="panel_dns">true</set>
              <unset token="nothingfound"></unset>
              <set token="showCollapseLink_dns">true</set>
              <unset token="showExpandLink_dns"></unset>
              <set token="form.toklinkCollapse_dns">true</set>
              <set token="main_status">Search is running..</set>
              <set token="count_dns">Running..</set>
            </condition>
          </progress>
          <error>
            <condition>
              <set token="panel_dns">true</set>
            </condition>
          </error>
          <done>
            <condition>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_dns">[ $job.resultCount$ ]</set>
            </condition>
          </done>
          <query>| search $form.filter_dns$ 
``` $sub_dns$ ```
          </query>
        </search>
        <option name="drilldown">cell</option>
        <option name="refresh.display">progressbar</option>
        <option name="totalsRow">false</option>
        <fields>_time index user query action src src_translated_ip</fields>
        <drilldown>
          <condition match="(NOT $global_dns$) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">replace(replace(replace($click.value2$,"[\\t\\r\\n\\f\\u200B]",""),"(\\\\)","\\\\\1"),"\\\"","\\\"")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="data">if(match($click.value2$,"[\\t\\r\\n]"),"*"+$data$,$data$)</eval>
            <set token="form.filter_dns">$click.name2$=$data$ $form.filter_dns$</set>
            <set token="form.jumpto">panel_dns</set>
            <eval token="form.osint">replace($data$," ","")</eval>
          </condition>
          <condition match="($global_dns$ == &quot;true&quot;) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND len($click.value2$) &gt; 3 AND $click.name2$!=&quot;_time&quot;">
            <eval token="dd_s">relative_time($click.value$,"-"+$form.pivot_window$+"h")</eval>
            <eval token="dd_e">relative_time($click.value$,"+"+$form.pivot_window$+"h")</eval>
            <link target="_blank">[LINK TO YOUR SPLUNK APP]/$dashboard_id$?form.keyword=$click.value2$&amp;form.basetime.earliest=$dd_s$&amp;form.basetime.latest=$dd_e$&amp;submit=true</link>
          </condition>
          <condition>
            <!-- Do nothing -->
          </condition>
        </drilldown>
      </table>
    </panel>
  </row>
  <row depends="$panel_dns$;$extra_dns$;$showCollapseLink_dns$;$filter_UID2$;$done_input$" rejects="$notfound_dns$">
    <panel>
      <html>
      <u1> </u1>
    </html>
    </panel>
  </row>
  <row>
    <panel id="panel_edr" depends="$showCollapseLink_edr$;$done_input$">
      <title>CrowdStrike</title>
      <input id="input_edr" type="text" token="filter_edr" depends="$showCollapseLink_edr$" searchWhenChanged="true">
        <label>Sub filter</label>
        <default>*</default>
        <initialValue>*</initialValue>
        <change>
          <condition match="$form.filter_edr$ != &quot;*&quot;">
            <unset token="main_edr"></unset>
            <set token="sub_edr">true</set>
          </condition>
          <condition>
            <set token="main_edr">true</set>
            <unset token="sub_edr"></unset>
          </condition>
        </change>
      </input>
      <input id="clear_edr" type="link" token="clear_edr" depends="$showCollapseLink_edr$">
        <label></label>
        <choice value="clear">Clear filter</choice>
        <change>
          <condition value="clear">
            <set token="form.filter_edr">*</set>
            <unset token="form.clear_edr"></unset>
          </condition>
          <condition>
            <unset token="form.clear_edr"></unset>
          </condition>
        </change>
      </input>
      <input type="time" token="time_edr" depends="$showCollapseLink_edr$" searchWhenChanged="true">
        <label></label>
        <default>
          <earliest>$time_edr.earliest$</earliest>
          <latest>$time_edr.latest$</latest>
        </default>
        <change>
          <set token="time_edr">$time_edr$</set>
        </change>
      </input>
      <input type="checkbox" token="global_edr" depends="$showCollapseLink_edr$">
        <label></label>
        <choice value="true">Enable global search on click</choice>
        <change>
          <condition value="true">
            <set token="global_edr">true</set>
          </condition>
          <condition>
            <unset token="global_edr"></unset>
          </condition>
        </change>
        <delimiter> </delimiter>
      </input>
      <table depends="$main_edr$;$panel_edr$;$extra_edr$;$showCollapseLink_edr$;$filter_UID2$;$done_input$">
        <search rejects="$form.killswitch$" depends="$extra_edr$;$done_input$" id="search_edr">
          <progress>
            <condition match="$form.filter_edr$ != &quot;*&quot;">
              <unset token="main_edr"></unset>
              <set token="sub_edr">true</set>
              <set token="panel_edr">true</set>
              <unset token="nothingfound"></unset>
              <set token="showCollapseLink_edr">true</set>
              <unset token="showExpandLink_edr"></unset>
              <set token="form.toklinkCollapse_edr">true</set>
              <set token="main_status">Search is running..</set>
              <set token="count_edr">Running..</set>
            </condition>
            <condition>
              <set token="main_edr">true</set>
              <unset token="sub_edr"></unset>
              <set token="panel_edr">true</set>
              <unset token="nothingfound"></unset>
              <set token="showCollapseLink_edr">true</set>
              <unset token="showExpandLink_edr"></unset>
              <set token="form.toklinkCollapse_edr">true</set>
              <set token="main_status">Search is running..</set>
              <set token="count_edr">Running..</set>
            </condition>
          </progress>
          <error>
            <condition>
              <set token="panel_edr">true</set>
            </condition>
          </error>
          <done>
            <condition match="$job.resultCount$ == 0 AND $form.filter_edr$ == &quot;*&quot;">
              <!--<unset token="panel_edr"></unset>-->
              <set token="notfound_edr">true</set>
              <unset token="showCollapseLink_edr"></unset>
              <set token="showExpandLink_edr">true</set>
              <unset token="form.toklinkCollapse_edr"></unset>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_edr">[ $job.resultCount$ ]</set>
            </condition>
            <condition>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_edr">[ $job.resultCount$ ]</set>
            </condition>
          </done>
          <query>`getEDRRAW($filter_UID2$,$edr_filter|s$)` 
``` $extra_edr$ ```
          </query>
          <earliest>$time_edr.earliest$</earliest>
          <latest>$time_edr.latest$</latest>

        </search>
        <option name="drilldown">cell</option>
        <option name="refresh.display">progressbar</option>
        <option name="totalsRow">false</option>
        <fields>_time action Entity event.UserName Detection description url</fields>
        <drilldown>
          <condition match="$click.name2$ == &quot;url&quot;">
            <link target="_blank">$click.value2|n$</link>
          </condition>
          <condition match="(NOT $global_edr$) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">replace(replace(replace($click.value2$,"[\\t\\r\\n\\f\\u200B]",""),"(\\\\)","\\\\\1"),"\\\"","\\\"")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="data">if(match($click.value2$,"[\\t\\r\\n]"),"*"+$data$,$data$)</eval>
            <set token="form.filter_edr">$click.name2$=$data$ $form.filter_edr$</set>
            <set token="form.jumpto">panel_edr</set>
            <eval token="form.osint">replace($data$," ","")</eval>
          </condition>
          <condition match="($global_edr$ == &quot;true&quot;) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND len($click.value2$) &gt; 3 AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">replace($click.value2$,"[\\t\\r\\n\\f\\u200B]","")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="dd_s">relative_time($click.value$,"-"+$form.pivot_window$+"h")</eval>
            <eval token="dd_e">relative_time($click.value$,"+"+$form.pivot_window$+"h")</eval>
            <link target="_blank">[LINK TO YOUR SPLUNK APP]/$dashboard_id$?form.keyword=$data$&amp;form.basetime.earliest=$dd_s$&amp;form.basetime.latest=$dd_e$&amp;form.pivot_window=$form.pivot_window$</link>
          </condition>
          <condition>
            <!-- Do nothing -->
          </condition>
        </drilldown>
      </table>
      <table depends="$sub_edr$;$panel_edr$;$extra_edr$;$showCollapseLink_edr$;$filter_UID2$;$done_input$">
        <search rejects="$form.killswitch$" depends="$extra_edr$;$done_input$;$sub_edr$" base="search_edr">
          <progress>
            <condition>
              <set token="panel_edr">true</set>
              <unset token="nothingfound"></unset>
              <set token="showCollapseLink_edr">true</set>
              <unset token="showExpandLink_edr"></unset>
              <set token="form.toklinkCollapse_edr">true</set>
              <set token="main_status">Search is running..</set>
              <set token="count_edr">Running..</set>
            </condition>
          </progress>
          <error>
            <condition>
              <set token="panel_edr">true</set>
            </condition>
          </error>
          <done>
            <condition>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_edr">[ $job.resultCount$ ]</set>
            </condition>
          </done>
          <query>| search $form.filter_edr$ 
``` $sub_edr$ ```
          </query>
        </search>
        <option name="drilldown">cell</option>
        <option name="refresh.display">progressbar</option>
        <option name="totalsRow">false</option>
        <fields>_time action Entity event.UserName Detection description url</fields>
        <drilldown>
          <condition match="$click.name2$ == &quot;url&quot;">
            <link target="_blank">$click.value2|n$</link>
          </condition>
          <condition match="(NOT $global_edr$) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">replace(replace(replace($click.value2$,"[\\t\\r\\n\\f\\u200B]",""),"(\\\\)","\\\\\1"),"\\\"","\\\"")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="data">if(match($click.value2$,"[\\t\\r\\n]"),"*"+$data$,$data$)</eval>
            <set token="form.filter_edr">$click.name2$=$data$ $form.filter_edr$</set>
            <set token="form.jumpto">panel_edr</set>
            <eval token="form.osint">replace($data$," ","")</eval>
          </condition>
          <condition match="($global_edr$ == &quot;true&quot;) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND len($click.value2$) &gt; 3 AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">replace($click.value2$,"[\\t\\r\\n\\f\\u200B]","")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="dd_s">relative_time($click.value$,"-"+$form.pivot_window$+"h")</eval>
            <eval token="dd_e">relative_time($click.value$,"+"+$form.pivot_window$+"h")</eval>
            <link target="_blank">[LINK TO YOUR SPLUNK APP]/$dashboard_id$?form.keyword=$data$&amp;form.basetime.earliest=$dd_s$&amp;form.basetime.latest=$dd_e$&amp;form.pivot_window=$form.pivot_window$</link>
          </condition>
          <condition>
            <!-- Do nothing -->
          </condition>
        </drilldown>
      </table>
    </panel>
  </row>
  <row depends="$panel_edr$;$extra_edr$;$showCollapseLink_edr$;$filter_UID2$;$done_input$" rejects="$notfound_edr$">
    <panel>
      <html>
      <u1> </u1>
    </html>
    </panel>
  </row>
  <row>
    <panel id="panel_winevent" depends="$showCollapseLink_winevent$;$done_input$">
      <title>WinEvents</title>
      <input id="input_winevent" type="text" token="filter_winevent" depends="$showCollapseLink_winevent$" searchWhenChanged="true">
        <label>Sub filter</label>
        <default>*</default>
        <initialValue>*</initialValue>
        <change>
          <condition match="$form.filter_winevent$ != &quot;*&quot;">
            <unset token="main_winevent"></unset>
            <set token="sub_winevent">true</set>
          </condition>
          <condition>
            <set token="main_winevent">true</set>
            <unset token="sub_winevent"></unset>
          </condition>
        </change>
      </input>
      <input id="clear_winevent" type="link" token="clear_winevent" depends="$showCollapseLink_winevent$">
        <label></label>
        <choice value="clear">Clear filter</choice>
        <change>
          <condition value="clear">
            <set token="form.filter_winevent">*</set>
            <unset token="form.clear_winevent"></unset>
          </condition>
          <condition>
            <unset token="form.clear_winevent"></unset>
          </condition>
        </change>
      </input>
      <input type="time" token="time_winevent" depends="$showCollapseLink_winevent$" searchWhenChanged="true">
        <label></label>
        <default>
          <earliest>$time_winevent.earliest$</earliest>
          <latest>$time_winevent.latest$</latest>
        </default>
        <change>
          <set token="time_winevent">$time_winevent$</set>
        </change>
      </input>
      <input type="checkbox" token="global_winevent" depends="$showCollapseLink_winevent$">
        <label></label>
        <choice value="true">Enable global search on click</choice>
        <change>
          <condition value="true">
            <set token="global_winevent">true</set>
          </condition>
          <condition>
            <unset token="global_winevent"></unset>
          </condition>
        </change>
        <delimiter> </delimiter>
      </input>
      <table depends="$main_winevent$;$panel_winevent$;$extra_winevent$;$showCollapseLink_winevent$;$filter_UID2$;$done_input$">
        <search rejects="$form.killswitch$" depends="$extra_winevent$;$done_input$" id="search_winevent">
          <progress>
            <condition match="$form.filter_winevent$ != &quot;*&quot;">
              <unset token="main_winevent"></unset>
              <set token="sub_winevent">true</set>
              <set token="panel_winevent">true</set>
              <unset token="nothingfound"></unset>
              <set token="showCollapseLink_winevent">true</set>
              <unset token="showExpandLink_winevent"></unset>
              <set token="form.toklinkCollapse_winevent">true</set>
              <set token="main_status">Search is running..</set>
              <set token="count_winevent">Running..</set>
            </condition>
            <condition>
              <set token="main_winevent">true</set>
              <unset token="sub_winevent"></unset>
              <set token="panel_winevent">true</set>
              <unset token="nothingfound"></unset>
              <set token="showCollapseLink_winevent">true</set>
              <unset token="showExpandLink_winevent"></unset>
              <set token="form.toklinkCollapse_winevent">true</set>
              <set token="main_status">Search is running..</set>
              <set token="count_winevent">Running..</set>
            </condition>
          </progress>
          <error>
            <condition>
              <set token="panel_winevent">true</set>
            </condition>
          </error>
          <done>
            <condition match="$job.resultCount$ == 0 AND $form.filter_winevent$ == &quot;*&quot;">
              <!--<unset token="panel_winevent"></unset>-->
              <set token="notfound_winevent">true</set>
              <unset token="showCollapseLink_winevent"></unset>
              <set token="showExpandLink_winevent">true</set>
              <unset token="form.toklinkCollapse_winevent"></unset>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_winevent">[ $job.resultCount$ ]</set>
            </condition>
            <condition>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_winevent">[ $job.resultCount$ ]</set>
            </condition>
          </done>
          <query>`getWinEventRAW($filter_UID2$, $filter$)` 
``` $extra_winevent$ ```
          </query>
          <earliest>$time_winevent.earliest$</earliest>
          <latest>$time_winevent.latest$</latest>

        </search>
        <option name="count">5</option>
        <option name="drilldown">cell</option>
        <option name="totalsRow">false</option>
        <fields>_time user xTraffic EventCode_Task_Service xMSG1 xMSG2</fields>
        <drilldown>
          <condition match="(NOT $global_winevent$) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND ($click.name2$ == &quot;xMSG1&quot; OR $click.name2$ == &quot;xMSG2&quot;)">
            <eval token="data">trim(replace(tostring(mvindex(split(replace($click.value2$,":\\t(\\t)?","######"),"######"),1)),"\\\\","\\\\\1"))</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="data">if(match($click.value2$,"[\\t\\r\\n]"),"*"+$data$,$data$)</eval>
            <set token="form.filter_winevent">$click.name2$=$data$ $form.filter_winevent$</set>
            <set token="form.jumpto">panel_winevent</set>
            <eval token="form.osint">replace($data$," ","")</eval>
          </condition>
          <condition match="(NOT $global_winevent$) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">if(match($click.value2$,"[^a-zA-Z0-9 @{}._:-]"),"\""+replace(replace($click.value2$,"[\\t\\r\\n\\f\\u200B]",""),"(\\\\)","\\\\\1")+"\"",replace(replace($click.value2$,"[\\t\\r\\n\\f\\u200B]",""),"(\\\\)","\\\\\1"))</eval>
            <!--<eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>-->
            <eval token="data">if(match($click.value2$,"[\\t\\r\\n]"),"*"+$data$,$data$)</eval>
            <set token="form.filter_winevent">$click.name2$=$data$ $form.filter_winevent$</set>
            <set token="form.jumpto">panel_winevent</set>
            <eval token="form.osint">replace($data$," ","")</eval>
          </condition>
          <condition match="($global_winevent$ == &quot;true&quot;) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND len($click.value2$) &gt; 3 AND $click.name2$!=&quot;_time&quot; AND ($click.name2$ == &quot;xMSG1&quot; OR $click.name2$ == &quot;xMSG2&quot;)">
            <eval token="data">trim(replace(tostring(mvindex(split(replace($click.value2$,":\\t(\\t)?","######"),"######"),1)),"[\\t\\r\\n]",""))</eval>
            <eval token="dd_s">relative_time($click.value$,"-"+$form.pivot_window$+"h")</eval>
            <eval token="dd_e">relative_time($click.value$,"+"+$form.pivot_window$+"h")</eval>
            <link target="_blank">[LINK TO YOUR SPLUNK APP]/$dashboard_id$?form.keyword=$data$&amp;form.basetime.earliest=$dd_s$&amp;form.basetime.latest=$dd_e$&amp;form.pivot_window=$form.pivot_window$</link>
          </condition>
          <condition match="($global_winevent$ == &quot;true&quot;) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND len($click.value2$) &gt; 3 AND $click.name2$!=&quot;_time&quot;">
            <eval token="dd_s">relative_time($click.value$,"-"+$form.pivot_window$+"h")</eval>
            <eval token="dd_e">relative_time($click.value$,"+"+$form.pivot_window$+"h")</eval>
            <link target="_blank">[LINK TO YOUR SPLUNK APP]/$dashboard_id$?form.keyword=$click.value2$&amp;form.basetime.earliest=$dd_s$&amp;form.basetime.latest=$dd_e$&amp;submit=true</link>
          </condition>
          <condition>
            <!-- Do nothing -->
          </condition>
        </drilldown>
      </table>
      <table depends="$sub_winevent$;$panel_winevent$;$extra_winevent$;$showCollapseLink_winevent$;$filter_UID2$;$done_input$">
        <search rejects="$form.killswitch$" depends="$extra_winevent$;$done_input$;$sub_winevent$" base="search_winevent">
          <progress>
            <condition>
              <set token="panel_winevent">true</set>
              <unset token="nothingfound"></unset>
              <set token="showCollapseLink_winevent">true</set>
              <unset token="showExpandLink_winevent"></unset>
              <set token="form.toklinkCollapse_winevent">true</set>
              <set token="main_status">Search is running..</set>
              <set token="count_winevent">Running..</set>
            </condition>
          </progress>
          <error>
            <condition>
              <set token="panel_winevent">true</set>
            </condition>
          </error>
          <done>
            <condition>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_winevent">[ $job.resultCount$ ]</set>
            </condition>
          </done>
          <query>| search $form.filter_winevent$  
``` $sub_winevent$ ```
          </query>
        </search>
        <option name="count">5</option>
        <option name="drilldown">cell</option>
        <option name="totalsRow">false</option>
        <fields>_time user xTraffic EventCode_Task_Service xMSG1 xMSG2</fields>
        <drilldown>
          <condition match="(NOT $global_winevent$) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND ($click.name2$ == &quot;xMSG1&quot; OR $click.name2$ == &quot;xMSG2&quot;)">
            <eval token="data">trim(replace(tostring(mvindex(split(replace($click.value2$,":\\t(\\t)?","######"),"######"),1)),"\\\\","\\\\\1"))</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="data">if(match($click.value2$,"[\\t\\r\\n]"),"*"+$data$,$data$)</eval>
            <set token="form.filter_winevent">$click.name2$=$data$ $form.filter_winevent$</set>
            <set token="form.jumpto">panel_winevent</set>
            <eval token="form.osint">replace($data$," ","")</eval>
          </condition>
          <condition match="(NOT $global_winevent$) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">if(match($click.value2$,"[^a-zA-Z0-9 @{}._:-]"),"\""+replace(replace($click.value2$,"[\\t\\r\\n\\f\\u200B]",""),"(\\\\)","\\\\\1")+"\"",replace(replace($click.value2$,"[\\t\\r\\n\\f\\u200B]",""),"(\\\\)","\\\\\1"))</eval>
            <!--<eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>-->
            <eval token="data">if(match($click.value2$,"[\\t\\r\\n]"),"*"+$data$,$data$)</eval>
            <set token="form.filter_winevent">$click.name2$=$data$ $form.filter_winevent$</set>
            <set token="form.jumpto">panel_winevent</set>
            <eval token="form.osint">replace($data$," ","")</eval>
          </condition>
          <condition match="($global_winevent$ == &quot;true&quot;) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND len($click.value2$) &gt; 3 AND $click.name2$!=&quot;_time&quot; AND ($click.name2$ == &quot;xMSG1&quot; OR $click.name2$ == &quot;xMSG2&quot;)">
            <eval token="data">trim(replace(tostring(mvindex(split(replace($click.value2$,":\\t(\\t)?","######"),"######"),1)),"[\\t\\r\\n]",""))</eval>
            <eval token="dd_s">relative_time($click.value$,"-"+$form.pivot_window$+"h")</eval>
            <eval token="dd_e">relative_time($click.value$,"+"+$form.pivot_window$+"h")</eval>
            <link target="_blank">[LINK TO YOUR SPLUNK APP]/$dashboard_id$?form.keyword=$data$&amp;form.basetime.earliest=$dd_s$&amp;form.basetime.latest=$dd_e$&amp;form.pivot_window=$form.pivot_window$</link>
          </condition>
          <condition match="($global_winevent$ == &quot;true&quot;) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND len($click.value2$) &gt; 3 AND $click.name2$!=&quot;_time&quot;">
            <eval token="dd_s">relative_time($click.value$,"-"+$form.pivot_window$+"h")</eval>
            <eval token="dd_e">relative_time($click.value$,"+"+$form.pivot_window$+"h")</eval>
            <link target="_blank">[LINK TO YOUR SPLUNK APP]/$dashboard_id$?form.keyword=$click.value2$&amp;form.basetime.earliest=$dd_s$&amp;form.basetime.latest=$dd_e$&amp;submit=true</link>
          </condition>
          <condition>
            <!-- Do nothing -->
          </condition>
        </drilldown>
      </table>
    </panel>
  </row>
  <row depends="$panel_winevent$;$extra_winevent$;$showCollapseLink_winevent$;$filter_UID2$;$done_input$" rejects="$notfound_winevent$">
    <panel>
      <html>
      <u1> </u1>
    </html>
    </panel>
  </row>
  <row>
    <panel id="panel_workday" depends="$showCollapseLink_workday$;$done_input$">
      <title>WorkDay</title>
      <input id="input_workday" type="text" token="filter_workday" depends="$showCollapseLink_workday$" searchWhenChanged="true">
        <label>Sub filter</label>
        <default>*</default>
        <initialValue>*</initialValue>
        <change>
          <condition match="$form.filter_workday$ != &quot;*&quot;">
            <unset token="main_workday"></unset>
            <set token="sub_workday">true</set>
          </condition>
          <condition>
            <set token="main_workday">true</set>
            <unset token="sub_workday"></unset>
          </condition>
        </change>
      </input>
      <input id="clear_workday" type="link" token="clear_workday" depends="$showCollapseLink_workday$">
        <label></label>
        <choice value="clear">Clear filter</choice>
        <change>
          <condition value="clear">
            <set token="form.filter_workday">*</set>
            <unset token="form.clear_workday"></unset>
          </condition>
          <condition>
            <unset token="form.clear_workday"></unset>
          </condition>
        </change>
      </input>
      <input type="time" token="time_workday" depends="$showCollapseLink_workday$" searchWhenChanged="true">
        <label></label>
        <default>
          <earliest>$time_workday.earliest$</earliest>
          <latest>$time_workday.latest$</latest>
        </default>
        <change>
          <set token="time_workday">$time_workday$</set>
        </change>
      </input>
      <input type="checkbox" token="global_workday" depends="$showCollapseLink_workday$">
        <label></label>
        <choice value="true">Enable global search on click</choice>
        <change>
          <condition value="true">
            <set token="global_workday">true</set>
          </condition>
          <condition>
            <unset token="global_workday"></unset>
          </condition>
        </change>
        <delimiter> </delimiter>
      </input>
      <table depends="$main_workday$;$panel_workday$;$extra_workday$;$showCollapseLink_workday$;$filter_UID2$;$done_input$">
        <search rejects="$form.killswitch$" depends="$extra_workday$;$done_input$" id="search_workday">
          <progress>
            <condition match="$form.filter_workday$ != &quot;*&quot;">
              <unset token="main_workday"></unset>
              <set token="sub_workday">true</set>
              <set token="panel_workday">true</set>
              <unset token="nothingfound"></unset>
              <set token="showCollapseLink_workday">true</set>
              <unset token="showExpandLink_workday"></unset>
              <set token="form.toklinkCollapse_workday">true</set>
              <set token="main_status">Search is running..</set>
              <set token="count_workday">Running..</set>
            </condition>
            <condition>
              <set token="main_workday">true</set>
              <unset token="sub_workday"></unset>
              <set token="panel_workday">true</set>
              <unset token="nothingfound"></unset>
              <set token="showCollapseLink_workday">true</set>
              <unset token="showExpandLink_workday"></unset>
              <set token="form.toklinkCollapse_workday">true</set>
              <set token="main_status">Search is running..</set>
              <set token="count_workday">Running..</set>
            </condition>
          </progress>
          <error>
            <condition>
              <set token="panel_workday">true</set>
            </condition>
          </error>
          <done>
            <condition match="$job.resultCount$ == 0 AND $form.filter_workday$ == &quot;*&quot;">
              <!--<unset token="panel_workday"></unset>-->
              <set token="notfound_workday">true</set>
              <unset token="showCollapseLink_workday"></unset>
              <set token="showExpandLink_workday">true</set>
              <unset token="form.toklinkCollapse_workday"></unset>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_workday">[ $job.resultCount$ ]</set>
            </condition>
            <condition>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_workday">[ $job.resultCount$ ]</set>
            </condition>
          </done>
          <query>`getWorkdayRAW($filter$ $filter_UID2$)`
``` $extra_workday$ ```
          </query>
          <earliest>$time_workday.earliest$</earliest>
          <latest>$time_workday.latest$</latest>

        </search>
        <option name="drilldown">cell</option>
        <option name="refresh.display">progressbar</option>
        <fields>_time user src taskDisplayName target.descriptor userAgent</fields>
        <drilldown>
          <condition match="(NOT $global_workday$) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">replace(replace(replace($click.value2$,"[\\t\\r\\n\\f\\u200B]",""),"(\\\\)","\\\\\1"),"\\\"","\\\"")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="data">if(match($click.value2$,"[\\t\\r\\n]"),"*"+$data$,$data$)</eval>
            <set token="form.filter_workday">$click.name2$=$data$ $form.filter_workday$</set>
            <set token="form.jumpto">panel_workday</set>
            <eval token="form.osint">replace($data$," ","")</eval>
          </condition>
          <condition match="($global_workday$ == &quot;true&quot;) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND len($click.value2$) &gt; 3 AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">replace($click.value2$,"[\\t\\r\\n\\f\\u200B]","")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="dd_s">relative_time($click.value$,"-"+$form.pivot_window$+"h")</eval>
            <eval token="dd_e">relative_time($click.value$,"+"+$form.pivot_window$+"h")</eval>
            <link target="_blank">[LINK TO YOUR SPLUNK APP]/$dashboard_id$?form.keyword=$data$&amp;form.basetime.earliest=$dd_s$&amp;form.basetime.latest=$dd_e$&amp;form.pivot_window=$form.pivot_window$</link>
          </condition>
          <condition>
            <!-- Do nothing -->
          </condition>
        </drilldown>
      </table>
      <table depends="$sub_workday$;$panel_workday$;$extra_workday$;$showCollapseLink_workday$;$filter_UID2$;$done_input$">
        <search rejects="$form.killswitch$" depends="$extra_workday$;$done_input$;$sub_workday$" base="search_workday">
          <progress>
            <condition>
              <set token="panel_workday">true</set>
              <unset token="nothingfound"></unset>
              <set token="showCollapseLink_workday">true</set>
              <unset token="showExpandLink_workday"></unset>
              <set token="form.toklinkCollapse_workday">true</set>
              <set token="main_status">Search is running..</set>
              <set token="count_workday">Running..</set>
            </condition>
          </progress>
          <error>
            <condition>
              <set token="panel_workday">true</set>
            </condition>
          </error>
          <done>
            <condition>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_workday">[ $job.resultCount$ ]</set>
            </condition>
          </done>
          <query>| search $form.filter_workday$
``` $sub_workday$ ```          
          </query>
        </search>
        <option name="drilldown">cell</option>
        <option name="refresh.display">progressbar</option>
        <fields>_time user src taskDisplayName target.descriptor userAgent</fields>
        <drilldown>
          <condition match="(NOT $global_workday$) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">replace(replace(replace($click.value2$,"[\\t\\r\\n\\f\\u200B]",""),"(\\\\)","\\\\\1"),"\\\"","\\\"")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="data">if(match($click.value2$,"[\\t\\r\\n]"),"*"+$data$,$data$)</eval>
            <set token="form.filter_workday">$click.name2$=$data$ $form.filter_workday$</set>
            <set token="form.jumpto">panel_workday</set>
            <eval token="form.osint">replace($data$," ","")</eval>
          </condition>
          <condition match="($global_workday$ == &quot;true&quot;) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND len($click.value2$) &gt; 3 AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">replace($click.value2$,"[\\t\\r\\n\\f\\u200B]","")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="dd_s">relative_time($click.value$,"-"+$form.pivot_window$+"h")</eval>
            <eval token="dd_e">relative_time($click.value$,"+"+$form.pivot_window$+"h")</eval>
            <link target="_blank">[LINK TO YOUR SPLUNK APP]/$dashboard_id$?form.keyword=$data$&amp;form.basetime.earliest=$dd_s$&amp;form.basetime.latest=$dd_e$&amp;form.pivot_window=$form.pivot_window$</link>
          </condition>
          <condition>
            <!-- Do nothing -->
          </condition>
        </drilldown>
      </table>
    </panel>
    <panel id="panel_bluecat" depends="$showCollapseLink_bluecat$;$done_input$">
      <title>Bluecat</title>
      <input id="input_bluecat" type="text" token="filter_bluecat" depends="$showCollapseLink_bluecat$" searchWhenChanged="true">
        <label>Sub filter</label>
        <default>*</default>
        <initialValue>*</initialValue>
        <change>
          <condition match="$form.filter_bluecat$ != &quot;*&quot;">
            <unset token="main_bluecat"></unset>
            <set token="sub_bluecat">true</set>
          </condition>
          <condition>
            <set token="main_bluecat">true</set>
            <unset token="sub_bluecat"></unset>
          </condition>
        </change>
      </input>
      <input id="clear_bluecat" type="link" token="clear_bluecat" depends="$showCollapseLink_bluecat$">
        <label></label>
        <choice value="clear">Clear filter</choice>
        <change>
          <condition value="clear">
            <set token="form.filter_bluecat">*</set>
            <unset token="form.clear_bluecat"></unset>
          </condition>
          <condition>
            <unset token="form.clear_bluecat"></unset>
          </condition>
        </change>
      </input>
      <input type="time" token="time_bluecat" depends="$showCollapseLink_bluecat$" searchWhenChanged="true">
        <label></label>
        <default>
          <earliest>$time_bluecat.earliest$</earliest>
          <latest>$time_bluecat.latest$</latest>
        </default>
        <change>
          <set token="time_bluecat">$time_bluecat$</set>
        </change>
      </input>
      <input type="checkbox" token="global_bluecat" depends="$showCollapseLink_bluecat$">
        <label></label>
        <choice value="true">Enable global search on click</choice>
        <change>
          <condition value="true">
            <set token="global_bluecat">true</set>
          </condition>
          <condition>
            <unset token="global_bluecat"></unset>
          </condition>
        </change>
        <delimiter> </delimiter>
      </input>
      <table depends="$main_bluecat$;$panel_bluecat$;$extra_bluecat$;$showCollapseLink_bluecat$;$filter_UID2$;$done_input$">
        <search rejects="$form.killswitch$" depends="$extra_bluecat$;$done_input$" id="search_bluecat">
          <progress>
            <condition match="$form.filter_bluecat$ != &quot;*&quot;">
              <unset token="main_bluecat"></unset>
              <set token="sub_bluecat">true</set>
              <set token="panel_bluecat">true</set>
              <unset token="nothingfound"></unset>
              <set token="showCollapseLink_bluecat">true</set>
              <unset token="showExpandLink_bluecat"></unset>
              <set token="form.toklinkCollapse_bluecat">true</set>
              <set token="main_status">Search is running..</set>
              <set token="count_bluecat">Running..</set>
            </condition>
            <condition>
              <set token="main_bluecat">true</set>
              <unset token="sub_bluecat"></unset>
              <set token="panel_bluecat">true</set>
              <unset token="nothingfound"></unset>
              <set token="showCollapseLink_bluecat">true</set>
              <unset token="showExpandLink_bluecat"></unset>
              <set token="form.toklinkCollapse_bluecat">true</set>
              <set token="main_status">Search is running..</set>
              <set token="count_bluecat">Running..</set>
            </condition>
          </progress>
          <error>
            <condition>
              <set token="panel_bluecat">true</set>
            </condition>
          </error>
          <done>
            <condition match="$job.resultCount$ == 0 AND $form.filter_bluecat$ == &quot;*&quot;">
              <!--<unset token="panel_bluecat"></unset>-->
              <set token="notfound_bluecat">true</set>
              <unset token="showCollapseLink_bluecat"></unset>
              <set token="showExpandLink_bluecat">true</set>
              <unset token="form.toklinkCollapse_bluecat"></unset>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_bluecat">[ $job.resultCount$ ]</set>
            </condition>
            <condition>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_bluecat">[ $job.resultCount$ ]</set>
            </condition>
          </done>
          <query>`getBluecatRAW($filter$ $filter_UID2$)`
``` $extra_bluecat$ ```
          </query>
          <earliest>$time_bluecat.earliest$</earliest>
          <latest>$time_bluecat.latest$</latest>

        </search>
        <option name="drilldown">cell</option>
        <option name="refresh.display">progressbar</option>
        <fields>_time signature dest_ip dest_nt_host dest_mac interface_ip message index</fields>
        <drilldown>
          <condition match="(NOT $global_bluecat$) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">replace(replace(replace($click.value2$,"[\\t\\r\\n\\f\\u200B]",""),"(\\\\)","\\\\\1"),"\\\"","\\\"")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="data">if(match($click.value2$,"[\\t\\r\\n]"),"*"+$data$,$data$)</eval>
            <set token="form.filter_bluecat">$click.name2$=$data$ $form.filter_bluecat$</set>
            <set token="form.jumpto">panel_bluecat</set>
            <eval token="form.osint">replace($data$," ","")</eval>
          </condition>
          <condition match="($global_bluecat$ == &quot;true&quot;) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND len($click.value2$) &gt; 3 AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">replace($click.value2$,"[\\t\\r\\n\\f\\u200B]","")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="dd_s">relative_time($click.value$,"-"+$form.pivot_window$+"h")</eval>
            <eval token="dd_e">relative_time($click.value$,"+"+$form.pivot_window$+"h")</eval>
            <link target="_blank">[LINK TO YOUR SPLUNK APP]/$dashboard_id$?form.keyword=$data$&amp;form.basetime.earliest=$dd_s$&amp;form.basetime.latest=$dd_e$&amp;form.pivot_window=$form.pivot_window$</link>
          </condition>
          <condition>
            <!-- Do nothing -->
          </condition>
        </drilldown>
      </table>
      <table depends="$sub_bluecat$;$panel_bluecat$;$extra_bluecat$;$showCollapseLink_bluecat$;$filter_UID2$;$done_input$">
        <search rejects="$form.killswitch$" depends="$extra_bluecat$;$done_input$;$sub_bluecat$" base="search_bluecat">
          <progress>
            <condition>
              <set token="panel_bluecat">true</set>
              <unset token="nothingfound"></unset>
              <set token="showCollapseLink_bluecat">true</set>
              <unset token="showExpandLink_bluecat"></unset>
              <set token="form.toklinkCollapse_bluecat">true</set>
              <set token="main_status">Search is running..</set>
              <set token="count_bluecat">Running..</set>
            </condition>
          </progress>
          <error>
            <condition>
              <set token="panel_bluecat">true</set>
            </condition>
          </error>
          <done>
            <condition>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_bluecat">[ $job.resultCount$ ]</set>
            </condition>
          </done>
          <query>| search $form.filter_bluecat$
``` $sub_bluecat$ ```          
          </query>
        </search>
        <option name="drilldown">cell</option>
        <option name="refresh.display">progressbar</option>
        <fields>_time signature dest_ip dest_nt_host dest_mac interface_ip message index</fields>
        <drilldown>
          <condition match="(NOT $global_bluecat$) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">replace(replace(replace($click.value2$,"[\\t\\r\\n\\f\\u200B]",""),"(\\\\)","\\\\\1"),"\\\"","\\\"")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="data">if(match($click.value2$,"[\\t\\r\\n]"),"*"+$data$,$data$)</eval>
            <set token="form.filter_bluecat">$click.name2$=$data$ $form.filter_bluecat$</set>
            <set token="form.jumpto">panel_bluecat</set>
            <eval token="form.osint">replace($data$," ","")</eval>
          </condition>
          <condition match="($global_bluecat$ == &quot;true&quot;) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND len($click.value2$) &gt; 3 AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">replace($click.value2$,"[\\t\\r\\n\\f\\u200B]","")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="dd_s">relative_time($click.value$,"-"+$form.pivot_window$+"h")</eval>
            <eval token="dd_e">relative_time($click.value$,"+"+$form.pivot_window$+"h")</eval>
            <link target="_blank">[LINK TO YOUR SPLUNK APP]/$dashboard_id$?form.keyword=$data$&amp;form.basetime.earliest=$dd_s$&amp;form.basetime.latest=$dd_e$&amp;form.pivot_window=$form.pivot_window$</link>
          </condition>
          <condition>
            <!-- Do nothing -->
          </condition>
        </drilldown>
      </table>
    </panel>
  </row>
  <row depends="$extra_workday$;$filter_UID2$;$done_input$;$panel_workday$" rejects="$extra_bluecat$">
    <panel>
      <html>
      <u1> </u1>
    </html>
    </panel>
  </row>
  <row depends="$extra_bluecat$;$filter_UID2$;$done_input$;$panel_bluecat$;" rejects="$notfound_bluecat$">
    <panel>
      <html>
      <u1> </u1>
    </html>
    </panel>
  </row>
  <row>
    <panel id="panel_snow" depends="$showCollapseLink_snow$;$done_input$">
      <title>SNOW</title>
      <input id="input_snow" type="text" token="filter_snow" depends="$showCollapseLink_snow$" searchWhenChanged="true">
        <label></label>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input id="clear_snow" type="link" token="clear_snow" depends="$showCollapseLink_snow$">
        <label></label>
        <choice value="clear">Clear filter</choice>
        <change>
          <condition value="clear">
            <set token="form.filter_snow">*</set>
            <unset token="form.clear_snow"></unset>
          </condition>
          <condition>
            <unset token="form.clear_snow"></unset>
          </condition>
        </change>
      </input>
      <input type="time" token="time_snow" depends="$showCollapseLink_snow$" searchWhenChanged="true">
        <label></label>
        <default>
          <earliest>$time_snow.earliest$</earliest>
          <latest>$time_snow.latest$</latest>
        </default>
        <change>
          <set token="time_snow">$time_snow$</set>
        </change>
      </input>
      <table depends="$showCollapseLink_snow$;$extra_snow$;$done_input$">
        <search>
          <progress>
            <condition>
              <set token="panel_snow">true</set>
              <unset token="nothingfound"></unset>
              <set token="showCollapseLink_snow">true</set>
              <unset token="showExpandLink_snow"></unset>
              <set token="form.toklinkCollapse_snow">true</set>
              <set token="main_status">Search is running..</set>
              <set token="count_snow">Running..</set>
            </condition>
          </progress>
          <done>
            <condition match="$job.resultCount$ == 0 AND $form.filter_snow$ == &quot;*&quot;">
              <set token="notfound_snow">true</set>
              <unset token="showCollapseLink_snow"></unset>
              <set token="showExpandLink_snow">true</set>
              <unset token="form.toklinkCollapse_snow"></unset>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_snow">[ $job.resultCount$ ]</set>
            </condition>
            <condition>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_snow">[ $job.resultCount$ ]</set>
            </condition>
          </done>
          <query>`getSNOWALL($filter$ ($filter_UID2$ OR "\"$realname$\"") $form.filter_snow|s$)`
``` $extra_snow$ ```
          </query>
          <earliest>$time_snow.earliest$</earliest>
          <latest>$time_snow.latest$</latest>

        </search>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
      </table>
    </panel>
    <panel id="panel_deepwatch" depends="$showCollapseLink_deepwatch$;$done_input$">
      <title>DeepWatch</title>
      <input id="input_deepwatch" type="text" token="filter_deepwatch" depends="$showCollapseLink_deepwatch$" searchWhenChanged="true">
        <label></label>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input id="clear_deepwatch" type="link" token="clear_deepwatch" depends="$showCollapseLink_deepwatch$">
        <label></label>
        <choice value="clear">Clear filter</choice>
        <change>
          <condition value="clear">
            <set token="form.filter_deepwatch">*</set>
            <unset token="form.clear_deepwatch"></unset>
          </condition>
          <condition>
            <unset token="form.clear_deepwatch"></unset>
          </condition>
        </change>
      </input>
      <input type="time" token="time_deepwatch" depends="$showCollapseLink_deepwatch$" searchWhenChanged="true">
        <label></label>
        <default>
          <earliest>$time_deepwatch.earliest$</earliest>
          <latest>$time_deepwatch.latest$</latest>
        </default>
        <change>
          <set token="time_deepwatch">$time_deepwatch$</set>
        </change>
      </input>
      <table depends="$showCollapseLink_deepwatch$;$extra_deepwatch$;$done_input$" rejects="$notfound_deepwatchT$">
        <search>
          <progress>
            <condition>
              <unset token="notfound_deepwatchT"></unset>
              <set token="panel_deepwatch">true</set>
              <unset token="nothingfound"></unset>
              <set token="showCollapseLink_deepwatch">true</set>
              <unset token="showExpandLink_deepwatch"></unset>
              <set token="form.toklinkCollapse_deepwatch">true</set>
              <set token="main_status">Search is running..</set>
              <eval token="count_deepwatch">if($count_deepwatch$=="Search","Running..",$count_deepwatch$)</eval>
            </condition>
          </progress>
          <done>
            <condition match="$job.resultCount$ == 0 AND $form.filter_deepwatch$ == &quot;*&quot; AND NOT match($count_deepwatch$,&quot;[1-9]&quot;)">
              <set token="notfound_deepwatchT">true</set>
              <unset token="showCollapseLink_deepwatch"></unset>
              <set token="showExpandLink_deepwatch">true</set>
              <unset token="form.toklinkCollapse_deepwatch"></unset>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <eval token="count_deepwatch">if($count_deepwatch$=="Running..","",$count_deepwatch$)</eval>
              <set token="count_deepwatch">T[ $job.resultCount$ ] $count_deepwatch$</set>
            </condition>
            <condition>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <eval token="count_deepwatch">if($count_deepwatch$=="Running..","",$count_deepwatch$)</eval>
              <set token="count_deepwatch">T[ $job.resultCount$ ] $count_deepwatch$</set>
            </condition>
          </done>
          <query>`getDWALL($filter$ $filter_UID2$ $form.filter_deepwatch|s$)`
``` $extra_deepwatch$ ```
          </query>
          <earliest>$time_deepwatch.earliest$</earliest>
          <latest>$time_deepwatch.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
      </table>
      <html>
      <u1> </u1>
      </html>
      <table depends="$showCollapseLink_deepwatch$;$extra_deepwatch$;$done_input$" rejects="$notfound_deepwatchR$">
        <search>
          <progress>
            <condition>
              <unset token="notfound_deepwatchR"></unset>
              <set token="panel_deepwatch">true</set>
              <unset token="nothingfound"></unset>
              <set token="showCollapseLink_deepwatch">true</set>
              <unset token="showExpandLink_deepwatch"></unset>
              <set token="form.toklinkCollapse_deepwatch">true</set>
              <set token="main_status">Search is running..</set>
              <eval token="count_deepwatch">if($count_deepwatch$=="Search","Running..",$count_deepwatch$)</eval>
            </condition>
          </progress>
          <done>
            <condition match="$job.resultCount$ == 0 AND $form.filter_deepwatch$ == &quot;*&quot; AND NOT match($count_deepwatch$,&quot;[1-9]&quot;)">
              <set token="notfound_deepwatchR">true</set>
              <unset token="showCollapseLink_deepwatch"></unset>
              <set token="showExpandLink_deepwatch">true</set>
              <unset token="form.toklinkCollapse_deepwatch"></unset>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <eval token="count_deepwatch">if($count_deepwatch$=="Running..","",$count_deepwatch$)</eval>
              <set token="count_deepwatch">$count_deepwatch$ R[ $job.resultCount$ ]</set>
            </condition>
            <condition>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <eval token="count_deepwatch">if($count_deepwatch$=="Running..","",$count_deepwatch$)</eval>
              <set token="count_deepwatch">$count_deepwatch$ R[ $job.resultCount$ ]</set>
            </condition>
          </done>
          <query>`getDWRisk($filter_UID2$, $filter$ $form.filter_deepwatch|s$)`
``` $extra_deepwatch$ ```
          </query>
          <earliest>$time_deepwatch.earliest$</earliest>
          <latest>$time_deepwatch.latest$</latest>

        </search>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
      </table>
    </panel>
  </row>
  <row depends="$extra_snow$;$done_input$" rejects="$extra_deepwatch$">
    <panel>
      <html>
      <u1> </u1>
    </html>
    </panel>
  </row>
  <row depends="$extra_deepwatch$;$done_input$" rejects="$notfound_deepwatch$">
    <panel>
      <html>
      <u1> </u1>
    </html>
    </panel>
  </row>

  <row>
    <panel id="panel_salesforce" depends="$showCollapseLink_salesforce$;$done_input$">
      <title>Salesforce</title>
      <input id="input_salesforce" type="text" token="filter_salesforce" depends="$showCollapseLink_salesforce$" searchWhenChanged="true">
        <label>Sub filter</label>
        <default>*</default>
        <initialValue>*</initialValue>
        <change>
          <condition match="$form.filter_salesforce$ != &quot;*&quot;">
            <unset token="main_salesforce"></unset>
            <set token="sub_salesforce">true</set>
          </condition>
          <condition>
            <set token="main_salesforce">true</set>
            <unset token="sub_salesforce"></unset>
          </condition>
        </change>
      </input>
      <input id="clear_salesforce" type="link" token="clear_salesforce" depends="$showCollapseLink_salesforce$">
        <label></label>
        <choice value="clear">Clear filter</choice>
        <change>
          <condition value="clear">
            <set token="form.filter_salesforce">*</set>
            <unset token="form.clear_salesforce"></unset>
          </condition>
          <condition>
            <unset token="form.clear_salesforce"></unset>
          </condition>
        </change>
      </input>
      <input type="time" token="time_salesforce" depends="$showCollapseLink_salesforce$" searchWhenChanged="true">
        <label></label>
        <default>
          <earliest>$time_salesforce.earliest$</earliest>
          <latest>$time_salesforce.latest$</latest>
        </default>
        <change>
          <set token="time_salesforce">$time_salesforce$</set>
        </change>
      </input>
      <input type="checkbox" token="global_salesforce" depends="$showCollapseLink_salesforce$">
        <label></label>
        <choice value="true">Enable global search on click</choice>
        <change>
          <condition value="true">
            <set token="global_salesforce">true</set>
          </condition>
          <condition>
            <unset token="global_salesforce"></unset>
          </condition>
        </change>
        <delimiter> </delimiter>
      </input>
      <table depends="$main_salesforce$;$panel_salesforce$;$extra_salesforce$;$showCollapseLink_salesforce$;$filter_UID2$;$done_input$">
        <search rejects="$form.killswitch$" depends="$extra_salesforce$;$done_input$" id="search_salesforce">
          <progress>
            <condition match="$form.filter_salesforce$ != &quot;*&quot;">
              <unset token="main_salesforce"></unset>
              <set token="sub_salesforce">true</set>
              <set token="panel_salesforce">true</set>
              <unset token="nothingfound"></unset>
              <set token="showCollapseLink_salesforce">true</set>
              <unset token="showExpandLink_salesforce"></unset>
              <set token="form.toklinkCollapse_salesforce">true</set>
              <set token="main_status">Search is running..</set>
              <set token="count_salesforce">Running..</set>
            </condition>
            <condition>
              <set token="main_salesforce">true</set>
              <unset token="sub_salesforce"></unset>
              <set token="panel_salesforce">true</set>
              <unset token="nothingfound"></unset>
              <set token="showCollapseLink_salesforce">true</set>
              <unset token="showExpandLink_salesforce"></unset>
              <set token="form.toklinkCollapse_salesforce">true</set>
              <set token="main_status">Search is running..</set>
              <set token="count_salesforce">Running..</set>
            </condition>
          </progress>
          <error>
            <condition>
              <set token="panel_salesforce">true</set>
            </condition>
          </error>
          <done>
            <condition match="$job.resultCount$ == 0 AND $form.filter_salesforce$ == &quot;*&quot;">
              <!--<unset token="panel_salesforce"></unset>-->
              <set token="notfound_salesforce">true</set>
              <unset token="showCollapseLink_salesforce"></unset>
              <set token="showExpandLink_salesforce">true</set>
              <unset token="form.toklinkCollapse_salesforce"></unset>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_salesforce">[ $job.resultCount$ ]</set>
            </condition>
            <condition>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_salesforce">[ $job.resultCount$ ]</set>
            </condition>
          </done>
          <query>`getSFLogsRAW(* $filter_UID2$ $filter$ )` 
``` $extra_salesforce$ ```            
          </query>
          <earliest>$time_salesforce.earliest$</earliest>
          <latest>$time_salesforce.latest$</latest>

        </search>
        <option name="drilldown">cell</option>
        <option name="refresh.display">progressbar</option>
        <option name="totalsRow">true</option>
        <option name="wrap">true</option>
        <fields>_time user CLIENT_IP LOGIN_STATUS Activities USER_AGENT USER_ID</fields>
        <drilldown>
          <condition match="$click.name2$==&quot;ITEM&quot; AND match($click.value2$,&quot;^https://security.microsoft.com/&quot;) AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;N/A&quot;">
            <link target="_blank">$click.value2|n$</link>
          </condition>
          <condition match="(NOT $global_salesforce$) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">replace(replace(replace($click.value2$,"[\\t\\r\\n\\f\\u200B]",""),"(\\\\)","\\\\\1"),"\\\"","\\\"")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="data">if(match($click.value2$,"[\\t\\r\\n]"),"*"+$data$,$data$)</eval>
            <set token="form.filter_salesforce">$click.name2$=$data$ $form.filter_salesforce$</set>
            <set token="form.jumpto">panel_salesforce</set>
            <eval token="form.osint">replace($data$," ","")</eval>
          </condition>
          <condition match="($global_salesforce$ == &quot;true&quot;) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND len($click.value2$) &gt; 3 AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">replace($click.value2$,"[\\t\\r\\n\\f\\u200B]","")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="dd_s">relative_time($click.value$,"-"+$form.pivot_window$+"h")</eval>
            <eval token="dd_e">relative_time($click.value$,"+"+$form.pivot_window$+"h")</eval>
            <link target="_blank">[LINK TO YOUR SPLUNK APP]/$dashboard_id$?form.keyword=$data$&amp;form.basetime.earliest=$dd_s$&amp;form.basetime.latest=$dd_e$&amp;form.pivot_window=$form.pivot_window$</link>
          </condition>
          <condition>
            <!-- Do nothing -->
          </condition>
        </drilldown>
      </table>
      <table depends="$sub_salesforce$;$panel_salesforce$;$extra_salesforce$;$showCollapseLink_salesforce$;$filter_UID2$;$done_input$">
        <search rejects="$form.killswitch$" depends="$extra_salesforce$;$done_input$;$sub_salesforce$" base="search_salesforce">
          <progress>
            <condition>
              <set token="panel_salesforce">true</set>
              <unset token="nothingfound"></unset>
              <set token="showCollapseLink_salesforce">true</set>
              <unset token="showExpandLink_salesforce"></unset>
              <set token="form.toklinkCollapse_salesforce">true</set>
              <set token="main_status">Search is running..</set>
              <set token="count_salesforce">Running..</set>
            </condition>
          </progress>
          <error>
            <condition>
              <set token="panel_salesforce">true</set>
            </condition>
          </error>
          <done>
            <condition>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_salesforce">[ $job.resultCount$ ]</set>
            </condition>
          </done>
          <query>| search $form.filter_salesforce$  
``` $sub_salesforce$ ```
          </query>
        </search>
        <option name="drilldown">cell</option>
        <option name="refresh.display">progressbar</option>
        <option name="totalsRow">true</option>
        <option name="wrap">true</option>
        <fields>_time user CLIENT_IP LOGIN_STATUS Activities USER_AGENT USER_ID</fields>
        <drilldown>
          <condition match="$click.name2$==&quot;ITEM&quot; AND match($click.value2$,&quot;^https://security.microsoft.com/&quot;) AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;N/A&quot;">
            <link target="_blank">$click.value2|n$</link>
          </condition>
          <condition match="(NOT $global_salesforce$) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">replace(replace(replace($click.value2$,"[\\t\\r\\n\\f\\u200B]",""),"(\\\\)","\\\\\1"),"\\\"","\\\"")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="data">if(match($click.value2$,"[\\t\\r\\n]"),"*"+$data$,$data$)</eval>
            <set token="form.filter_salesforce">$click.name2$=$data$ $form.filter_salesforce$</set>
            <set token="form.jumpto">panel_salesforce</set>
            <eval token="form.osint">replace($data$," ","")</eval>
          </condition>
          <condition match="($global_salesforce$ == &quot;true&quot;) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND len($click.value2$) &gt; 3 AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">replace($click.value2$,"[\\t\\r\\n\\f\\u200B]","")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="dd_s">relative_time($click.value$,"-"+$form.pivot_window$+"h")</eval>
            <eval token="dd_e">relative_time($click.value$,"+"+$form.pivot_window$+"h")</eval>
            <link target="_blank">[LINK TO YOUR SPLUNK APP]/$dashboard_id$?form.keyword=$data$&amp;form.basetime.earliest=$dd_s$&amp;form.basetime.latest=$dd_e$&amp;form.pivot_window=$form.pivot_window$</link>
          </condition>
          <condition>
            <!-- Do nothing -->
          </condition>
        </drilldown>
      </table>
    </panel>
  </row>
  <row depends="$panel_salesforce$;$extra_salesforce$;$showCollapseLink_salesforce$;$filter_UID2$;$done_input$" rejects="$notfound_salesforce$">
    <panel>
      <html>
      <u1> </u1>
    </html>
    </panel>
  </row>

  <row>
    <panel id="panel_epic" depends="$showCollapseLink_epic$;$done_input$">
      <title>EPIC</title>
      <input id="input_epic" type="text" token="filter_epic" depends="$showCollapseLink_epic$" searchWhenChanged="true">
        <label>Sub filter</label>
        <default>*</default>
        <initialValue>*</initialValue>
        <change>
          <condition match="$form.filter_epic$ != &quot;*&quot;">
            <unset token="main_epic"></unset>
            <set token="sub_epic">true</set>
          </condition>
          <condition>
            <set token="main_epic">true</set>
            <unset token="sub_epic"></unset>
          </condition>
        </change>
      </input>
      <input id="clear_epic" type="link" token="clear_epic" depends="$showCollapseLink_epic$">
        <label></label>
        <choice value="clear">Clear filter</choice>
        <change>
          <condition value="clear">
            <set token="form.filter_epic">*</set>
            <unset token="form.clear_epic"></unset>
          </condition>
          <condition>
            <unset token="form.clear_epic"></unset>
          </condition>
        </change>
      </input>
      <input type="time" token="time_epic" depends="$showCollapseLink_epic$" searchWhenChanged="true">
        <label></label>
        <default>
          <earliest>$time_epic.earliest$</earliest>
          <latest>$time_epic.latest$</latest>
        </default>
        <change>
          <set token="time_epic">$time_epic$</set>
        </change>
      </input>
      <input type="checkbox" token="global_epic" depends="$showCollapseLink_epic$">
        <label></label>
        <choice value="true">Enable global search on click</choice>
        <change>
          <condition value="true">
            <set token="global_epic">true</set>
          </condition>
          <condition>
            <unset token="global_epic"></unset>
          </condition>
        </change>
        <delimiter> </delimiter>
      </input>
      <table depends="$main_epic$;$panel_epic$;$extra_epic$;$showCollapseLink_epic$;$filter_UID2$;$done_input$">
        <search rejects="$form.killswitch$" depends="$extra_epic$;$done_input$" id="search_epic">
          <progress>
            <condition match="$form.filter_epic$ != &quot;*&quot;">
              <unset token="main_epic"></unset>
              <set token="sub_epic">true</set>
              <set token="panel_epic">true</set>
              <unset token="nothingfound"></unset>
              <set token="showCollapseLink_epic">true</set>
              <unset token="showExpandLink_epic"></unset>
              <set token="form.toklinkCollapse_epic">true</set>
              <set token="main_status">Search is running..</set>
              <set token="count_epic">Running..</set>
            </condition>
            <condition>
              <set token="main_epic">true</set>
              <unset token="sub_epic"></unset>
              <set token="panel_epic">true</set>
              <unset token="nothingfound"></unset>
              <set token="showCollapseLink_epic">true</set>
              <unset token="showExpandLink_epic"></unset>
              <set token="form.toklinkCollapse_epic">true</set>
              <set token="main_status">Search is running..</set>
              <set token="count_epic">Running..</set>
            </condition>
          </progress>
          <error>
            <condition>
              <set token="panel_epic">true</set>
            </condition>
          </error>
          <done>
            <condition match="$job.resultCount$ == 0 AND $form.filter_epic$ == &quot;*&quot;">
              <!--<unset token="panel_epic"></unset>-->
              <set token="notfound_epic">true</set>
              <unset token="showCollapseLink_epic"></unset>
              <set token="showExpandLink_epic">true</set>
              <unset token="form.toklinkCollapse_epic"></unset>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_epic">[ $job.resultCount$ ]</set>
            </condition>
            <condition>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_epic">[ $job.resultCount$ ]</set>
            </condition>
          </done>
          <query>`getEPICRAW($filter_UID2$,$filter$ )` 
``` $extra_epic$ ```            
          </query>
          <earliest>$time_epic.earliest$</earliest>
          <latest>$time_epic.latest$</latest>

        </search>
        <option name="drilldown">cell</option>
        <option name="refresh.display">progressbar</option>
        <option name="totalsRow">true</option>
        <option name="wrap">true</option>
        <fields>_time user usrName Activities LOGIN_DEVICE MASKMODE CLIENTNAME hostname ENV</fields>
        <drilldown>
          <condition match="$click.name2$==&quot;ITEM&quot; AND match($click.value2$,&quot;^https://security.microsoft.com/&quot;) AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;N/A&quot;">
            <link target="_blank">$click.value2|n$</link>
          </condition>
          <condition match="(NOT $global_epic$) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">replace(replace(replace($click.value2$,"[\\t\\r\\n\\f\\u200B]",""),"(\\\\)","\\\\\1"),"\\\"","\\\"")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="data">if(match($click.value2$,"[\\t\\r\\n]"),"*"+$data$,$data$)</eval>
            <set token="form.filter_epic">$click.name2$=$data$ $form.filter_epic$</set>
            <set token="form.jumpto">panel_epic</set>
            <eval token="form.osint">replace($data$," ","")</eval>
          </condition>
          <condition match="($global_epic$ == &quot;true&quot;) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND len($click.value2$) &gt; 3 AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">replace($click.value2$,"[\\t\\r\\n\\f\\u200B]","")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="dd_s">relative_time($click.value$,"-"+$form.pivot_window$+"h")</eval>
            <eval token="dd_e">relative_time($click.value$,"+"+$form.pivot_window$+"h")</eval>
            <link target="_blank">[LINK TO YOUR SPLUNK APP]/$dashboard_id$?form.keyword=$data$&amp;form.basetime.earliest=$dd_s$&amp;form.basetime.latest=$dd_e$&amp;form.pivot_window=$form.pivot_window$</link>
          </condition>
          <condition>
            <!-- Do nothing -->
          </condition>
        </drilldown>
      </table>
      <table depends="$sub_epic$;$panel_epic$;$extra_epic$;$showCollapseLink_epic$;$filter_UID2$;$done_input$">
        <search rejects="$form.killswitch$" depends="$extra_epic$;$done_input$;$sub_epic$" base="search_epic">
          <progress>
            <condition>
              <set token="panel_epic">true</set>
              <unset token="nothingfound"></unset>
              <set token="showCollapseLink_epic">true</set>
              <unset token="showExpandLink_epic"></unset>
              <set token="form.toklinkCollapse_epic">true</set>
              <set token="main_status">Search is running..</set>
              <set token="count_epic">Running..</set>
            </condition>
          </progress>
          <error>
            <condition>
              <set token="panel_epic">true</set>
            </condition>
          </error>
          <done>
            <condition>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
              <set token="count_epic">[ $job.resultCount$ ]</set>
            </condition>
          </done>
          <query>| search $form.filter_epic$  
``` $sub_epic$ ```
          </query>
        </search>
        <option name="drilldown">cell</option>
        <option name="refresh.display">progressbar</option>
        <option name="totalsRow">true</option>
        <option name="wrap">true</option>
        <fields>_time user usrName Activities LOGIN_DEVICE MASKMODE CLIENTNAME hostname ENV</fields>
        <drilldown>
          <condition match="$click.name2$==&quot;ITEM&quot; AND match($click.value2$,&quot;^https://security.microsoft.com/&quot;) AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;N/A&quot;">
            <link target="_blank">$click.value2|n$</link>
          </condition>
          <condition match="(NOT $global_epic$) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">replace(replace(replace($click.value2$,"[\\t\\r\\n\\f\\u200B]",""),"(\\\\)","\\\\\1"),"\\\"","\\\"")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="data">if(match($click.value2$,"[\\t\\r\\n]"),"*"+$data$,$data$)</eval>
            <set token="form.filter_epic">$click.name2$=$data$ $form.filter_epic$</set>
            <set token="form.jumpto">panel_epic</set>
            <eval token="form.osint">replace($data$," ","")</eval>
          </condition>
          <condition match="($global_epic$ == &quot;true&quot;) AND $click.value2$ != &quot;-------&quot; AND $click.value2$ != &quot;*&quot; AND $click.value2$ != &quot;NULL&quot; AND len($click.value2$) &gt; 3 AND $click.name2$!=&quot;_time&quot;">
            <eval token="data">replace($click.value2$,"[\\t\\r\\n\\f\\u200B]","")</eval>
            <eval token="data">if(match($data$,"[^a-zA-Z0-9@{}._:-]"),"\""+$data$+"\"",$data$)</eval>
            <eval token="dd_s">relative_time($click.value$,"-"+$form.pivot_window$+"h")</eval>
            <eval token="dd_e">relative_time($click.value$,"+"+$form.pivot_window$+"h")</eval>
            <link target="_blank">[LINK TO YOUR SPLUNK APP]/$dashboard_id$?form.keyword=$data$&amp;form.basetime.earliest=$dd_s$&amp;form.basetime.latest=$dd_e$&amp;form.pivot_window=$form.pivot_window$</link>
          </condition>
          <condition>
            <!-- Do nothing -->
          </condition>
        </drilldown>
      </table>
    </panel>
  </row>
  <row depends="$panel_epic$;$extra_epic$;$showCollapseLink_epic$;$filter_UID2$;$done_input$" rejects="$notfound_epic$">
    <panel>
      <html>
      <u1> </u1>
    </html>
    </panel>
  </row>

  <row>
    <panel id="panel_cquery" depends="$showCollapseLink_cquery$;$extra_cquery$;$done_input$">
      <title>Custom Query</title>
      <input id="custom_query" type="text" token="custom_query" depends="$showCollapseLink_cquery$" searchWhenChanged="true">
        <label>$search_custom_running$</label>
        <default>| makeresults</default>
        <initialValue></initialValue>
      </input>
      <input type="time" token="time_cquery" depends="$showCollapseLink_cquery$" searchWhenChanged="true">
        <label></label>
        <default>
          <earliest>$time_cquery.earliest$</earliest>
          <latest>$time_cquery.latest$</latest>
        </default>
      </input>
      <input type="checkbox" token="table_view" depends="$showCollapseLink_cquery$">
        <label></label>
        <choice value="table">View as Table</choice>
        <change>
          <condition value="table">
            <set token="search_custom_table">true</set>
            <unset token="search_custom_event"></unset>
          </condition>
          <condition>
            <unset token="search_custom_table"></unset>
            <set token="search_custom_event">true</set>
          </condition>
        </change>
      </input>
      <table depends="$showCollapseLink_cquery$;$search_custom_table$;$extra_cquery$">
        <search rejects="$form.killswitch$" depends="$extra_cquery$;$done_input$" id="search_custom">
          <progress>
            <condition>
              <set token="search_custom_running">Hold my beer. Running search for you...</set>
              <unset token="search_custom_table"></unset>
              <unset token="search_custom_event"></unset>
              <set token="main_status">Search is running..</set>
            </condition>
          </progress>
          <done>
            <condition match="match($custom_query$,&quot;\|\\s*(table|chart|timechart|top|rare|stats|tstats\\s*)&quot;) OR $table_view$ == &quot;table&quot;">
              <set token="search_custom_table">true</set>
              <unset token="search_custom_running"></unset>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
            </condition>
            <condition>
              <set token="search_custom_event">true</set>
              <unset token="search_custom_running"></unset>
              <set token="main_status">Search for anything</set>
              <eval token="runtime">now()-$search_start$</eval>
            </condition>
          </done>
          <error>
            <set token="search_custom_running">Uh-oh.. Something went wrong. Please try another query.</set>
          </error>
          <query>$custom_query|n$
          </query>
          <earliest>$time_cquery.earliest$</earliest>
          <latest>$time_cquery.latest$</latest>
        </search>
        <option name="drilldown">none</option>
      </table>
      <event depends="$showCollapseLink_cquery$;$search_custom_event$;$extra_cquery$">
        <search rejects="$form.killswitch$" depends="$extra_cquery$;$done_input$" base="search_custom">
          <query>
          </query>
        </search>
        <option name="list.drilldown">none</option>
      </event>
    </panel>
  </row>
  <row depends="$extra_query$">
    <panel>
      <html>
      <u1> </u1>
    </html>
    </panel>
  </row>
</form>